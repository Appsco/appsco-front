<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">

<link rel="import" href="appsco-brand.html">
<link rel="import" href="appsco-product.html">
<link rel="import" href="appsco-account-actions.html">
<link rel="import" href="appsco-account-info.html">

<!--
`appsco-header`
appsco-header is used to represent overall info about branding, current appsco product, global actions and user info. It is top section within appsco page.

@demo demo/index.html
-->

<dom-module id="appsco-header">
    <template>
        <style include="iron-flex iron-flex-alignment">
            :host {
                display: block;

                --appsco-brand-logo: {
                     margin-right: 10px;
                 };

                --appsco-product: {
                    font-size: 18px;
                 };
            }
            .vertical-divider {
                width: 2px;
                height: 32px;
                background-color: var(--divider-color);
                margin-left: 10px;
                margin-right: 10px;
            }
            .mr-10 {
                margin-right: 10px;
            }
        </style>

        <iron-ajax
                id="ironAjaxAccount"
                auto
                url="http://appsco.loc/app_dev.php/api/v2/me"
                handle-as="json"
                last-response="{{ accountResponse }}">
        </iron-ajax>

        <div class="layout horizontal center justified">

            <div class="layout horizontal center">
                <appsco-brand
                        logo="http://appsco.loc/bundles/appscodashboardapproot/img/appsco-logo.png"
                        logo-width="32"
                        logo-height="32"
                        brand-title="AppsCo">

                </appsco-brand>

                <div class="vertical-divider"></div>

                <appsco-product partner></appsco-product>
            </div>

            <div class="layout horizontal center">
                <appsco-account-actions
                        class="mr-10"
                        chat='{
                            "auth": "auth code",
                            "room": "room number",
                            "service": "https://www.xxx.com",
                            "active": "false"
                          }'
                        intranet="http://www.rts.rs/">
                </appsco-account-actions>

                <appsco-account-info
                        account="{{ accountResponse.account }}"
                        info="Info related to account"
                        display-name
                        on-account-settings="_handleAccountSettingsAction"
                        on-account-switch="_handleAccountSwitchAction"
                        on-account-add="_handleAccountAddAction"
                        on-account-logout="_handleAccountLogoutAction">
                </appsco-account-info>
            </div>

        </div>

    </template>

    <script>
        Polymer({

            is: 'appsco-header',

            properties: {

            },

            ready: function() {
                var basic = btoa('nikola@free.com' + ':' + 'Nikola.Appscov2');
                this.$.ironAjaxAccount.headers.authorization = "Basic " + basic;

            },

            _handleAccountSettingsAction: function(event) {
                console.log('Show settings for account: ' + event.detail.account);
            },

            _handleAccountSwitchAction: function(event) {
                console.log('Switch account to: ' + event.detail.account);
            },

            _handleAccountAddAction: function(event) {
                console.log('Add new account.');
            },

            _handleAccountLogoutAction: function(event) {
                console.log('Logout account: ' + event.detail.account);
            }

        });
    </script>
</dom-module>
