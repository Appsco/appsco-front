<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">

<link rel="import" href="../../bower_components/appsco-header/appsco-dropdown.html">

<!--
`appsco-subscription-info-dropdown`
Is used to present subscription info dropdown.

Example:

    <body>
      <appsco-subscription-info-dropdown>
     </appsco-subscription-info-dropdown>

 Custom property | Description | Default
----------------|-------------|----------
`--appsco-subscription-info-dropdown` | Mixin applied to inner appsco-dropdown within root element | `{}`
`--subscription-info-dropdown-action` | Mixin applied to dropdown action button | `{}`
`--subscription-info-dropdown-header-text` | Mixin applied to paper-card header text | `{}`

-->

<dom-module id="appsco-subscription-info-dropdown">
    <template>
        <style include="iron-flex iron-flex-alignment">
            :host {
                display: inline-block;
                position: relative;
                color: var(--primary-text-color, #414042);

                --paper-card-content: {
                    @apply(--layout-flex-vertical);
                    font-size: 14px;
                };
                --paper-card-actions: {
                    padding: 0;
                    border-color: #ffffff;
                };
            }
            appsco-dropdown {
                top: 12px;
                right: 0;
                @apply(--appsco-subscription-info-dropdown);

                --dropdown-caret-background-color: var(--paper-orange-300);
            }
            :host paper-card {
                @apply(--layout-flex-vertical);
                width: 100%;
                background-color: var(--paper-orange-300);
                color: #ffffff;
            }
            :host .dropdown-action {
                width: 100%;
                padding: 6px 0;
                margin: 0;
                border-radius: 0;
                background-color: transparent;
                font-size: 14px;
                border: none;
            }
            :host .info {
                margin: 0;
            }
            :host .emphasis {
                font-weight: 600;
            }
        </style>

        <appsco-dropdown
                id="dropdown"
                trigger="[[ _triggerDropdown ]]">

            <paper-card class="layout vertical">

                <div class="card-content">
                    <p class="info">Maximum number of
                        <span class="emphasis">[[ subscription.quantity ]] AppsCo licences</span> have been reached.</p>
                    <p class="info">Please upgrade subscription in order to add more accounts.</p>
                </div>

                <div id="dropdownActions"
                     class="card-actions">
                    <paper-button class="dropdown-action"
                                  on-tap="_onDropdownAction">Upgrade</paper-button>
                </div>

            </paper-card>

        </appsco-dropdown>

    </template>

    <script>
        Polymer({

            is: 'appsco-subscription-info-dropdown',

            properties: {

                subscription: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                /**
                 * DOM element which triggers the dropdown.
                 */
                _triggerDropdown: {
                    type: Object,
                    notify: true
                }
            },

            attached: function() {
                this._triggerDropdown = this.$$('#dropdownActions');
            },

            toggle: function(target) {
                this._triggerDropdown = target;
                this.$.dropdown.toggle();
            },

            /**
             * Fires event on dropdown Upgrade action.
             *
             * @private
             */
            _onDropdownAction: function() {

                /**
                 * Fired when user taps on Upgrade action.
                 *
                 * @event upgrade
                 */
                this.fire('upgrade');

                this.toggle();
            }

        });
    </script>
</dom-module>
