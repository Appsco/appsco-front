<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/legacy/class.html">
<link rel="import" href="lib/mixins/appsco-headers-mixin.html">

<link rel="import" href="appsco-app-header.html">

<dom-module id="appsco-app">
    <template>
        <style include="appsco-app-header">
        </style>

        <iron-media-query query="(max-width: 600px)" query-matches="{{ mobileScreen }}"></iron-media-query>
        <iron-media-query query="(max-width: 800px)" query-matches="{{ tabletScreen }}"></iron-media-query>

        <appsco-api id="api" domain="[[ domain ]]" index="" name="{{ api }}"></appsco-api>
        <appsco-api-errors language="[[ language ]]" name="{{ _apiErrors }}"></appsco-api-errors>

        <iron-ajax auto
                id = "getAccountRequest"
                url="[[ api.me ]]"
                on-response="_onGetAccountResponse"
                on-error="_onGetAccountError"
                headers="[[ _headers ]]">
        </iron-ajax>

        <iron-ajax auto
                url="[[ api.link ]]"
                on-response="_onLinkResponse"
                headers="[[ _headers ]]">
        </iron-ajax>

        <iron-ajax auto
                url="[[ api.item ]]"
                on-response="_onItemResponse"
                headers="[[ _headers ]]">
        </iron-ajax>

        <app-location route="{{route}}"></app-location>
        <app-route
                route="{{route}}"
                pattern="[[_prefixPath]]/:page"
                data="{{routeData}}"
                tail="{{subroute}}"></app-route>

        <paper-toast id="toast"
                     text="[[ _toastMessage ]]"
                     on-iron-overlay-closed="_onToastMessageClosed">

            <template is="dom-if" if="[[ _toastPersistence ]]">
                <paper-icon-button icon="icons:close"
                                   class="toast-close-action"
                                   on-tap="_onCloseToastAction"></paper-icon-button>
            </template>
        </paper-toast>

        <appsco-header id="appscoHeader"
                account="[[ account ]]"
                brand-logo="[[ _brandLogo ]]"
                brand-logo-clickable="[[ _brandLogoClickable ]]"
                brand-logo-width="38"
                brand-logo-height="32"
                brand-title="[[ _brandTitle ]]"
                authorization-token="[[ authorizationToken ]]"
                notifications-api="[[ api.notifications ]]"
                logout-api="[[ api.logout ]]"
                notifications-size="5"
                product-business="[[ _companiesAccountHasPermissionTo ]]"
                product-partner="[[ account.partner ]]"
                domain="{{ domain }}"
                tutorial-action-available="[[ _tutorialsPageVisible ]]"
                on-brand-action="_onBrandAction"
                on-appsco-product-changed="_onAppscoProductChangeAction"
                on-account-chat="_onAccountChat"
                on-account-settings="_onAccountSettingsAction"
                on-all-notifications="_onAllNotifications"
                on-account-logout="_onAccountLogout"
                on-get-started="_onGetStarted"
        ></appsco-header>

        <appsco-tutorial
                id="appscoTutorial"
                tutorials-api="[[ api.tutorialsApi ]]"
                authorization-token="[[ authorizationToken ]]"
                tutorials="{{ _tutorials }}"
                directory-page-loaded="[[ _directoryPageLoaded ]]"
                resources-page-loaded="[[ _resourcesPageLoaded ]]"
                company-domains-loaded="[[ _companyDomainsLoaded ]]"
                resource-share-accounts-loaded="[[ shareResourceDialogAccountsLoaded ]]"
                current-page="[[ page ]]"
                is-tutorial-active="{{ isTutorialActive }}"
                disable-upgrade$="[[!_applicationsApi]]"
        ></appsco-tutorial>

        <appsco-tutorial-progress
                id="appscoTutorialProgress"
                tutorials="[[ _tutorials ]]"
                show="true"
                is-tutorial-active="[[ isTutorialActive ]]"
                progress="{{ _progress }}"
                disable-upgrade$="[[!_applicationsApi]]"
        ></appsco-tutorial-progress>

        <app-drawer-layout fullbleed force-narrow>

             <!--Drawer content -->
            <app-drawer slot="drawer" id="appDrawer">
                <iron-selector selected="[[ page ]]"
                               attr-for-selected="name"
                               class="drawer-list"
                               role="navigation"
                               on-iron-select="_onMenuItemSelected"
                               id="menuContainer"
                >
                    <template is="dom-if" if="[[ !_companyPage ]]">
                        <a name="home" href="#">
                            <iron-icon icon="icons:home"></iron-icon> <span class="menu-text">Home</span>
                        </a>

                        <template is="dom-if" if="[[ _accountCanCreateCompany ]]">
                            <div purchase>
                                <div>Manage your business applications, employees and get meaningful insights.</div>
                                <paper-button on-tap="_showTryBusinessPage">
                                    Try Appsco Business
                                </paper-button>
                            </div>
                        </template>
                    </template>

                    <template is="dom-if" if="[[ _companyPage ]]">
                        <template is="dom-if" if="[[ _companyUser ]]">
                            <template is="dom-if" if="[[ _tutorialsPageVisible ]]">
                                <a name="get-started" href="#">
                                    <iron-icon icon="icons:help"></iron-icon>
                                    <span class="menu-text">Get started - [[ _progress ]]%
                                    </span>
                                </a>
                            </template>
                            <a name="company-home" href="#">
                                <iron-icon icon="icons:apps"></iron-icon> <span class="menu-text">Dashboard</span>
                            </a>
                            <template is="dom-if" if="[[ _companyAdmin ]]">
                                <div class="section">
                                    <span class="menu-text">Administration</span>
                                </div>
                                <a name="resources" href="#">
                                    <iron-icon icon="icons:list"></iron-icon> <span class="menu-text" id="menuCompanyResourcesText">Resources</span>
                                </a>
                                <a name="directory" href="#">
                                    <iron-icon icon="icons:social:person"></iron-icon> <span class="menu-text" id="menuCompanyDirectoryText">Directory</span>
                                </a>
                                <a name="contacts" href="#">
                                    <iron-icon icon="icons:perm-contact-calendar"></iron-icon> <span class="menu-text">Contacts</span>
                                </a>
                                <a name="groups" href="#">
                                    <iron-icon icon="icons:supervisor-account"></iron-icon> <span class="menu-text">Groups</span>
                                </a>
                                <a name="provisioning" href="#">
                                    <iron-icon icon="icons:compare-arrows"></iron-icon> <span class="menu-text" id="menuProvisioningText">Provisioning</span>
                                </a>

                                <div class="section">
                                    <span class="menu-text">Management</span>
                                </div>
                                <a name="audit-log" href="#">
                                    <iron-icon icon="icons:reorder"></iron-icon> <span class="menu-text">Audit</span>
                                </a>
                                <a name="access-on-boarding" href="#">
                                    <iron-icon icon="icons:accessibility"></iron-icon> <span class="menu-text">Access On-boarding</span>
                                </a>
                                <a name="statistics" href="#">
                                    <iron-icon icon="icons:donut-large"></iron-icon> <span class="menu-text">Statistics</span>
                                </a>
                                <a name="reports" href="#">
                                    <iron-icon icon="icons:description"></iron-icon>
                                    <span class="menu-text">Reports</span>
                                </a>
                                <template is="dom-if" if="[[ _accessBilling ]]">
                                    <a name="billing" href="#">
                                        <iron-icon icon="icons:payment"></iron-icon> <span class="menu-text">Billing</span>
                                    </a>
                                </template>
                                <a name="company" href="#" id="menuCompanySettings">
                                    <iron-icon icon="icons:settings"></iron-icon> <span class="menu-text" id="menuCompanySettingsText">Settings</span>
                                </a>

                                <template is="dom-if" if="[[ currentCompany.company.is_partner ]]">
                                    <div class="section">
                                        <span class="menu-text">Partner</span>
                                    </div>
                                    <a name="customers" href="#">
                                        <iron-icon icon="icons:social:domain"></iron-icon> <span class="menu-text">Customers</span>
                                    </a>
                                    <a name="customer-billing" href="#">
                                        <iron-icon icon="icons:payment"></iron-icon> <span class="menu-text">Customer Billing</span>
                                    </a>
                                    <a name="billing-report" href="#">
                                        <iron-icon icon="icons:description"></iron-icon><span class="menu-text">Billing Report</span>
                                    </a>

                                </template>

                                <div class="section">
                                    <span class="menu-text">Advanced</span>
                                </div>
                                <a name="oauth-applications" href="#">
                                    <iron-icon icon="device:widgets"></iron-icon> <span class="menu-text">OAuth applications</span>
                                </a>
                                <a name="policies" href="#">
                                    <iron-icon icon="icons:verified-user"></iron-icon> <span class="menu-text">Policies</span>
                                </a>
                            </template>

                            <template is="dom-if" if="[[ _resourceAdmin ]]">
                                <div class="section">
                                    <span class="menu-text">Administration</span>
                                </div>
                                <a name="resources" href="#">
                                    <iron-icon icon="icons:list"></iron-icon> <span class="menu-text">Resources</span>
                                </a>
                            </template>
                        </template>
                        <template is="dom-if" if="[[ _companyContact ]]">
                            <a name="contact-home" href="#">
                                <iron-icon icon="icons:apps"></iron-icon> <span class="menu-text">Dashboard</span>
                            </a>
                        </template>
                    </template>

                </iron-selector>
            </app-drawer>

            <!-- Main content -->
            <app-header-layout has-scrolling-region>

                <app-header slot="header">
                    <app-toolbar class="flex-horizontal">
                        <paper-icon-button id="menuBurger" icon="menu" drawer-toggle></paper-icon-button>
                        <div class="page-title" condense-title>[[ _pageName ]]</div>

                        <neon-animated-pages
                                id="animatedActions"
                                class="actions flex flex-end"
                                selected="[[page]]"
                                attr-for-selected="name"
                                on-neon-animation-finish="_onPageActionsAnimationFinish">

                            <template is="dom-if" if="[[ _homePage ]]">
                                <appsco-home-page-actions
                                        id="appscoHomePageActions"
                                        name="home"
                                        account="[[ account ]]"
                                        authorization-token="[[ authorizationToken ]]"
                                        page-config-api="[[ api.pageConfigApi ]]"
                                        page-config="[[ _pageConfig ]]"
                                        page="[[ page ]]"
                                        api-errors="[[ _apiErrors ]]"
                                        on-add-item-action="_onAddItemAction"
                                        on-search="_onSearchApplications"
                                        on-search-clear="_onSearchApplicationsClear"
                                        on-filter-items="_onFilterItemsAction"
                                        on-add-new-folder="_onAddNewFolderAction"
                                        disable-upgrade$="[[!api.me]]"></appsco-home-page-actions>
                            </template>

                            <appsco-groups-page-actions id="appscoGroupsPageActions"
                                                    name="groups"
                                                    authorization-token="[[ authorizationToken ]]"
                                                    on-add-company-group="_onAddCompanyGroupAction"
                                                    on-search="_onSearchCompanyGroupAction"
                                                    on-search-clear="_onSearchCompanyGroupClear"
                                                    on-select-all-groups="_onSelectAllGroupsAction"
                                                    on-remove-groups="_onRemoveGroupsAction"
                                                    on-notify-groups="_onNotifyGroupsAction"
                                                    disable-upgrade$="[[!api.me]]"
                            ></appsco-groups-page-actions>

                            <template is="dom-if" if="[[ _resourcePage ]]">
                                <appsco-resource-page-actions
                                        id="appscoApplicationPageActions"
                                        name="resource"
                                        on-back="_showHomePage"
                                        on-resource-section="_onResourceActionApplicationPage"
                                        on-search-subscribers="_onSearchSubscribers"
                                        on-search-subscribers-clear="_onSearchSubscribersClear"
                                        disable-upgrade$="[[!api.me]]"></appsco-resource-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _accountPage ]]">
                                <appsco-account-page-actions
                                        id="appscoAccountPageActions"
                                        name="account"
                                        on-back="_onBackFromAccountAction"
                                        on-resource-section="_onResourceActionPage"
                                        on-advanced-settings="_onAccountAdvancedSettings"
                                        disable-upgrade$="[[!api.me]]"></appsco-account-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _companyAccountPage ]]">
                                <appsco-company-account-page-actions
                                        id="appscoCompanyAccountPageActions"
                                        name="company-account"
                                        on-back="_onBackFromAccountAction"
                                        on-resource-section="_onResourceActionPage"
                                        on-advanced-settings="_onAccountAdvancedSettings"
                                        disable-upgrade$="[[!api.me]]"></appsco-company-account-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _tryBusinessPage ]]">
                                <appsco-upgrade-page-actions
                                        name="upgrade"
                                        authorization-token="[[ authorizationToken ]]"
                                        on-toggle-pricing="_onUpgradeTogglePricing"
                                        disable-upgrade$="[[!api.me]]"></appsco-upgrade-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _companyHomePage ]]">
                                <appsco-company-home-page-actions id="appscoCompanyHomePageActions"
                                                          name="company-home"
                                                          authorization-token="[[ authorizationToken ]]"
                                                          page-config-api="[[ api.pageConfigApi ]]"
                                                          page-config="[[ _pageConfig ]]"
                                                          page="[[ page ]]"
                                                          api-errors="[[ _apiErrors ]]"
                                                          on-search="_onSearchApplications"
                                                          on-search-clear="_onSearchApplicationsClear"
                                                          on-add-new-folder="_onAddNewFolderAction"
                                                          disable-upgrade$="[[!api.me]]"></appsco-company-home-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _contactPage ]]">
                                <appsco-contact-home-page-actions id="appscoContactHomePageActions"
                                                                  name="contact-home"
                                                                  authorization-token="[[ authorizationToken ]]"
                                                                  page-config-api="[[ api.pageConfigApi ]]"
                                                                  page-config="[[ _pageConfig ]]"
                                                                  page="[[ page ]]"
                                                                  api-errors="[[ _apiErrors ]]"
                                                                  on-search="_onSearchApplications"
                                                                  on-search-clear="_onSearchApplicationsClear"
                                                                  disable-upgrade$="[[!api.me]]"></appsco-contact-home-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _resourcesPage ]]">
                                <appsco-resources-page-actions id="appscoResourcesPageActions"
                                        name="resources"
                                        authorization-token="[[ authorizationToken ]]"
                                        filter-api="[[ api.dashboards ]]?extended=1"
                                        page-config-api="[[ api.pageConfigApi ]]"
                                        page-config="[[ _pageConfig ]]"
                                        page="[[ page ]]"
                                        api-errors="[[ _apiErrors ]]"
                                        resource-admin="[[ _resourceAdmin ]]"
                                        on-add-item-action="_onAddCompanyItemAction"
                                        on-import-resources="_onImportResourcesAction"
                                        on-search="_onSearchCompanyApplications"
                                        on-search-clear="_onSearchCompanyApplicationsClear"
                                        on-select-all-resources="_onSelectAllResourcesAction"
                                        on-share="_onShareResources"
                                        on-remove="_onRemoveApplications"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-resources-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageResourcePage ]]">

                                <appsco-manage-resource-page-actions
                                        id="appscoManageApplicationPageActions"
                                        name="manage-resource"
                                        resource-admin="[[ _resourceAdmin ]]"
                                        on-back="_showCompanyResourcesPage"
                                        on-resource-section="_onResourceActionManageApplicationPage"
                                        on-search-assignees="_onSearchAssignees"
                                        on-search-assignees-clear="_onSearchAssigneesClear"
                                        on-advanced-settings="_showAdvancedManageResourcePageOptions"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-manage-resource-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _directoryPage ]]">
                                <appsco-directory-page-actions
                                        id="appscoDirectoryPageActions"
                                        name="directory"
                                        authorization-token="[[ authorizationToken ]]"
                                        on-add-account="_onCompanyAddAccount"
                                        on-import-accounts="_onCompanyImportAccounts"
                                        on-search="_onSearchAccounts"
                                        on-search-clear="_onSearchAccountsClear"
                                        on-upgrade="_fireUpgrade"
                                        on-remove="_onRemoveAccounts"
                                        on-select-all-company-roles="_onSelectAllCompanyRolesAction"
                                        on-add-groups-to-company-roles="_onAddGroupsToCompanyRoles"
                                        on-orgunits="_onAddAccountsToOrgunit"
                                        on-manage-domains="_onManageDomains"
                                        on-filter-roles="_onFilterRoles"
                                        on-send-notification="_onSendNotificationToCompanyRoles"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-directory-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageAccountPage ]]">
                                <appsco-manage-account-page-actions
                                        name="manage-account"
                                        on-back="_showCompanyDirectoryPage"
                                        on-resource-section="_onResourceActionManageAccountPage"
                                        on-advanced-settings="_showAdvancedManageAccountPageOptions"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-manage-account-page-actions>

                            </template>

                            <template is="dom-if" if="[[ _contactsPage ]]">
                                <appsco-contacts-page-actions
                                        id="appscoContactsPageActions"
                                        name="contacts"
                                        on-add-contact="_onAddContactAction"
                                        on-import-contacts="_onImportContactsAction"
                                        on-delete-contacts="_onDeleteContactsAction"
                                        on-add-groups-to-contacts="_onAddGroupsToContactsAction"
                                        on-select-all-contacts="_onSelectAllContactsAction"
                                        on-page-selected="_onContactsPageSelected"
                                        on-search="_onSearchContacts"
                                        on-search-clear="_onSearchContactsClear"
                                        on-send-notification="_onSendNotificationToContacts"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-contacts-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageContactPage ]]">
                                <appsco-manage-contact-page-actions
                                        name="manage-contact"
                                        on-back="_showContactsPage"
                                        on-resource-section="_onResourceActionPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-manage-contact-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageCustomerPage ]]">
                                <appsco-manage-customer-page-actions
                                        name="manage-customer"
                                        on-back="_showCustomersPage"
                                        on-resource-section="_onResourceActionPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-manage-customer-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageGroupPage ]]">
                                <appsco-manage-group-page-actions
                                        name="manage-group"
                                        on-back="_showGroupsPage"
                                        on-resource-section="_onResourceActionPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-manage-group-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageIntegrationPage ]]">
                                <appsco-manage-integration-page-actions
                                        name="manage-integration"
                                        on-back="_showCompanyProvisioningPage"
                                        disable-upgrade$="[[!api.me]]">
                                </appsco-manage-integration-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _customersPage ]]">
                                <appsco-customers-page-actions
                                        id="appscoCustomersPageActions"
                                        name="customers"
                                        on-search="_onSearchCustomersAction"
                                        on-search-clear="_onSearchCustomersClearAction"
                                        on-add-customer="_onAddCustomerAction"
                                        on-remove-customers="_onRemoveCustomersAction"
                                        on-add-partner-admin="_onAddPartnerAdminToCustomersAction"
                                        on-select-all-customers="_onSelectAllCustomersAction"
                                        on-import-customers="_onImportCustomersAction"
                                        on-import-customer-resources="_onImportCustomerResources"
                                        on-export-customers="_onExportCustomersAction"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-customers-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _auditLogPage ]]">
                                <appsco-audit-log-page-actions
                                        id="appscoAuditLogPageActions"
                                        name="audit-log"
                                        on-resource-section="_onResourceActionAuditLogPage"
                                        on-export-audit-log="_onExportAuditLogAction"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-audit-log-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _accessOnBoardingPage ]]">
                                <appsco-access-on-boarding-page-actions
                                        id="appscoAccessOnBoardingPageActions"
                                        name="access-on-boarding"
                                        on-resource-section="_onResourceActionPage"
                                        on-export-access-on-boarding="_onExportAccessOnBoardingAction"
                                        disable-upgrade$="[[!api.me]]"
                                ></appsco-access-on-boarding-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _billingPage ]]">
                                <appsco-billing-page-actions
                                        name="billing"
                                        on-resource-section="_onResourceActionBillingPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-billing-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _companySettingsPage ]]">
                                <appsco-company-page-actions
                                        id="appscoCompanyPageActions"
                                        name="company"
                                        on-resource-section="_onResourceActionCompanyPage"
                                        on-add-domain="_onAddDomain"
                                        on-search-groups="_onSearchGroups"
                                        on-search-groups-clear="_onSearchGroupsClear"
                                        disable-upgrade$="[[!api.me]]"></appsco-company-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _reportsPage ]]">
                                <appsco-reports-page-actions id="appscoReportsPageActions"
                                                            name="reports"
                                                            disable-upgrade$="[[!api.me]]"></appsco-reports-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _accessReportPage ]]">
                                <appsco-access-report-page-actions
                                        id="appscoAccessReportPageActions"
                                        name="access-report"
                                        on-back="_showReportsPage"
                                        on-resource-section="_onResourceActionPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-access-report-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _complianceReportPage ]]">
                                <appsco-compliance-report-page-actions
                                        id="appscoComplianceReportPageActions"
                                        name="compliance-report"
                                        on-back="_showReportsPage"
                                        on-resource-section="_onResourceActionPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-compliance-report-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _billingReportPage ]]">
                                <appsco-billing-report-page-actions
                                        id="appscoBillingReportPageActions"
                                        name="billing-report"
                                        disable-upgrade$="[[!api.me]]"></appsco-billing-report-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _provisioningPage ]]">
                                <appsco-provisioning-page-actions id="appscoProvisioningPageActions"
                                                                  name="provisioning"
                                                                  on-add-integration="_onAddIntegrationAction"
                                                                  disable-upgrade$="[[!api.me]]"></appsco-provisioning-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _oauthApplicationsPage ]]">
                                <appsco-oauth-applications-page-actions
                                        id="appscoOAuthApplicationsPageActions"
                                        name="oauth-applications"
                                        disable-upgrade$="[[!_applicationsApi]]"
                                        on-add-oauth-application="_onAddOAuthApplicationAction"
                                        disable-upgrade$="[[!api.me]]"></appsco-oauth-applications-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _manageOauthApplicationPage ]]">
                                <appsco-manage-oauth-application-page-actions
                                        id="appscoManageOAuthApplicationPageActions"
                                        name="manage-oauth-application"
                                        on-back="_showOAuthApplicationsPage"
                                        disable-upgrade$="[[!api.me]]"></appsco-manage-oauth-application-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _dashboardFolderPage ]]">
                                <appsco-dashboard-folder-page-actions id="appscoDashboardFolderPageActions"
                                                                      name="dashboard-folder"
                                                                      on-search="_onSearchApplications"
                                                                      on-search-clear="_onSearchApplicationsClear"
                                                                      on-back="_backFromFolderPage"
                                                                      disable-upgrade$="[[!api.me]]"></appsco-dashboard-folder-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _policiesPage ]]">
                                <appsco-policies-page-actions id="appscoPoliciesPageActions"
                                                              name="policies"
                                                              disable-upgrade$="[[!api.me]]"></appsco-policies-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _policiesReportPage ]]">
                                <appsco-policy-report-page-actions id="appscoPolicyReportPageActions"
                                                                   name="policies-report"
                                                                   on-back="_showReportsPage"
                                                                   on-resource-section="_onResourceActionPage"
                                                                   disable-upgrade$="[[!api.me]]"></appsco-policy-report-page-actions>
                            </template>

                            <template is="dom-if" if="[[ _additionalOptionsPage ]]">
                                <appsco-additional-options-page-actions id="appscoAdditionalOptionsPageActions"
                                                                        name="additional-options"
                                                                        on-back="_showCompanyResourcesPage"
                                                                        on-resource-section="_onResourceActionPage"
                                                                        disable-upgrade$="[[!api.me]]"></appsco-additional-options-page-actions>
                            </template>
                        </neon-animated-pages>

                    </app-toolbar>
                </app-header>

                <paper-progress id="pageProgress" indeterminate></paper-progress>

                <neon-animated-pages
                        class="pages"
                        selected="[[page]]"
                        attr-for-selected="name"
                        fallback-selection="404"
                        role="main"
                        on-neon-animation-finish="_onPageAnimationFinish">

                    <appsco-home-page name="home" page
                            id="appscoHomePage"
                            application="{{ application }}"
                            account="[[ account ]]"
                            application-log="[[ application.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            applications-api="[[ _applicationsApi ]]"
                            folders-api="[[ api.foldersApi ]]"
                            page-config="[[ _pageConfig ]]"
                            on-loaded="_onLoadedPage"
                            on-edit-shared-application="_onEditSharedApplication"
                            on-revoke-application="_onRevokeApplication"
                            on-open-move-to-folder-dialog="_onOpenMoveToFolderDialog"
                            on-open-rename-folder-dialog="_onOpenRenameFolderDialog"
                            on-open-remove-folder-dialog="_onOpenRemoveFolderDialog"
                            on-folder-tapped="_onFolderTapped"
                            on-applications-removed="_onApplicationsRemovedFromHomePage"
                            disable-upgrade$="[[!_applicationsApi]]"
                            ></appsco-home-page>

                    <appsco-resource-page name="resource" page
                            id="appscoApplicationPage"
                            route="[[ subroute ]]"
                            company="[[ _companyPage ]]"
                            application="{{ application }}"
                            applications-api="[[ _applicationsApi ]]"
                            icons-api="[[ api.icons ]]"
                            application-log="[[ application.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            accounts-api="[[ api.accounts ]]"
                            account="{{ account }}"
                            on-remove-application="_onRemoveApplication"
                            on-subscription-revoke="_onSubscriptionRevoke"
                            on-application-settings-saved="_onApplicationSettingsSaved"
                            on-application-settings-no-changes="_onApplicationSettingsNoChanges"
                            on-autologin-changed="_onAutologinChanged"
                            on-enable-subscribers-search-action="_onEnableSubscribersSearchAction"
                            on-disable-subscribers-search-action="_onDisableSubscribersSearchAction"
                            on-resource-image-changed="_onResourceImageChanged"
                            on-page-error="_onError"
                            on-image-upload-error="_onImageUploadError"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-resource-page>

                    <appsco-account-page name="account" page
                            id="appscoAccountPage"
                            account="{{ account }}"
                            authorization-token="[[ authorizationToken ]]"
                            notifications-api="[[ api.notifications ]]"
                            authorized-apps-api="[[ api.authorizedApps ]]"
                            log-api="[[ api.accountLog ]]"
                            two-fa-api="[[ api.twoFA ]]"
                            two-fa-qr-api="[[ api.twoFAQr ]]"
                            two-fa-codes-api="[[ api.twoFACodes ]]"
                            settings-api="[[ api.me ]]"
                            image-settings-api="[[ api.profileImage ]]"
                            change-password-api="[[ api.changePassword ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-settings-saved="_onAccountSettingsSaved"
                            on-password-changed="_onAccountPasswordChanged"
                            on-import-personal-resources="_onImportPersonalResourcesAction"
                            on-image-upload-error="_onImageUploadError"
                            remove-account-api="[[ api.removeAccount ]]"
                            logout-api="[[ api.logout ]]"
                            account-managed="[[ _accountManaged ]]"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-account-page>

                    <appsco-company-account-page name="company-account" page company-page
                            id="appscoCompanyAccountPage"
                            account="{{ account }}"
                            authorization-token="[[ authorizationToken ]]"
                            notifications-api="[[ api.notifications ]]"
                            authorized-apps-api="[[ api.authorizedApps ]]"
                            log-api="[[ api.accountLog ]]"
                            two-fa-enforced="[[ currentCompany.company.enforced_2fa ]]"
                            two-fa-api="[[ api.twoFA ]]"
                            two-fa-qr-api="[[ api.twoFAQr ]]"
                            two-fa-codes-api="[[ api.twoFACodes ]]"
                            settings-api="[[ api.me ]]"
                            image-settings-api="[[ api.profileImage ]]"
                            change-password-api="[[ api.changePassword ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-settings-saved="_onAccountSettingsSaved"
                            on-password-changed="_onAccountPasswordChanged"
                            on-import-personal-resources="_onImportPersonalResourcesAction"
                            on-image-upload-error="_onImageUploadError"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-company-account-page>

                    <appsco-trybusiness-page name="trybusiness" page
                            id="appscoUpgradePage"
                            authorization-token="[[ authorizationToken ]]"
                            company-upgrade-api="[[ api.upgradeToBusiness ]]"
                            on-upgraded="_upgradedToBusiness"
                            on-upgrade-failed="_onUpgradeToCompanyFailed"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-trybusiness-page>

                    <appsco-company-home-page name="company-home" page company-page
                            id="appscoCompanyHomePage"
                            authorization-token="[[ authorizationToken ]]"
                            applications-api="[[ _companyIconsWithoutFolderApi ]]"
                            folders-api="[[ _companyFoldersApi ]]"
                            netscaler-api="[[ _companyNetscalerFeatureApi ]]"
                            account="[[ account ]]"
                            page-config="[[ _pageConfig ]]"
                            company="{{ currentCompany.company }}"
                            on-loaded="_onLoadedPage"
                            on-open-move-to-folder-dialog="_onOpenMoveToFolderDialog"
                            on-open-rename-folder-dialog="_onOpenRenameFolderDialog"
                            on-open-remove-folder-dialog="_onOpenRemoveFolderDialog"
                            on-revoke-application="_onRevokeApplication"
                            on-folder-tapped="_onFolderTapped"
                            on-edit-shared-application="_onEditSharedApplication"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-company-home-page>

                    <appsco-contact-home-page name="contact-home" page company-page
                            id="appscoContactHomePage"
                            authorization-token="[[ authorizationToken ]]"
                            applications-api="[[ _contactIconsApi ]]"
                            page-config="[[ _pageConfig ]]"
                            on-loaded="_onLoadedPage"
                            on-open-move-to-folder-dialog="_onOpenMoveToFolderDialog"
                            on-open-rename-folder-dialog="_onOpenRenameFolderDialog"
                            on-open-remove-folder-dialog="_onOpenRemoveFolderDialog"
                            on-revoke-application="_onRevokeApplication"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-contact-home-page>

                    <appsco-resources-page name="resources" page company-page
                            id="appscoResourcesPage"
                            resource="{{ _companyApplication }}"
                            account="[[ account ]]"
                            application-log="[[ _companyApplication.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            computed-headers="[[ _headers ]]"
                            company-resources-api="[[ _companyApplicationsApi ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            resource-admin="[[ _resourceAdmin ]]"
                            page-config="[[ _pageConfig ]]"
                            get-company-idp-config-list-api="[[ _getCompanyIdpConfigListApi ]]"
                            on-list-loaded="_onLoadedPage"
                            on-share-company-resource="_onShareCompanyResource"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideResourcesBulkActions"
                            on-add-orgunit="_onAddOrgunit"
                            on-modify-orgunit="_onModifyOrgunit"
                            on-remove-orgunit="_onRemoveOrgunit"
                            on-observable-list-empty="_onObservableListEmpty"
                            on-observable-list-filled="_onObservableListFilled"
                            on-page-loaded="_onResourcesPageLoaded"
                            on-resource-settings="_onEditSharedApplication"
                            on-load-forbidden="_onResourcesLoadForbidden"
                            on-edit-additional-options="_onEditAdditionalOptionsAction"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-resources-page>

                    <appsco-manage-resource-page name="manage-resource" page company-page
                            id="appscoManageApplicationPage"
                            route="[[ subroute ]]"
                            application="{{ _companyApplication }}"
                            company-api="[[ _companyApi ]]"
                            company-idp-saml-metadata-api="[[ _companySamlMetadataApi ]]"
                            domain="[[ domain ]]"
                            application-log="[[ _companyApplication.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            accounts-api="[[ api.accounts ]]"
                            account="{{ account }}"
                            api-errors="[[ _apiErrors ]]"
                            resource-admin="[[ _resourceAdmin ]]"
                            on-share-company-resource="_onShareCompanyResource"
                            on-add-resource-admin="_onAddResourceAdmin"
                            on-remove-application="_onRemoveCompanyApplication"
                            on-revoke-assignee="_onRevokeAssigneeAccess"
                            on-revoke-resource-admin="_onRevokeResourceAdmin"
                            on-application-settings-saved="_onApplicationSettingsSaved"
                            on-application-settings-no-changes="_onApplicationSettingsNoChanges"
                            on-add-to-orgunit="_onAddApplicationToOrgunit"
                            on-enable-assignees-search-action="_onEnableAssigneesSearchAction"
                            on-disable-assignees-search-action="_onDisableAssigneesSearchAction"
                            on-page-error="_onError"
                            on-resource-image-changed="_onResourceImageChanged"
                            on-remove-from-group="_onRemoveApplicationFromGroup"
                            on-image-upload-error="_onImageUploadError"
                            on-compliance-info-updated="_onComplianceInfoUpdated"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-manage-resource-page>

                    <appsco-directory-page name="directory" page company-page
                            id="appscoDirectoryPage"
                            role="{{ _role }}"
                            selected-accounts="{{ _selectedAccounts }}"
                            authorization-token="[[ authorizationToken ]]"
                            computed-headers="[[ _headers ]]"
                            company-invitations-api="[[ _companyInvitationsApi ]]"
                            company-directory-roles-api="[[ _companyRolesApi ]]"
                            company-orgunits-api="[[ _companyOrgunitsApi ]]"
                            company-subscription-api="[[ _companySubscriptionApi ]]"
                            domains-api="[[ _companyDomainsApi ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            on-invitation-resent="_onInvitationResent"
                            on-hide-subscription-limit-reached-info="_onHideSubscriptionLimitReachedInfo"
                            on-show-domain-not-verified-info="_onShowDomainNotVerifiedInfo"
                            on-hide-domain-not-verified-info="_onHideDomainNotVerifiedInfo"
                            on-edit-account="_onEditAccount"
                            on-info-edit-account="_onEditAccount"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideDirectoryBulkActions"
                            on-add-orgunit="_onAddOrgunit"
                            on-modify-orgunit="_onModifyOrgunit"
                            on-remove-orgunit="_onRemoveOrgunit"
                            on-reset-type-filter="_onResetDirectoryTypeFilter"
                            on-observable-list-empty="_onObservableListEmpty"
                            on-observable-list-filled="_onObservableListFilled"
                            on-company-subscription-loaded="_onSubscriptionLoaded"
                            on-page-loaded="_onDirectoryPageLoaded"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-directory-page>

                    <appsco-contacts-page name="contacts" page company-page
                            id="appscoContactsPage"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            company-invitations-api="[[ _companyInvitationsApi ]]"
                            company-contacts-api="[[ _companyContactsApi ]]"
                            on-edit-contact="_onEditContactAction"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideContactsBulkActions"
                            on-invitation-resent="_onContactInvitationResent"
                            on-observable-list-empty="_onObservableListEmpty"
                            on-observable-list-filled="_onObservableListFilled"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-contacts-page>

                    <appsco-customers-page name="customers" page company-page
                            id="appscoCustomersPage"
                            customers-api="[[ _companyCustomersApi ]]"
                            customers-export-api="[[ _companyCustomersExportApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-edit-customer="_onEditCustomerAction"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideCustomersBulkActions"
                            on-observable-list-empty="_onObservableListEmpty"
                            on-observable-list-filled="_onObservableListFilled"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-customers-page>

                    <appsco-groups-page name="groups" page company-page
                            id="appscoGroupsPage"
                            group="{{ _group }}"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            on-edit-item="_onEditCompanyGroupAction"
                            on-group-rename="_onRenameCompanyGroupAction"
                            on-info-edit-group="_onEditCompanyGroupAction"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideGroupsBulkActions"
                            on-observable-list-empty="_onObservableListEmpty"
                            on-observable-list-filled="_onObservableListFilled"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-groups-page>

                    <appsco-manage-account-page name="manage-account" page company-page
                            id="appscoManageAccountPage"
                            route="[[ subroute ]]"
                            role="{{ _role }}"
                            administrator="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            company-api="[[ _companyApi ]]"
                            notifications-api="[[ api.notifications ]]"
                            log-api="[[ api.accountLog ]]"
                            two-fa-api="[[ api.twoFA ]]"
                            two-fa-enforced="[[ currentCompany.company.enforced_2fa ]]"
                            settings-api="[[ api.me ]]"
                            image-settings-api="[[ api.profileImage ]]"
                            change-password-api="[[ api.changePassword ]]"
                            on-settings-saved="_onAccountSettingsSaved"
                            on-password-changed="_onCompanyAccountPasswordChanged"
                            on-reset-role-two-fa="_onResetRoleTwoFA"
                            on-add-to-orgunit="_onAddAccountToOrgunit"
                            on-remove-from-orgunit="_onRemoveAccountFromOrgunit"
                            on-remove-from-group="_onRemoveAccountFromGroup"
                            on-account-role-changed="_onAccountRoleChanged"
                            on-page-error="_onError"
                            on-revoke-assignee="_onRevokeAssigneeAccess"
                            on-approve-device="_onApproveDevice"
                            on-disapprove-device="_onDisapproveDevice"
                            on-image-upload-error="_onImageUploadError"
                            on-add-resource-admin="_onAddResourceToResourceAdmin"
                            on-revoke-resource-admin="_onRevokeResourceAdmin"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-manage-account-page>

                    <appsco-manage-contact-page name="manage-contact" page company-page
                            id="appscoManageContactPage"
                            route="[[ subroute ]]"
                            authorization-token="[[ authorizationToken ]]"
                            contacts-api="[[ _companyContactsApi ]]"
                            on-convert-contact-to-user="_onConvertContactToUserAction"
                            on-remove-from-group="_onRemoveContactFromGroup"
                            on-delete-contact="_onDeleteContactAction"
                            on-page-error="_onError"
                            on-revoke-assignee="_onRevokeAssigneeAccess"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-manage-contact-page>

                    <appsco-manage-customer-page name="manage-customer" page company-page
                            id="appscoManageCustomerPage"
                            route="[[ subroute ]]"
                            authorization-token="[[ authorizationToken ]]"
                            customers-api="[[ _companyCustomersApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-delete-customer="_onDeleteCustomerAction"
                            on-page-error="_onError"
                            on-remove-partner-admin-from-customer="_onRemovePartnerAdminFromCustomer"
                            on-add-partner-admin="_onAddPartnerAdminAction"
                            on-manage-customer-subscription="_onManageCustomerSubscription"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-manage-customer-page>

                    <appsco-manage-group-page name="manage-group" page company-page
                            id="appscoManageGroupPage"
                            route="[[ subroute ]]"
                            group="{{ _group }}"
                            authorization-token="[[ authorizationToken ]]"
                            group-api="[[ _companyGroupApi ]]"
                            on-remove-group="_onRemoveGroupAction"
                            on-page-error="_onError"
                            on-remove-company-role-from-group="_onRemoveCompanyRoleFromGroup"
                            on-remove-company-contact-from-group="_onRemoveCompanyContactFromGroup"
                            on-remove-company-resource-from-group="_onRemoveCompanyResourceFromGroup"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-manage-group-page>

                    <appsco-provisioning-page name="provisioning" page company-page
                            id="appscoProvisioningPage"
                            active-integrations-api="[[ _getActiveIntegrationsApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-edit-integration="_onEditIntegrationAction"
                            on-active-integration="_onIntegrationSetup"
                            on-force-sync="_onIntegrationForceSync"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-provisioning-page>

                    <appsco-manage-integration-page name="manage-integration" page company-page
                            id="appscoManageIntegrationPage"
                            route="[[ subroute ]]"
                            integration="[[ _selectedIntegration ]]"
                            integration-api="[[ _companyIntegrationApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            authorization-token="[[ authorizationToken ]]"
                            on-page-error="_onError"
                            on-remove-integration="_onRemoveIntegrationAction"
                            on-add-integration-rule="_onAddIntegrationRuleAction"
                            on-edit-integration-rule="_onEditIntegrationRuleAction"
                            on-run-integration-rule="_onRunIntegrationRuleAction"
                            on-remove-integration-rule="_onRemoveIntegrationRuleAction"
                            on-register-integration-webhook="_onRegisterIntegrationWebhookAction"
                            on-unregister-integration-webhook="_onUnregisterIntegrationWebhookAction"
                            on-integration-settings-changed="_onIntegrationSettingsChanged"
                            on-integration-reauthorized="_onIntegrationRequested"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-manage-integration-page>

                    <appsco-provisioning-integration-authorization-success-page name="provisioning-integration-authorization-success" page company-page
                            id="appscoProvisioningIntegrationSuccessPage"
                            on-provisioning="_showCompanyProvisioningPage"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-provisioning-integration-authorization-success-page>

                    <appsco-provisioning-integration-authorization-failed-page name="provisioning-integration-authorization-failed" page company-page
                            id="appscoProvisioningIntegrationFailedPage"
                            on-provisioning="_showCompanyProvisioningPage"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-provisioning-integration-authorization-failed-page>

                    <appsco-audit-log-page name="audit-log" page company-page
                            id="appscoAuditLogPage"
                            authorization-token="[[ authorizationToken ]]"
                            audit-log-api="[[ _companyAuditLogApi ]]"
                            company-api="[[ _companyApi ]]"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-audit-log-page>

                    <appsco-access-on-boarding-page name="access-on-boarding" page company-page
                            id="appscoAccessOnBoardingPage"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            access-on-boarding-users-api="[[ _accessOnBoardingUsersApi ]]"
                            export-access-on-boarding-api="[[ _exportAccessAccessOnBoardingApi ]]"
                            on-filter-access-on-boarding="_showProgressBar"
                            on-access-on-boarding-events-resolved="_onEventsResolved"
                            api-errors="[[ _apiErrors ]]"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-access-on-boarding-page>

                    <appsco-get-started-page
                            name="get-started" page company-page
                            id="appscoGetStartedPage"
                            account="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            tutorials="[[ _tutorials ]]"
                            on-tutorial-start="_onTutorialStart"
                            disable-upgrade$="[[!_applicationsApi]]"
                    >
                    </appsco-get-started-page>

                    <appsco-oauth-applications-page name="oauth-applications" page company-page
                            id="appscoOAuthApplicationsPage"
                            authorization-token="[[ authorizationToken ]]"
                            o-auth-applications-api="[[ _companyOAuthApplicationsApi ]]"
                            on-remove-oauth-application="_onRemoveOAuthApplicationAction"
                            on-edit-oauth-application="_onEditOAuthApplicationAction"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-oauth-applications-page>

                    <appsco-statistics-page name="statistics" page company-page
                            id="appscoStatisticsPage"
                            company-api="[[ _companyApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-statistics-page>

                    <appsco-reports-page name="reports" page company-page
                            id="appscoReportsPage"
                            get-access-report-api="[[ _getAccessReportApi ]]"
                            get-policies-api="[[ _companyPoliciesApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-open-access-report="_showAccessReportPage"
                            on-open-compliance-report="_showComplianceReportPage"
                            on-open-policies-report="_showPoliciesReportPage"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-reports-page>

                    <appsco-access-report-page name="access-report" page company-page
                            id="appscoAccessReportPage"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            roles-api="[[ _companyRolesApi ]]"
                            contacts-api="[[ _companyContactsApi ]]"
                            export-access-report-api="[[ _exportAccessReportApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-access-report-page>

                    <appsco-compliance-report-page name="compliance-report" page company-page
                            id="appscoComplianceReportPage"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            roles-api="[[ _companyRolesApi ]]"
                            contacts-api="[[ _companyContactsApi ]]"
                            export-compliance-report-api="[[ _exportComplianceReportApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-compliance-report-page>

                    <appsco-billing-page name="billing" page company-page
                            id="appscoBillingPage"
                            company-api="[[ _companyApi ]]"
                            account="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            on-manage-credit-card="_onManageCreditCard"
                            on-send-invoice="_onSendInvoice"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-billing-page>

                    <appsco-company-page name="company" page company-page
                            id="appscoCompanyPage"
                            company="{{ currentCompany.company }}"
                            account="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            transfer-token-api="[[ _getTransferTokenApi ]]"
                            partners-api-url="[[ api.partners ]]"
                            send-transfer-token-api="[[ _sendTransferTokenApi ]]"
                            save-ip-white-list-api="[[ _saveIPWhiteListApi ]]"
                            brand-logo="[[ _brandLogo ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-image-upload-error="_onImageUploadError"
                            on-company-settings-changed="_onCompanySettingsChanged"
                            on-company-ip-whitelist-changed="_onCompanyIPWhiteListChanged"
                            on-company-brand-settings-changed="_onCompanyBrandSettingsChanged"
                            on-company-branded-login-changed="_onCompanyBrandedLoginChanged"
                            on-company-logo-changed="_onCompanyLogoChanged"
                            on-company-dashboard-logo-changed="_onCompanyDashboardLogoChanged"
                            on-show-domains-page-actions="_onShowDomainsPageActions"
                            on-hide-domains-page-actions="_onHideDomainsPageActions"
                            on-show-groups-page-actions="_onShowGroupsPageActions"
                            on-hide-groups-page-actions="_onHideGroupsPageActions"
                            on-remove-domain="_onRemoveDomain"
                            on-get-token="_onDomainGetToken"
                            on-domain-verified="_onDomainVerified"
                            on-domain-not-verified="_onDomainNotVerified"
                            on-remove-group-from-company-role="_onRemoveGroupFromCompanyRole"
                            on-idp-settings-saved="_onIdPSettingsSaved"
                            on-deactivate-domain-idp-settings="_onDeactivateDomainIdPSettings"
                            on-idp-certificate-add="_onAddIdpCertificate"
                            on-transfer-token-sent="_onTransferTokenSent"
                            on-company-domains-loaded="_onCompanyDomainsLoadFinished"
                            on-empty-company-domains-loaded="_onCompanyDomainsLoadFinished"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-company-page>

                    <appsco-manage-oauth-application-page name="manage-oauth-application" page company-page
                            id="appscoManageOAuthApplicationPage"
                            route="[[ subroute ]]"
                            authorization-token="[[ authorizationToken ]]"
                            oauth-applications-api="[[ _companyOAuthApplicationsApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-remove-oauth-application="_onRemoveOAuthApplicationAction"
                            on-add-oauth-application-certificate="_onAddOAuthApplicationCertificateAction"
                            on-remove-oauth-application-certificate="_onRemoveOAuthApplicationCertificateAction"
                            on-oauth-application-updated="_onOAuthApplicationUpdated"
                            on-page-error="_onError"
                            on-resource-image-changed="_onResourceImageChanged"
                            on-image-upload-error="_onImageUploadError"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-manage-oauth-application-page>

                    <appsco-customer-billing-page name="customer-billing" page company-page
                            id="appscoCustomerBillingPage"
                            company-api="[[ _companyApi ]]"
                            account="[[ account ]]"
                            company-api="[[ _companyApi ]]"
                            current-company="[[ currentCompany.company ]]"
                            authorization-token="[[ authorizationToken ]]"
                            on-manage-credit-card="_onManageCreditCard"
                            on-update-subscription="_onUpdateSubscription"
                            on-send-invoice="_onSendInvoice"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-customer-billing-page>

                    <appsco-billing-report-page name="billing-report" page company-page
                            id="appscoBillingReportPage"
                            billing-report-api="[[ _billingReportApi ]]"
                            customers-api="[[ _companyCustomersApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-billing-report-page>

                    <appsco-dashboard-folder-page name="dashboard-folder" page company-page
                            id="appscoDashboardFolderPage"
                            route="[[ subroute ]]"
                            folder="{{ _activeFolder }}"
                            is-on-personal="[[ _personalFolderPage ]]"
                            authorization-token="[[ authorizationToken ]]"
                            folders-api="[[ api.foldersApi ]]"
                            netscaler-api="[[ _companyNetscalerFeatureApi ]]"
                            account="[[ account ]]"
                            page-config="[[ _pageConfig ]]"
                            on-loaded="_onLoadedPage"
                            on-revoke-application="_onRevokeApplication"
                            on-open-move-to-folder-dialog="_onOpenMoveToFolderDialog"
                            on-show-page="_onShowPage"
                            on-edit-shared-application="_onEditSharedApplication"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-dashboard-folder-page>

                    <appsco-saml-authn-request-invalid-page name="saml-authn-request-invalid" page company-page
                            id="appscoSamlAuthnRequestInvalidPage"
                            on-back-to-dashboard="_showCompanyHomePage"
                            disable-upgrade$="[[!_applicationsApi]]"
                    ></appsco-saml-authn-request-invalid-page>

                    <appsco-policies-page name="policies" page company-page
                            id="appscoPoliciesPage"
                            authorization-token="[[ authorizationToken ]]"
                            company-policies-api="[[ _companyPoliciesApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-observable-list-empty="_onObservableListEmpty"
                            on-observable-list-filled="_onObservableListFilled"
                            on-change-policy-status="_onChangePolicyStatusAction"
                            on-policy-updated="_onPolicyUpdated"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-policies-page>

                    <appsco-policies-report-page name="policies-report" page company-page
                            id="appscoPoliciesReportPage"
                            authorization-token="[[ authorizationToken ]]"
                            policies-api="[[ _companyPoliciesApi ]]"
                            roles-api="[[ _companyRolesApi ]]"
                            policies-report-api="[[ _getPoliciesReportApi ]]"
                            export-compliance-report-api="[[ _exportComplianceReportApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-filter-policies-report="_showProgressBar"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-policies-report-page>

                    <appsco-additional-options-page name="additional-options" page company-page
                            id="appscoAdditionalOptionsPage"
                            authorization-token="[[ authorizationToken ]]"
                            get-company-idp-config-list-api="[[ _getCompanyIdpConfigListApi ]]"
                            company="[[ currentCompany.company ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-add-item="_onAddIdPItemAction"
                            disable-upgrade$="[[!_applicationsApi]]"></appsco-additional-options-page>

                    <appsco-logout-page name="logout" page
                                        logout-api="[[ api.logout ]]"></appsco-logout-page>

                    <appsco-not-found-page name="404" page
                                           on-back-to-home-page="_onBackToHomePageAction"></appsco-not-found-page>
                </neon-animated-pages>
            </app-header-layout>
        </app-drawer-layout>

        <!--region Personal-->

        <template is="dom-if" if="[[ _homePage ]]">
            <appsco-application-add
                    id="appscoApplicationAdd"
                    authorization-token="[[ authorizationToken ]]"
                    applications-template-api="[[ api.applicationTemplates ]]"
                    dashboard-api="[[ _addAppApi ]]"
                    item="[[ _copyObject(item) ]]"
                    on-application-added="_onApplicationAdded"
                    on-link-added="_onApplicationAdded">
            </appsco-application-add>

            <appsco-application-share
                    id="appscoApplicationShare"
                    application="[[ application ]]"
                    authorization-token="[[ authorizationToken ]]"
                    accounts-api="[[ api.accounts ]]"
                    on-application-shared="_onApplicationShared"
            ></appsco-application-share>
        </template>

        <template is="dom-if" if="[[ _anyAccountPage ]]">
            <appsco-account-authorized-app-revoke
                    id="appscoAccountAuthorizedAppRevoke"
                    application="[[ _authorizedApplication ]]"
                    authorization-token="[[ authorizationToken ]]"
                    on-application-revoked="_onAuthorizedApplicationRevoked"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-account-authorized-app-revoke>

            <appsco-account-disable-2fa
                    id="appscoAccountDisableTwoFa"
                    two-fa-api="[[ api.twoFA ]]"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-account-disable-2fa>

            <appsco-account-orgunit
                    id="appscoAccountOrgunit"
                    authorization-token="[[ authorizationToken ]]"
                    company-orgunits-api="[[ _companyOrgunitsApi ]]"
                    accounts="[[ _selectedAccounts ]]"
                    on-added-to-orgunit="_onAccountsAddedToOrgunit"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-account-orgunit>

            <appsco-account-remove-orgunit
                    id="appscoAccountRemoveOrgunit"
                    authorization-token="[[ authorizationToken ]]"
                    account="[[ _role ]]"
                    on-account-removed-from-orgunit="_onAccountRemovedFromOrgunit"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-account-remove-orgunit>

            <appsco-account-remove-group
                    id="appscoAccountRemoveGroup"
                    authorization-token="[[ authorizationToken ]]"
                    account="[[ _role ]]"
                    on-account-removed-from-group="_onAccountRemovedFromGroup"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-account-remove-group>
        </template>

        <template is="dom-if" if="[[ _anyProvisioningPage ]]">
            <appsco-add-integration
                    id="appscoAddIntegration"
                    authorization-token="[[ authorizationToken ]]"
                    available-integrations-api="[[ _getAvailableIntegrationsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-requested="_onIntegrationRequested"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-add-integration>

            <appsco-add-integration-rule
                    id="appscoAddIntegrationRule"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-add-integration-rule>

            <appsco-edit-integration-rule
                    id="appscoEditIntegrationRule"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-rule-edited="_onIntegrationRuleEdited"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-edit-integration-rule>

            <appsco-run-integration-rule
                    id="appscoRunIntegrationRule"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-rule-run="_onIntegrationRuleRun"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-run-integration-rule>

            <appsco-run-integration-force-sync
                    id="appscoRunIntegrationForceSync"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-force-sync-done="_onForceSyncRun"
                    disable-upgrade$="[[!_applicationsApi]]"
            >
            </appsco-run-integration-force-sync>

            <appsco-remove-integration-rule
                    id="appscoRemoveIntegrationRule"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-rule-removed="_onIntegrationRuleRemoved"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-remove-integration-rule>

            <appsco-register-integration-webhook
                    id="appscoRegisterIntegrationWebhook"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-register-integration-webhook>

            <appsco-unregister-integration-webhook
                    id="appscoUnegisterIntegrationWebhook"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-webhook-unregistered="_onIntegrationWebhookUnregistered"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-unregister-integration-webhook>

            <appsco-remove-integration
                    id="appscoRemoveIntegration"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-integration-removed="_onIntegrationRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-remove-integration>
        </template>

        <template is="dom-if" if="[[ _directoryPage ]]">
            <appsco-account-remove
                    id="appscoAccountsRemove"
                    accounts="[[ _selectedAccounts ]]"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-accounts-removed="_onAccountsRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-account-remove>

            <appsco-directory-add-account
                    id="appscoDirectoryAccountAdd"
                    authorization-token="[[ authorizationToken ]]"
                    add-company-role-api="[[ _companyRolesApi ]]"
                    add-invitation-api="[[ _companyInvitationsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-company-role-created="_onCompanyRoleCreated"
                    on-invitation-created="_onInvitationCreated"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-directory-add-account>

            <appsco-import-accounts
                    id="appscoDirectoryImportAccounts"
                    authorization-token="[[ authorizationToken ]]"
                    import-api="[[ _companyImportAccountsApi ]]"
                    domain="[[ domain ]]"
                    on-import-finished="_onAccountImportFinished"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-import-accounts>

            <appsco-orgunit-modify
                    id="appscoOrgunitModify"
                    authorization-token="[[ authorizationToken ]]"
                    on-orgunit-added="_onOrgunitAdded"
                    on-orgunit-modified="_onOrgunitModified"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-orgunit-modify>

            <appsco-orgunit-remove
                    id="appscoOrgunitRemove"
                    authorization-token="[[ authorizationToken ]]"
                    on-orgunit-removed="_onOrgunitRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-orgunit-remove>
        </template>

        <template is="dom-if" if="[[ _companySettingsPage ]]">

            <appsco-company-add-domain
                    id="appscoCompanyAddDomain"
                    authorization-token="[[ authorizationToken ]]"
                    add-domain-api="[[ _companyDomainsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-domain-added="_onDomainAdded"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-company-add-domain>

            <appsco-company-add-certificate id="appscoCompanyAddCertificate"></appsco-company-add-certificate>

            <appsco-company-remove-domain
                    id="appscoCompanyRemoveDomain"
                    authorization-token="[[ authorizationToken ]]"
                    on-domain-removed="_onDomainRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-company-remove-domain>

        </template>

        <template is="dom-if" if="[[ _anyResourcePage ]]">
            <appsco-company-application-add
                    id="appscoCompanyApplicationsAdd"
                    authorization-token="[[ authorizationToken ]]"
                    applications-template-api="[[ api.applicationTemplates ]]"
                    add-application-api="[[ _companyApplicationsApi ]]"
                    link="[[ _copyObject(link) ]]"
                    item="[[ _copyObject(item) ]]"
                    on-application-added="_onCompanyApplicationAdded"
                    on-application-claims-updated="_onCompanyApplicationClaimsUpdated"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-company-application-add>

            <appsco-company-sso-application-add
                    id="appscoCompanySSOApplicationsAdd"
                    authorization-token="[[ authorizationToken ]]"
                    applications-template-api="[[ api.applicationTemplates ]]"
                    add-application-api="[[ _companyApplicationsApi ]]"
                    link="[[ _copyObject(link) ]]"
                    item="[[ _copyObject(item) ]]"
                    on-application-added="_onCompanyApplicationAdded"
                    on-application-claims-updated="_onCompanyApplicationClaimsUpdated"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-company-sso-application-add>

            <appsco-company-application-remove
                    id="appscoCompanyApplicationsRemove"
                    applications="[[ _selectedApplications ]]"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    api-errors="[[ apiErrors ]]"
                    on-applications-removed="_onApplicationsRemoved"
                    on-applications-remove-failed="_onApplicationsRemoveFailed"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-company-application-remove>

            <appsco-company-resource-settings-dialog
                    id="appscoCompanyResourceSettingsDialog"
                    account="[[ account ]]"
                    authorization-token="[[ authorizationToken ]]"
                    application="[[ application ]]"
                    domain="[[ domain ]]"
                    on-application-settings-saved="_onApplicationSettingsSaved"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-company-resource-settings-dialog>

            <appsco-add-resource-admin
                    id="appscoAddResourceAdmin"
                    resources="[[ _applicationsToShare ]]"
                    authorization-token="[[ authorizationToken ]]"
                    get-roles-api="[[ _companyRolesApi ]]"
                    get-contacts-api="[[ _companyContactsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-resources-shared="_onResourceAdminAdded"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-add-resource-admin>

            <appsco-resource-admin-revoke
                    id="appscoResourceAdminRevoke"
                    authorization-token="[[ authorizationToken ]]"
                    on-access-revoked="_onResourceAdminRevoked"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-resource-admin-revoke>

            <appsco-import-resources
                    id="appscoImportResources"
                    authorization-token="[[ authorizationToken ]]"
                    import-api="[[ _companyImportResourcesApi ]]"
                    on-import-finished="_onImportCompanyResourcesFinished"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-import-resources>
        </template>

        <template is="dom-if" if="[[ _anyGroupPage ]]">
            <appsco-company-add-group
                    id="appscoCompanyAddGroup"
                    authorization-token="[[ authorizationToken ]]"
                    company-groups-api="[[ _companyGroupsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-company-add-group>

            <appsco-delete-groups
                    id="appscoGroupsRemove"
                    groups="[[ _selectedGroups ]]"
                    company-api="[[ _companyApi ]]"
                    authorization-token="[[ authorizationToken ]]"
                    on-groups-removed="_onRemovedGroups"
                    on-groups-remove-failed="_onGroupsRemoveFailed"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-delete-groups>

            <appsco-company-remove-group
                    id="appscoCompanyRemoveGroup"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-group-removed="_onGroupRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-company-remove-group>

            <appsco-company-group-notification-dialog
                    id="appscoNotifyGroup"
                    authorization-token="[[ authorizationToken ]]"
                    company-groups-api="[[ _companyGroupsApi ]]"
                    company-notifications-api="[[ _companyNotificationsApi ]]"
                    on-notification-sent="_onNotificationSent"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-company-group-notification-dialog>

            <appsco-company-rename-group
                    id="appscoCompanyRenameGroup"
                    authorization-token="[[ authorizationToken ]]"
                    company-groups-api="[[ _companyGroupsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    disable-upgrade$="[[!_companyGroupsApi]]"></appsco-company-rename-group>
        </template>

        <template is="dom-if" if="[[ _anyContactPage ]]">
            <appsco-add-contact
                    id="appscoAddContact"
                    authorization-token="[[ authorizationToken ]]"
                    add-contact-api="[[ _companyContactsApi ]]"
                    add-invitation-api="[[ _companyInvitationsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-contact-created="_onContactCreated"
                    on-invitation-created="_onInvitationCreated"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-add-contact>

            <appsco-import-contacts
                    id="appscoImportContacts"
                    authorization-token="[[ authorizationToken ]]"
                    import-api="[[ _companyImportContactsApi ]]"
                    domain="[[ domain ]]"
                    on-import-finished="_onImportContactsFinished"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-import-contacts>
            <appsco-delete-contact
                    id="appscoDeleteContact"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-contact-deleted="_onContactDeleted"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-delete-contact>

            <appsco-delete-contacts
                    id="appscoContactsRemove"
                    contacts="[[ _selectedContacts ]]"
                    company-api="[[ _companyApi ]]"
                    authorization-token="[[ authorizationToken ]]"
                    on-contacts-removed="_onDeletedContacts"
                    on-contacts-remove-failed="_onDeleteContactsFailed"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-delete-contacts>
        </template>

        <template is="dom-if" if="[[ _oauthApplicationPage ]]">
            <appsco-add-oauth-application-certificate
                    id="appscoAddOauthApplicationCertificate"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-oauth-application-certificate-added="_onOauthApplicationCertificateAdded"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-add-oauth-application-certificate>

            <appsco-remove-oauth-application-certificate
                    id="appscoRemoveCertificate"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-oauth-application-certificate-removed="_onOAuthApplicationCertificateRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-remove-oauth-application-certificate>

            <appsco-add-oauth-application
                    id="appscoAddOauthApplication"
                    authorization-token="[[ authorizationToken ]]"
                    oauth-applications-api="[[ _companyOAuthApplicationsApi ]]"
                    company="[[ currentCompany.company ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-oauth-application-added="_onOauthApplicationAdded"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-add-oauth-application>

            <appsco-remove-oauth-application
                    id="appscoRemoveOAuthApplication"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-oauth-application-removed="_onOAuthApplicationRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-remove-oauth-application>
        </template>

        <template is="dom-if" if="[[ _anyCustomersPage ]]">
            <appsco-add-partner-admin
                    id="appscoAddPartnerAdmin"
                    customers="[[ _selectedCustomers ]]"
                    authorization-token="[[ authorizationToken ]]"
                    get-roles-api="[[ _companyRolesApi ]]"
                    add-partner-admin-api="[[ _addPartnerAdminToCustomerApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-partner-admins-added="_onPartnerAdminsAdded"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-add-partner-admin>

            <appsco-import-customer-resources
                    id="appscoImportCustomerResources"
                    authorization-token="[[ authorizationToken ]]"
                    import-api="[[ _importCustomerResourcesApi ]]"
                    domain="[[ domain ]]"
                    on-import-finished="_onCustomerResourcesImportFinished"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-import-customer-resources>

            <appsco-add-customer
                    id="appscoAddCustomer"
                    authorization-token="[[ authorizationToken ]]"
                    customers-api="[[ _companyCustomersApi ]]"
                    company-convert-to-customer-api="[[ _companyConvertToCustomerApi ]]"
                    roles-api="[[ _companyRolesApi ]]"
                    check-if-customer-exists-api="[[ _checkIfCustomerExistsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-customer-added="_onCustomerAdded"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-add-customer>

            <appsco-remove-customers
                    id="appscoCustomersRemove"
                    customers="[[ _selectedCustomers ]]"
                    customers-api="[[ _companyCustomersApi ]]"
                    authorization-token="[[ authorizationToken ]]"
                    on-customers-removed="_onRemovedCustomers"
                    on-customers-remove-failed="_onRemovedCustomersFailed"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-remove-customers>

            <appsco-import-customers
                    id="appscoImportCustomers"
                    authorization-token="[[ authorizationToken ]]"
                    import-api="[[ _importCustomersApi ]]"
                    domain="[[ domain ]]"
                    on-import-finished="_onCustomersImportFinished"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-import-customers>

            <appsco-remove-customer
                    id="appscoRemoveCustomer"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-customer-removed="_onCustomerRemoved"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-remove-customer>

            <appsco-manage-customer-subscription
                    id="appscoManageCustomerSubscription"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    partner="[[ currentCompany.company ]]"
                    on-customer-licences-managed="_onCustomerLicencesManaged"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-manage-customer-subscription>

            <appsco-customer-partner-admin-remove
                    id="appscoCustomerPartnerAdminRemove"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-partner-admin-removed-from-customer="_onPartnerAdminRemovedFromCustomer"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-customer-partner-admin-remove>
        </template>

        <template is="dom-if" if="[[ _anyBillingPage ]]">
            <appsco-credit-card
                    id="appscoCreditCard"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    on-credit-card-added="_onCreditCardAdded"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-credit-card>

            <appsco-upgrade-action
                    id="appscoUpgradeAction"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    on-subscription-changed="_onSubscriptionChanged"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-upgrade-action>

            <appsco-update-subscription-action
                    id="appscoUpdateSubscriptionAction"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    on-subscription-updated="_onSubscriptionUpdated"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-update-subscription-action>

            <appsco-subscription-cancel
                    id="appscoSubscriptionCancel"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    on-subscription-canceled="_onSubscriptionCanceled"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-subscription-cancel>

            <appsco-billing-send-invoice
                    id="appscoBillingSendInvoice"
                    company="[[ currentCompany ]]"
                    authorization-token="[[ authorizationToken ]]"
                    company-api="[[ _companyApi ]]"
                    on-invoice-sent="_onInvoiceSent"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-billing-send-invoice>
        </template>

        <template is="dom-if" if="[[ _companyPage ]]">
            <appsco-add-resource-to-resource-admin
                    id="appscoAddResourceToResourceAdmin"
                    authorization-token="[[ authorizationToken ]]"
                    get-resources-api="[[ _companyApplicationsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-resource-admin-assigned="_onResourceAdminAssigned"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-add-resource-to-resource-admin>

            <appsco-application-assignee-claims
                    id="appscoApplicationAssigneeClaims"
                    application="[[ _companyApplication ]]"
                    authorization-token="[[ authorizationToken ]]"
                    on-claims-changed="_onAssigneeClaimsChanged"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-application-assignee-claims>

            <appsco-application-assignee-revoke
                    id="appscoApplicationAssigneeRevoke"
                    authorization-token="[[ authorizationToken ]]"
                    on-access-revoked="_onAssigneeAccessRevoked"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-application-assignee-revoke>

            <appsco-invitation-remove
                    id="appscoInvitationRemove"
                    authorization-token="[[ authorizationToken ]]"
                    on-invitation-removed="_onInvitationRemoved"
                    on-invitation-already-removed="_onInvitationAlreadyRemoved"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-invitation-remove>

            <appsco-application-remove-group
                    id="appscoApplicationRemoveGroup"
                    authorization-token="[[ authorizationToken ]]"
                    application="[[ application ]]"
                    on-application-removed-from-group="_onApplicationRemovedFromGroup"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-application-remove-group>

            <appsco-account-approve-device
                    id="appscoAccountApproveDevice"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-device-approve-finished="_onDeviceApproveFinished"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-account-approve-device>

            <appsco-account-disapprove-device
                    id="appscoAccountDisapproveDevice"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-device-disapprove-finished="_onDeviceDisapproveFinished"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-account-disapprove-device>

            <appsco-contact-remove-group
                    id="appscoContactRemoveGroup"
                    authorization-token="[[ authorizationToken ]]"
                    on-contact-removed-from-group="_onContactRemovedFromGroup"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-contact-remove-group>

            <appsco-dialog-application-company-add
                    id="appscoDialogApplicationCompanyAdd"
                    authorization-token="[[ authorizationToken ]]"
                    add-application-api="[[ _companyApplicationsApi ]]"
                    on-application-added="_onCompanyApplicationAdded"
                    on-application-claims-updated="_onCompanyApplicationClaimsUpdated"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-dialog-application-company-add>

            <appsco-company-domain-token
                    id="appscoCompanyDomainToken"></appsco-company-domain-token>

            <appsco-resource-add-groups
                    id="appscoShareToGroupDialog"
                    authorization-token="[[ authorizationToken ]]"
                    groups-api="[[ _companyGroupsApi ]]"
                    disable-upgrade$="[[!_companyGroupsApi]]"></appsco-resource-add-groups>

            <appsco-resource-remove-from-group
                    id="appscoResourceRemoveFromGroup"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-resource-removed-from-group="_onResourceRemovedFromGroup"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-resource-remove-from-group>

            <appsco-convert-contact
                    id="appscoConvertContact"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-contact-converted="_onContactConverted"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-convert-contact>

            <appsco-deactivate-idp-settings
                    id="appscoDeactivateIdPSettings"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-idp-settings-deactivated="_onIdPSettingsDeactivated"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-deactivate-idp-settings>

            <appsco-group-add-resource
                    id="appscoGroupAddResource"
                    group="[[ _group ]]"
                    authorization-token="[[ authorizationToken ]]"
                    on-resources-added-to-group="_onResourcesAddedToGroup"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-group-add-resource>

            <appsco-role-reset-two-fa
                    id="appscoRoleResetTwoFA"
                    authorization-token="[[ authorizationToken ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-role-two-fa-reset="_onRoleTwoFAReset"
                    disable-upgrade$="[[!_applicationsApi]]"></appsco-role-reset-two-fa>

            <appsco-send-notification
                    id="appscoSendNotification"
                    authorization-token="[[ authorizationToken ]]"
                    company-notifications-api="[[ _companyNotificationsApi ]]"
                    get-roles-api="[[ _companyRolesApi ]]"
                    get-contacts-api="[[ _companyContactsApi ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-notification-sent="_onNotificationSent"
                    disable-upgrade$="[[!_applicationsApi]]"
            ></appsco-send-notification>

            <appsco-company-notice
                    id="appscoCompanyNotice"></appsco-company-notice>

            <appsco-change-policy-status id="appscoChangePolicyStatus"
                                         authorization-token="[[ authorizationToken ]]"
                                         api-errors="[[ _apiErrors ]]"
                                         on-policy-status-changed="_onPolicyStatusChanged"
                                         disable-upgrade$="[[!_applicationsApi]]"></appsco-change-policy-status>

            <appsco-idp-resource-add
                    id="appscoIdpResourceAdd"
                    authorization-token="[[ authorizationToken ]]"
                    add-resource-api="[[ _companyApplicationsApi ]]"
                    link="[[ _copyObject(link) ]]"
                    api-errors="[[ _apiErrors ]]"
                    on-resource-added="_onIdpResourceAdded"
                    disable-upgrade$="[[!_applicationsApi]]">
            </appsco-idp-resource-add>

        </template>

        <!--region Shared-->
        <appsco-import-personal-resources
                id="appscoImportPersonalResources"
                authorization-token="[[ authorizationToken ]]"
                application-template-api="[[ api.applicationTemplates ]]"
                on-import-finished="_onImportPersonalResourcesFinished"
                disable-upgrade$="[[!_applicationsApi]]"></appsco-import-personal-resources>

        <appsco-application-settings-dialog
                id="appscoApplicationSettingsDialog"
                account="[[ account ]]"
                authorization-token="[[ authorizationToken ]]"
                application="[[ application ]]"
                on-application-settings-saved="_onApplicationCredentialsChanged"
                disable-upgrade$="[[!_applicationsApi]]"
        ></appsco-application-settings-dialog>

        <appsco-application-remove
                id="appscoApplicationRemove"
                application="[[ application ]]"
                authorization-token="[[ authorizationToken ]]"
                on-application-removed="_onApplicationRemoved"
                disable-upgrade$="[[!_applicationsApi]]"></appsco-application-remove>

        <appsco-application-subscriber-revoke
                id="appscoApplicationSubscriberRevoke"
                authorization-token="[[ authorizationToken ]]"
                on-subscription-revoked="_onSubscriptionRevoked"
                disable-upgrade$="[[!_applicationsApi]]"
        ></appsco-application-subscriber-revoke>

        <appsco-application-revoke
                id="appscoApplicationRevoke"
                authorization-token="[[ authorizationToken ]]"
                on-application-instance-removed="_onApplicationInstanceRevoked"
                disable-upgrade$="[[!_applicationsApi]]"
        ></appsco-application-revoke>

        <appsco-folders-application-add
                id="appscoFoldersApplicationAdd"
                authorization-token="[[ authorizationToken ]]"
                folders-api="[[ api.foldersApi ]]"
                api-errors="[[ _apiErrors ]]"
                disable-upgrade$="[[!_applicationsApi]]">
        </appsco-folders-application-add>

        <appsco-add-folder id="appscoAddFolder"
                           authorization-token="[[ authorizationToken ]]"
                           folders-api="[[ api.foldersApi ]]"
                           company="[[ currentCompany.company ]]"
                           api-errors="[[ _apiErrors ]]"
                           on-folder-added="_onFolderAdded"
                           disable-upgrade$="[[!_applicationsApi]]">
        </appsco-add-folder>

        <appsco-folders-rename
                id="appscoFoldersRename"
                authorization-token="[[ authorizationToken ]]"
                folders-api="[[ api.foldersApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-folder-renamed="_onFolderRenamed"
                disable-upgrade$="[[!_applicationsApi]]">
        </appsco-folders-rename>

        <appsco-folders-remove
                id="appscoFoldersRemove"
                authorization-token="[[ authorizationToken ]]"
                folders-api="[[ api.foldersApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-folder-removed="_onFolderRemoved"
                disable-upgrade$="[[!_applicationsApi]]">
        </appsco-folders-remove>

        <appsco-share-resource
                id="appscoShareResource"
                resources="[[ _applicationsToShare ]]"
                authorization-token="[[ authorizationToken ]]"
                get-roles-api="[[ _companyRolesApi ]]"
                get-contacts-api="[[ _companyContactsApi ]]"
                get-groups-api="[[ _companyGroupsApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-resources-shared="_onResourcesShared"
                items-loaded="{{ shareResourceDialogAccountsLoaded }}"
                disable-upgrade$="[[!_applicationsApi]]"
        ></appsco-share-resource>

        <appsco-role-save-client-data account="[[ account ]]"
                                      save-api="[[ api.saveClientDataApi ]]"
                                      authorization-token="[[ authorizationToken ]]"></appsco-role-save-client-data>

        <!--endRegion Shared-->

        <template is="dom-if" if="[[ api.me ]]">

            <iron-ajax auto
                       id = "getPageConfigRequest"
                       url="[[ api.pageConfigApi ]]"
                       on-response="_onGetPageConfig"
                       headers="[[ _headers ]]"></iron-ajax>

            <iron-ajax auto
                       id="getCompaniesAccountIsContactIn"
                       url="[[ api.companiesAccountIsContactInApi ]]"
                       on-response="_onGetCompaniesAccountIsContactInApiResponse"
                       headers="[[ _headers ]]"></iron-ajax>

            <iron-ajax id="getIsUserLoggedIn"
                       url="[[ api.isUserLoggedInApi ]]"
                       headers="[[ _headers ]]"
                       handle-as="json"
                       on-response="_onGetIsUserLoggedInResponse"
                       on-error="_onIsUserLoggedInError"></iron-ajax>

            <iron-ajax id="checkNewNotifications"
                       url="[[ api.checkNewNotifications ]]"
                       headers="[[ _headers ]]"
                       handle-as="json"
                       on-response="_onCheckNewNotificationsResponse"></iron-ajax>

            <iron-ajax id="notificationsSeen"
                       method="PUT"
                       url="[[ api.notificationsSeen ]]"
                       headers="[[ _headers ]]"
                       handle-as="json"></iron-ajax>
        </template>

        <template is="dom-if" if="[[ api.dashboards ]]">
            <iron-ajax id="getDashboardsLink"
                       url="[[ api.dashboards ]]?extended=1"
                       on-response="_onDashboardsResponse"
                       headers="[[ _headers ]]"></iron-ajax>
        </template>

    </template>

    <script>
        class AppscoApp extends Polymer.mixinBehaviors([Appsco.HeadersMixin], Polymer.Element) {
            static get is() { return 'appsco-app'; }

            static get properties() {
                return {
                    _progress: {
                        type: String,
                        value: "0"
                    },

                    _companyPage: {
                        type: Boolean,
                        computed: '_computeCompany(page)'
                    },

                    _contactPage: {
                        type: Boolean,
                        computed: '_computeContactPage(page)'
                    },

                    _contactsPage: {
                        type: Boolean,
                        computed: '_computePage(page, "contacts")'
                    },

                    _homePage: {
                        type: Boolean,
                        computed: '_computePage(page, "home")'
                    },

                    _resourcePage: {
                        type: Boolean,
                        computed: '_computePage(page, "resource")'
                    },

                    _resourcesPage: {
                        type: Boolean,
                        computed: '_computePage(page, "resources")'
                    },

                    _manageResourcePage: {
                        type: Boolean,
                        computed: '_computePage(page, "manage-resource")'
                    },

                    _accountPage: {
                        type: Boolean,
                        computed: '_computePage(page, "account")'
                    },

                    _companyAccountPage: {
                        type: Boolean,
                        computed: '_computePage(page, "company-account")'
                    },

                    _companyHomePage: {
                        type: Boolean,
                        computed: '_computePage(page, "company-home")'
                    },

                    _tryBusinessPage: {
                        type: Boolean,
                        computed: '_computePage(page, "trybusiness")'
                    },

                    _directoryPage: {
                        type: Boolean,
                        computed: '_computePage(page, "directory")'
                    },

                    _manageAccountPage: {
                        type: Boolean,
                        computed: '_computePage(page, "manage-account")'
                    },

                    _manageContactPage: {
                        type: Boolean,
                        computed: '_computePage(page, "manage-contact")'
                    },

                    _manageCustomerPage: {
                        type: Boolean,
                        computed: '_computePage(page, "manage-customer")'
                    },

                    _manageGroupPage: {
                        type: Boolean,
                        computed: '_computePage(page, "manage-group")'
                    },

                    _manageIntegrationPage: {
                        type: Boolean,
                        computed: '_computePage(page, "manage-integration")'
                    },

                    _groupsPage: {
                        type: Boolean,
                        computed: '_computeGroupsPage(page)'
                    },

                    _anyGroupPage: {
                        type: Boolean,
                        computed: '_computeAnyGroupPage(page)'
                    },

                    _customersPage: {
                        type: Boolean,
                        computed: '_computePage(page, "customers")'
                    },

                    _auditLogPage: {
                        type: Boolean,
                        computed: '_computePage(page, "audit-log")'
                    },

                    _accessOnBoardingPage: {
                        type: Boolean,
                        computed: '_computePage(page, "access-on-boarding")'
                    },

                    _billingPage: {
                        type: Boolean,
                        computed: '_computePage(page, "billing")'
                    },

                    _customerBillingPage: {
                        type: Boolean,
                        computed: '_computePage(page, "customer-billing")'
                    },

                    _companySettingsPage: {
                        type: Boolean,
                        computed: '_computePage(page, "company")'
                    },

                    _reportsPage: {
                        type: Boolean,
                            computed: '_computePage(page, "reports")'
                    },

                    _accessReportPage: {
                        type: Boolean,
                            computed: '_computePage(page, "access-report")'
                    },

                    _complianceReportPage: {
                        type: Boolean,
                            computed: '_computePage(page, "compliance-report")'
                    },

                    _billingReportPage: {
                        type: Boolean,
                            computed: '_computePage(page, "billing-report")'
                    },

                    _policiesReportPage: {
                        type: Boolean,
                            computed: '_computePage(page, "policies-report")'
                    },

                    _provisioningPage: {
                        type: Boolean,
                            computed: '_computePage(page, "provisioning")'
                    },

                    _anyProvisioningPage: {
                        type: Boolean,
                            computed: '_computeAnyProvisioningPage(page)'
                    },

                    _anyResourcePage: {
                        type: Boolean,
                            computed: '_computeAnyResourcePage(page)'
                    },

                    _anyContactPage: {
                        type: Boolean,
                            computed: '_computeAnyContactPage(page)'
                    },

                    _anyCustomersPage: {
                        type: Boolean,
                            computed: '_computeAnyCustomerPage(page)'
                    },

                    _anyBillingPage: {
                        type: Boolean,
                            computed: '_computeAnyBillingPage(page)'
                    },

                    _anyAccountPage: {
                        type: Boolean,
                            computed: '_computeAnyAccountPage(page)'
                    },

                    _oauthApplicationsPage: {
                        type: Boolean,
                            computed: '_computePage(page, "oauth-applications")'
                    },

                    _manageOauthApplicationPage: {
                        type: Boolean,
                            computed: '_computePage(page, "manage-oauth-application")'
                    },

                    _oauthApplicationPage: {
                        type: Boolean,
                            computed: '_computeOAuthPage(page)'
                    },

                    _policiesPage: {
                        type: Boolean,
                            computed: '_computePage(page, "policies")'
                    },

                    _dashboardFolderPage: {
                        type: Boolean,
                            computed: '_computePage(page, "dashboard-folder")'
                    },

                    _additionalOptionsPage: {
                        type: Boolean,
                            computed: '_computePage(page, "additional-options")'
                    },

                    page: {
                        type: String,
                            observer: '_pageChanged'
                    },

                    _prefixPath: {
                        type: String,
                            computed: '_computePrefixPath(domain)'
                    },

                    domain: {
                        type: String
                    },

                    language: {
                        value: 'en',
                            type: String
                    },

                    _pageName: {
                        type: String,
                            computed: '_computePageName(page)'
                    },

                    api: {
                        type: Object,
                            value: function () { return {}; },
                        notify: true
                    },

                    _apiErrors: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    account: {
                        type: Object,
                            value: function() {
                            return {};
                        },
                        notify: true
                    },

                    _accountManaged: {
                        type: Boolean,
                            computed: '_computeAccountManagedState(account, currentCompany)'
                    },

                    _role: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    _group: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    link: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    item: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    /**
                     * Selected application.
                     */
                    application: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    currentCompany: {
                        type: Object,
                            value: function() {
                            return {};
                        },
                        notify: true,
                        observer: '_onCurrentCompanyChanged'
                    },

                    _defaultCompany: {
                        type: String,
                            computed: '_computeDefaultCompany(account)'
                    },

                    _companiesAccountIsContactIn: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },

                    _companiesAccountHasPermissionTo: {
                        type: Array,
                            computed: '_computeCompaniesAccountHasPermissionTo(account, _companiesAccountIsContactIn)'
                    },

                    /**
                     * Selected company application.
                     */
                    _companyApplication: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    /**
                     * Selected applications (company).
                     */
                    _selectedApplications: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },

                    /**
                     * Company applications to share.
                     */
                    _applicationsToShare: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },

                    /**
                     * Selected authorized application that is to be removed.
                     */
                    _authorizedApplication: {
                        type: Object,
                            value: function() {
                            return {};
                        },
                        notify: true
                    },

                    /**
                     * Selected accounts (company).
                     */
                    _selectedAccounts: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },

                    /**
                     * Selected contacts.
                     */
                    _selectedContacts: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },

                    /**
                     * Selected customers.
                     */
                    _selectedCustomers: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },

                    /**
                     * Selected groups.
                     */
                    _selectedGroups: {
                        type: Array,
                            value: function() {
                            return [];
                        }
                    },


                    /**
                     * Selected integration for provisioning settings
                     */
                    _selectedIntegration: {
                        type: Object,
                            value: function() { return {}; }
                    },

                    cookieSecure: {
                        type: String,
                            value: ''
                    },

                    _addAppApi: {
                        type: String
                    },

                    _applicationsApi: {
                        type: String
                    },

                    _companyAdmin: {
                        type: Boolean,
                            computed: '_computeCompanyAdmin(currentCompany)'
                    },

                    _resourceAdmin: {
                        type: Boolean,
                            value: false
                    },

                    _companyContact: {
                        type: Boolean,
                            computed: '_computeCompanyContact(currentCompany)'
                    },

                    _billingReportApi: {
                        type: String
                    },

                    _companyApi: {
                        type: String
                    },

                    _companyIconsApi: {
                        type: String
                    },

                    _companyNetscalerFeatureApi: {
                        type: String
                    },

                    _companyApplicationsApi: {
                        type: String
                    },

                    _companyImportResourcesApi: {
                        type: String,
                            computed: '_computeCompanyImportResourcesApi(_companyApplicationsApi)'
                    },

                    _companyInvitationsApi: {
                        type: String
                    },

                    _companyRolesApi: {
                        type: String
                    },

                    _companyImportAccountsApi: {
                        type: String
                    },

                    _companyContactsApi: {
                        type: String
                    },

                    _companyImportContactsApi: {
                        type: String,
                            computed: '_computeCompanyImportContactsApi(_companyContactsApi)'
                    },

                    _companyCustomersExportApi: {
                        type: String,
                            computed: '_computeCompanyExportCustomersApi(_companyCustomersApi)'
                    },

                    _companyOrgunitsApi: {
                        type: String
                    },

                    _companySubscriptionApi: {
                        type: String
                    },

                    _companyDomainsApi: {
                        type: String
                    },

                    _companyGroupsApi: {
                        type: String
                    },

                    _companyGroupApi: {
                        type: String
                    },

                    _companySamlMetadataApi: {
                        type: String
                    },

                    _companyAuditLogApi: {
                        type: String
                    },

                    _companyCustomersApi: {
                        type: String
                    },

                    _companyConvertToCustomerApi: {
                        type: String
                    },

                    _companyIntegrationApi: {
                        type: String
                    },

                    _addPartnerAdminToCustomerApi: {
                        type: String,
                            computed: '_computeAddPartnerAdminToCustomerApi(_companyCustomersApi)'
                    },

                    _importCustomerResourcesApi: {
                        type: String,
                            computed: '_computeCustomerResourcesImportApi(_companyCustomersApi)'
                    },

                    _partnerApi: {
                        type: String
                    },

                    _importCustomersApi: {
                        type: String,
                            computed: '_computeImportCustomersApi(_companyCustomersApi)'
                    },

                    _checkIfCustomerExistsApi: {
                        type: String,
                            computed: '_computeCheckIfCustomerExistsApi(_partnerApi)'
                    },

                    _getAccessReportApi: {
                        type: String
                    },

                    _getComplianceReportApi: {
                        type: String
                    },

                    _getPoliciesReportApi: {
                        type: String
                    },

                    _exportAccessReportApi: {
                        type: String,
                            computed: '_computeExportAccessReportApi(_getAccessReportApi)'
                    },

                    _exportComplianceReportApi: {
                        type: String,
                            computed: '_computeExportComplianceReportApi(_getComplianceReportApi)'
                    },

                    _exportPoliciesReportApi: {
                        type: String,
                            computed: '_computeExportPoliciesReportApi(_getPoliciesReportApi)'
                    },

                    _exportBillingReportApi: {
                        type: String,
                            computed: '_computeExportBillingReportApi(_billingReportApi)'
                    },

                    _getTransferTokenApi: {
                        type: String
                    },

                    _sendTransferTokenApi: {
                        type: String
                    },

                    _saveIPWhiteListApi: {
                        type: String
                    },

                    _getAvailableIntegrationsApi: {
                        type: String
                    },

                    _getActiveIntegrationsApi: {
                        type: String
                    },

                    _companyOAuthApplicationsApi: {
                        type: String
                    },

                    _companyFoldersApi: {
                        type: String
                    },

                    _companyIconsWithoutFolderApi: {
                        type: String,
                            computed: '_computeCompanyIconsWithoutFolderApi(_companyFoldersApi)'
                    },

                    _companyPoliciesApi: {
                        type: String
                    },

                    _accessOnBoardingUsersApi: {
                        type: String
                    },

                    _exportAccessAccessOnBoardingApi: {
                        type: String,
                            computed: '_computeExportAccessAccessOnBoardingApi(_accessOnBoardingUsersApi)'
                    },

                    _getCompanyIdpConfigListApi: {
                        type: String
                    },

                    _subscription: {
                        type: Object,
                            value: function() {
                            return {};
                        }
                    },

                    _globalActions: {
                        type: Boolean,
                            value: true
                    },

                    _selectedApplicationsGroup: {
                        type: Number,
                            value: 0
                    },

                    _toastMessage: {
                        type: String,
                            value: ''
                    },

                    _toastPersistence: {
                        type: Boolean,
                            value: false
                    },

                    mobileScreen: {
                        type: Boolean,
                            value: false,
                            reflectToAttribute: true
                    },

                    tabletScreen: {
                        type: Boolean,
                            value: false,
                            reflectToAttribute: true
                    },

                    _companyUser: {
                        type: Boolean,
                            computed: "_computeCompanyUser(currentCompany)"
                    },

                    _accountCanCreateCompany: {
                        type: Boolean,
                            computed: "_computeAccountCanCreateCompany(account)"
                    },

                    _brandLogo: {
                        type: String,
                            computed: '_computeBrandLogo(currentCompany, _companyPage)'
                    },

                    _brandTitle: {
                        type: String,
                            computed: '_computeBrandTitle(currentCompany, _companyPage)'
                    },

                    _contactIconsApi: {
                        type: String,
                            computed: '_computeContactIconsApi(domain, currentCompany)'
                    },

                    _accessBilling: {
                        type: Boolean,
                            computed: "_computeAccessBilling(currentCompany)"
                    },

                    _notificationsHash: {
                        type: String,
                            value: ''
                    },

                    _personalFolderPage: {
                        type: Boolean,
                            value: false
                    },

                    _tutorials: {
                        type: Object,
                            value: function(){ return {}; },
                        notify: true
                    },

                    _tutorialsPageVisible: {
                        type: Boolean,
                            computed: "_computeTutorialsPageVisible(_tutorials, _companyAdmin)"
                    },

                    _directoryPageLoaded: {
                        type: Boolean,
                            value: false,
                            notify: true
                    },

                    _resourcesPageLoaded : {
                        type: Boolean,
                            value: false,
                            notify: true
                    },

                    shareResourceDialogAccountsLoaded: {
                        type: Boolean,
                            value: false,
                            notify: true
                    },

                    _companyDomainsLoaded: {
                        type: Boolean,
                            value: false,
                            notify: true
                    },

                    _pageConfig: {
                        type: Object,
                            value: function() {
                            return {
                                home: {
                                    display_style: 'grid'
                                },
                                'company-home': {
                                    display_style: 'grid'
                                },
                                'contact-home': {
                                    display_style: 'grid'
                                },
                                resources: {
                                    display_style: 'list'
                                }
                            };
                        }
                    },

                    isTutorialActive: {
                        type: Boolean,
                            notify: true,
                            value: false
                    }
                }
            }

            static get observers() {
                return [
                    '_updateScreen(mobileScreen, tabletScreen)',
                    '_routePageChanged(routeData.page)',
                    '_changeTheme(_companyPage, currentCompany)',
                    '_redirectToCompany(page, currentCompany, account)',
                    '_setupCompanyAccountPage(page, account)',
                    '_handlePagePermission(currentCompany, page)'
                ];
            }

            ready() {
                super.ready();

                Polymer.RenderStatus.beforeNextRender(this, function() {
                    if (this.mobileScreen || this.tabletScreen) {
                        this.updateStyles();
                    }
                });

                Polymer.RenderStatus.afterNextRender(this, function() {
                    this._addListeners();

                    this._getIsUserLoggedIn();
                    this._checkNewNotifications();
                });
            }

            _addListeners() {
                this.addEventListener('show-page-progress-bar', this._showProgressBar);
                this.addEventListener('show-page-progress-bar', this._showProgressBar);
                this.addEventListener('notify-about-error', this._notifyAboutError);
                this.addEventListener('page-global-info', this._onInfoAction);
                this.addEventListener('page-global-filters', this._onFiltersAction);
                this.addEventListener('page-global-toggle-additional-options', this._onToggleAdditionalOptionsAction);
                this.addEventListener('page-loaded', this._onPageLoaded);
                this.addEventListener('filter-done', this._onPageLoaded);
                this.addEventListener('upgrade-active', this._fireUpgrade);
                this.addEventListener('cancel-subscription', this._onCancelSubscription);
                this.addEventListener('reload-account-log', this._onReloadAccountLog);
                this.addEventListener('edit-application', this._onEditApplication);
                this.addEventListener('info-edit-application', this._onInfoEditApplication);
                this.addEventListener('share-application', this._onShareApplication);
                this.addEventListener('edit-resource', this._onEditCompanyResource);
                this.addEventListener('info-edit-resource', this._onInfoEditCompanyResource);
                this.addEventListener('info-edit-application-credentials', this._onEditApplicationCredentials);
                this.addEventListener('reload-applications', this._onReloadApplications);
                this.addEventListener('reload-accounts', this._onReloadAccounts);
                this.addEventListener('application-settings-saved', this._onApplicationUpdated);
                this.addEventListener('show-subscription-limit-reached-info', this._onShowSubscriptionLimitReachedInfo);
                this.addEventListener('copied-application-attribute', this._onCopiedApplicationAttribute);
                this.addEventListener('group-added', this._onGroupAdded);
                this.addEventListener('group-renamed', this._onGroupRenamed);
                this.addEventListener('remove-invitation', this._onRemoveInvitationAction);
                //this.addEventListener('reload-contacts', this._onReloadContacts);
                this.addEventListener('change-assignee-claims', this._onChangeAssigneeClaims);
                this.addEventListener('enable-advanced-settings', this._onEnableAccountAdvancedSettings);
                this.addEventListener('disable-advanced-settings', this._onDisableAccountAdvancedSettings);
                this.addEventListener('twofa-enabled', this._onTwoFaEnabled);
                this.addEventListener('disable-twofa', this._onDisableTwoFaAction);
                this.addEventListener('twofa-disabled', this._onTwoFaDisabled);
                this.addEventListener('revoke-authorized-application', this._onRevokeAuthorizedApplication);
                this.addEventListener('token-generated', this._onTokenGenerated);
                this.addEventListener('reset-page-actions', this._onResetPageActions);

                // export
                this.addEventListener('export-access-report', this._onExportAccessReportAction);
                this.addEventListener('export-compliance-report', this._onExportComplianceReportAction);
                this.addEventListener('export-policies-report', this._onExportPoliciesReportAction);
                this.addEventListener('export-billing-report', this._onExportBillingReportAction);

                // success
                this.addEventListener('export-company-log-finished', this._onExportReportFinished);
                this.addEventListener('export-access-on-boarding-finished', this._onExportReportFinished);
                this.addEventListener('export-access-report-finished', this._onExportReportFinished);
                this.addEventListener('export-compliance-report-finished', this._onExportReportFinished);
                this.addEventListener('export-policies-report-finished', this._onExportReportFinished);
                this.addEventListener('export-billing-report-finished', this._onExportReportFinished);

                // fails
                this.addEventListener('export-access-on-boarding-failed', this._onExportReportFailed);
                this.addEventListener('export-access-report-failed', this._onExportReportFailed);
                this.addEventListener('export-compliance-report-failed', this._onExportReportFailed);
                this.addEventListener('export-policies-report-failed', this._onExportReportFailed);
                this.addEventListener('export-billing-report-failed', this._onExportReportFailed);

                this.addEventListener('user-session-expired', this._onUserSessionExpired);
                this.addEventListener('add-item-to-group-event', this._onAddItemToGroupAction);
                this.addEventListener('customer-subscription-state-changed', this._onCustomerSubscriptionStateChanged);
                this.addEventListener('notifications-seen', this._onNotificationsSeen);
                this.addEventListener('resource-moved-to-folder', this._onResourceMovedToFolder);
                this.addEventListener('resource-removed-from-folder', this._onResourceRemovedFromFolder);
                this.addEventListener('reload-access-of-boarding', this._onReloadAccessOnBoarding);
                this.addEventListener('groups-added-to-resources', this._onGroupsAddedToResources);
                this.addEventListener('integration-rule-added', this._onIntegrationRuleAdded);
                this.addEventListener('integration-webhook-registered', this._onIntegrationWebhookRegistered);
                //this.addEventListener('page-settings-changed', this._onPageSettingsChange);
            }

            _updateScreen(mobile, tablet) {
                this.updateStyles();
            }

            _onObservableListEmpty() {
                this._hideBulkSelectAll();
            }

            _onObservableListFilled() {
                this._showBulkSelectAll();
            }

            _computePrefixPath (domain) {

                if(window.location.href.includes('localhost')) {
                    return '';
                }

                if (domain.includes('/app.php')) {
                    return '/app.php';
                }

                if (domain.includes('/app_dev.php')) {
                    return '/app_dev.php';
                }

                return '';
            }

            _onCurrentCompanyChanged(company, oldCompany) {

                if (company && company.company) {
                    this._setResourceAdmin(company);
                    this._personalFolderPage = false;

                    setTimeout(function() {
                        if (
                            this.account && this.account.profile_options
                            && (this.account.profile_options.default_company_page === 'resources')
                            && (this.page === 'company-home')
                        ) {
                            this.page = 'resources';
                        }
                    }.bind(this), 100);
                    for (const key in company.company) {
                        this._storeValue('company', company.company.alias);

                        this._setCompanyApi(company);
                        this._setProduct(this._companyPage);

                        if (oldCompany && oldCompany.company
                            && company.company.personal_dashboards_allowed !== oldCompany.company.personal_dashboards_allowed) {
                            this._getLoggedAccount();
                        }
                        return false;
                    }
                }
                else {
                    this._setProduct(false);
                }
            }

            _computeDefaultCompany(account) {
                var defaultCompany = '';

                if (account.default_company) {
                    var defaultCompanyRedirect = {};
                    try {
                        defaultCompanyRedirect = JSON.parse(this._getStoredValue('default_company_redirected'));
                    } catch (Error) {}
                    if (!defaultCompanyRedirect
                        || !defaultCompanyRedirect.accountId
                        || !defaultCompanyRedirect.login_date
                        || defaultCompanyRedirect.login_date != this.account.last_login.date
                        || defaultCompanyRedirect.accountId != this.account.id
                    ) {
                        this._storeValue('default_company_redirected', JSON.stringify({
                            accountId: account.id,
                            login_date: account.last_login.date
                        }));
                        defaultCompany = account.default_company.alias;
                    }
                }

                return defaultCompany;
            }

            _redirectToCompany(page, currentCompany, account) {
                if (account.self && currentCompany.company && page && !this._personalFolderPage) {
                    this._checkPersonalDashboardPermission(page, account);
                    this._redirectToDefaultCompany(page);
                }
            }

            _redirectToDefaultCompany(page) {
                if (this._defaultCompany != '') {
                    this._setProduct(true);

                    if (this._isPersonalPage(page)) {
                        this._showCompanyHomePage();
                    }

                    this.set('account', JSON.parse(JSON.stringify(this.account)));
                }
            }

            _computeCompanyUser(currentCompany) {
                return currentCompany && !currentCompany.company_contact;
            }

            _computeCompanyAdmin(company) {
                return company.company_admin;
            }

            _setResourceAdmin(currentCompany, callback) {
                var request = document.createElement('iron-request'),
                    options = {
                        url: this.api.getUserPrivilegesApi,
                        method: 'POST',
                        handleAs: 'json',
                        headers: this._headers,
                        body: 'company=' + encodeURIComponent(currentCompany.company.self)
                    };

                request.send(options).then(function() {

                    this._resourceAdmin = ((200 == request.status) ?
                        (request.response.scopes['COMPANY_APPLICATION_LIST'] && !this._companyAdmin) :
                        false);
                    if (callback) {
                        callback();
                    }
                }.bind(this));
            }

            _computeCompanyContact(company) {
                return company.company_contact;
            }

            _computeCompaniesAccountHasPermissionTo(account, companiesAccountIsContactIn) {
                var companies = (account.companies && 0 < account.companies.length) ? account.companies : [];
                return (0 < companiesAccountIsContactIn.length) ? companies.concat(companiesAccountIsContactIn) : companies;
            }

            _computeAccessBilling(currentCompany) {
                return currentCompany.company && !currentCompany.company.subscription_paid_externally;
            }

            _computeTutorialsPageVisible(tutorials, _companyAdmin) {

                for (var idx in tutorials) {
                    return (tutorials.hasOwnProperty(idx) && _companyAdmin);
                }

                return false;
            }

            _setProduct(company) {
                var appscoHeader = this.$.appscoHeader;

                company ? appscoHeader.setProduct('appsco-business-product' + this.currentCompany.company.alias) : appscoHeader.setProduct('appsco-product');
            }

            _handlePagePermission(company, page) {

                for (const key in company) {

                    switch (page) {
                        case 'customers':
                            if (!this.currentCompany.company.is_partner) {
                                this._showCompanyHomePage();
                            }

                            break;

                        default:
                            return false;
                    }

                    return false;
                }
            }

            /**
             * Routing START
             */
            _routePageChanged(page) {
                this._brandLogoClickable = !('home' == page || 'company-home' == page);
                this.page = page || 'home';
            }

            _pageChanged(page) {
                this._setProgressBar(page);
                this._closeToastMessage();

                // Load page import on demand. Show 404 page if fails
                var resolvedPageUrl = this.resolveUrl('appsco-' + page + '-page.html');

                Polymer.importHref(resolvedPageUrl, null, this._showPage404, true);

                var currentElement = this.getCurrentAppscoPageElement();
                if(currentElement !== undefined && typeof currentElement.pageSelected === 'function') {
                    currentElement.pageSelected();
                }

                this.$.appDrawer.close();
            }

            _computePageName(page) {

                switch (page) {
                    case 'manage-resource':
                        return 'Manage Resource';

                    case 'manage-account':
                        return 'Manage Account';

                    case 'manage-contact':
                        return 'Manage Contact';

                    case 'manage-customer':
                        return 'Manage Customer';

                    case 'manage-group':
                        return 'Manage Group';

                    case 'manage-integration':
                        return 'Manage Integration';

                    case 'company-home':
                    case 'dashboard-folder':
                        return 'Dashboard';

                    case 'contact-home':
                        return 'Dashboard';

                    case 'access-report':
                        return 'Access report';

                    case 'compliance-report':
                        return 'Compliance report';

                    case 'company':
                        return 'Company Settings';

                    case 'provisioning-settings':
                        return 'Provisioning > Setup';

                    case 'provisioning-integration-authorization-success':
                        return 'Provisioning > Authorization success';

                    case 'provisioning-integration-authorization-failed':
                        return 'Provisioning > Authorization failed';

                    case 'audit-log':
                        return 'Audit Log';

                    case 'access-on-boarding':
                        return 'Access On-boarding';

                    case 'oauth-applications':
                        return 'oAuth';

                    case 'trybusiness':
                        return 'Try Appsco Business';

                    case 'company-account':
                        return 'Account';

                    case 'manage-oauth-application':
                        return 'Manage OAuth Application';

                    case 'customer-billing':
                        return 'Customer Billing';

                    case 'billing-report':
                        return 'Billing Report';

                    case 'saml-authn-request-invalid':
                        return 'Authentication Failed';

                    case 'policies-report':
                        return 'Policies Report';

                    case 'get-started':
                        return 'Get started';

                    case 'additional-options':
                        return 'Additional Options';

                    default:
                        return page;
                }

            }

            _onMenuItemSelected(event) {
                this._showPage(event.detail.item.name);
            }

            _onShowPage(event) {
                this._showPage(event.detail.page);
            }

            _showPage(name) {
                this.set('routeData.page', name);
            }

            _showManagePage(path) {
                this.set('route.path', this._prefixPath + '/' + path);
            }

            _showHomePage() {
                this._showPage('home');
            }

            _showAccountPage() {
                this._showPage('account');
            }

            _showCompanyAccountPage() {
                this._showPage('company-account');
            }

            _showTryBusinessPage() {
                this._showPage('trybusiness');
            }

            _showCompanyHomePage() {
                this._showPage('company-home');
            }

            _backFromFolderPage() {
                if (this._personalFolderPage) {
                    this._showHomePage();
                } else {
                    this._showCompanyHomePage();
                }
            }

            _showCompanyPage() {
                this._showPage('company');
            }

            _showCompanyResourcesPage() {
                this._showPage('resources');
            }

            _showCompanyDirectoryPage() {
                this._showPage('directory');
            }

            _showContactsPage() {
                this._showPage('contacts');
            }

            _showCustomersPage() {
                this._showPage('customers');
            }

            _showGroupsPage() {
                this._showPage('groups');
            }

            _showCompanyProvisioningPage() {
                this._showPage('provisioning');
            }

            _showLogoutPage() {
                this._showPage('logout');
            }

            _showGetStartedPage() {
                this._showPage('get-started');
            }

            _showContactHomePage() {
                this._showPage('contact-home');
            }

            _showReportsPage() {
                this._showPage('reports');
            }

            _showAccessReportPage() {
                this._showPage('access-report');
            }

            _showComplianceReportPage() {
                this._showPage('compliance-report');
            }

            _showPoliciesReportPage() {
                this._showPage('policies-report');
            }

            _showOAuthApplicationsPage() {
                this._showPage('oauth-applications');
            }

            _showAdditionalOptionsPage() {
                this._showPage('additional-options');
            }

            _showPage404() {
                this.page = '404';
                this._pageName = 'Not Found';
            }
            /**
             * Routing END
             */

            /**
             * Ajax START
             */
            _setCompanyApi(company) {
                var companyApi = company.company.self,
                    partnerApi = companyApi.replace('companies', 'partners');

                this._companyApi = companyApi;
                this._companyIconsApi = company.icons;
                this._companyApplicationsApi = companyApi + '/applications';
                this._companyNetscalerFeatureApi = companyApi+'/feature/netscaler/sso/resourcelist';
                this._partnerApi = partnerApi;

                if (company.company_admin) {
                    this._companyRolesApi = companyApi + '/directory/roles';
                    this._companyNotificationsApi = companyApi + '/notification';
                    this._companyInvitationsApi = companyApi + '/invitation';
                    this._companyImportAccountsApi = companyApi + '/directory/roles/import';
                    this._companyContactsApi = companyApi + '/contacts';
                    this._companyOrgunitsApi = companyApi + '/org-units?extended=1';
                    this._companySubscriptionApi = companyApi + '/billing/subscriptions';
                    this._companyDomainsApi = companyApi + '/domains';
                    this._companyGroupsApi = companyApi + '/groups';
                    this._companyGroupApi = companyApi + '/group';
                    this._companySamlMetadataApi = companyApi + '/idp/saml/metadata';
                    this._companyAuditLogApi = companyApi + '/log';
                    this._companyCustomersApi = partnerApi + '/customers';
                    this._companyConvertToCustomerApi = partnerApi + '/customers/convert';
                    this._companyIntegrationApi = companyApi + '/integrations';
                    this._getAccessReportApi = companyApi + '/reports/application-access';
                    this._getComplianceReportApi = companyApi + '/reports/application-compliance';
                    this._getPoliciesReportApi = companyApi + '/reports/policy-breach';
                    this._getTransferTokenApi = companyApi + '/transfer-token';
                    this._sendTransferTokenApi = companyApi + '/send_token';
                    this._saveIPWhiteListApi = companyApi + '/ip-white-list';
                    this._getAvailableIntegrationsApi = companyApi + '/integrations/available';
                    this._getActiveIntegrationsApi = companyApi + '/integrations/active';
                    this._companyOAuthApplicationsApi = companyApi + '/oauth/applications';
                    this._billingReportApi = companyApi + '/reports/billing-report';
                    this._accessOnBoardingUsersApi = companyApi + '/reports/access-on-boarding';
                    this._getCompanyIdpConfigListApi = companyApi + '/settings/idps';
                }

                this._companyFoldersApi = companyApi + '/dashboard-groups';
                this._companyPoliciesApi = companyApi + '/policies';
            }

            _computeCompanyImportResourcesApi(companyApplicationsApi) {
                return companyApplicationsApi ? (companyApplicationsApi + '/import') : null;
            }

            _computeCompanyImportContactsApi(contactsApi) {
                return contactsApi ? (contactsApi + '/import') : null;
            }

            _computeImportCustomersApi(customersApi) {
                return customersApi ? (customersApi + '/import') : null;
            }

            _computeCheckIfCustomerExistsApi(partnerApi) {
                return partnerApi ? (partnerApi + '/customer/exists') : null;
            }

            _computeCustomerResourcesImportApi(customersApi) {
                return customersApi ? customersApi + '/import-resources' : null;
            }

            _computeCompanyExportCustomersApi(customersApi) {
                return customersApi ? customersApi + '/export' : null;
            }

            _computeCompanyIntegrationsApi(companyApi) {
                return companyApi ? companyApi + '/integration' : null;
            }

            _computeAddPartnerAdminToCustomerApi(customersApi) {
                return customersApi ? (customersApi + '/partner-admins') : null;
            }

            _computeExportAccessReportApi(getAccessReportApi) {
                return getAccessReportApi ? (getAccessReportApi + '/export') : null;
            }

            _computeExportComplianceReportApi(getComplianceReportApi) {
                return getComplianceReportApi ? (getComplianceReportApi + '/export') : null;
            }

            _computeExportPoliciesReportApi(getPoliciesReportApi) {
                return getPoliciesReportApi ? (getPoliciesReportApi + '/export') : null;
            }

            _computeExportBillingReportApi(billingReportApi) {
                return billingReportApi ? (billingReportApi + '/export') : null;
            }

            _computeExportAccessAccessOnBoardingApi(accessOnBoardingUsersApi) {
                return accessOnBoardingUsersApi ? (accessOnBoardingUsersApi + '/export') : null;
            }

            _computeCompanyIconsWithoutFolderApi(companyFoldersApi) {
                return companyFoldersApi ? (companyFoldersApi + '/icons') : null;
            }

            _getLoggedAccount() {
                this.shadowRoot.getElementById('getAccountRequest').generateRequest();
            }

            _onGetAccountResponse(event) {
                var account = event.detail.response.account;

                this.set('account', {});
                this.set('account', account);
                this.shadowRoot.getElementById('getDashboardsLink').generateRequest();
                this.shadowRoot.getElementById('getCompaniesAccountIsContactIn').generateRequest();
                setTimeout(function() {
                    this._getCurrentCompanyFromAccount();
                }.bind(this), 400);
            }

            _onGetPageConfig(event) {
                var pageConfig = event.detail.response,
                    _pageConfig = JSON.parse(JSON.stringify(this._pageConfig));

                for (var key in pageConfig) {
                    _pageConfig[key] = pageConfig[key];

                }

                this.set('_pageConfig', {});
                this.set('_pageConfig', _pageConfig);
            }

            _getCurrentCompanyFromAccount() {
                if (this._companiesAccountHasPermissionTo.length > 0) {
                    var companies = this._companiesAccountHasPermissionTo,
                        length = companies.length,
                        currentCompany = companies[0],
                        companyAlias = this._getStoredValue('company');

                    if (!this._getCurrentCompanyFromAccount.personal_dashboard_allowed && this.account.native_company) {
                        var lastNativeRedirect = {};
                        try {
                            lastNativeRedirect = JSON.parse(this._getStoredValue('native_redirected'));
                        } catch (Error) {}
                        if (!lastNativeRedirect
                            || !lastNativeRedirect.accountId
                            || !lastNativeRedirect.login_date
                            || lastNativeRedirect.login_date != this.account.last_login.date
                            || lastNativeRedirect.accountId != this.account.id
                        ) {
                            this._storeValue('native_redirected', JSON.stringify({
                                accountId: this.account.id,
                                login_date: this.account.last_login.date
                            }));
                            companyAlias = this.account.native_company.alias;
                        }
                    }

                    if (this.account.default_company && this._defaultCompany) {
                        companyAlias = this._defaultCompany;
                    }

                    if (companyAlias && companyAlias.toString().length > 0) {

                        for (var i = 0; i < length; i++) {
                            if (companies[i].company.alias == companyAlias) {
                                currentCompany = companies[i];
                            }
                        }
                    }

                    this.currentCompany = currentCompany;
                }
            }

            _computeContactIconsApi(domain, currentCompany) {
                if (currentCompany.company && currentCompany.company_contact) {
                    return domain + '/api/v2/me/contact/companies/' + currentCompany.company.alias + '/apps';
                }

                return null;
            }

            /**
             * Checks is user allowed to see personal dashboard pages
             *
             * @param {String} page
             * @param {Object} account
             *
             * @private
             */
            _checkPersonalDashboardPermission(page, account) {
                if (!this.isPersonalDashboardAllowed(account)) {
                    this._disablePersonalDashboard(page);
                } else {
                    this._enablePersonalDashboard(page);
                }
            }

            /**
             * Remove personal from product list, and redirect user to company page if needed
             *
             * @param {String} page
             *
             * @private
             */
            _disablePersonalDashboard(page) {
                this.$.appscoHeader.removeProduct('appsco-product');
                this._setProduct(true);

                if (this._isPersonalPage(page)) {
                    this._showCompanyHomePage();
                }
            }

            /**
             * Returns Personal to product list
             *
             * @private
             */
            _enablePersonalDashboard(page) {
                this.$.appscoHeader.addPersonalToProducts();
                this._setProduct(!this._isPersonalPage(page));
            }

            /**
             * Returns true if page is on personal dashboard
             *
             * @param {String} page
             * @returns {Boolean}
             *
             * @private
             */
            _isPersonalPage(page) {
                var personalPages = ['home', 'resource', 'trybusiness', 'account'];
                return personalPages.indexOf(page) != -1;
            }

            isPersonalDashboardAllowed(account) {
                return account && account.native_company
                    ? account.native_company.personal_dashboards_allowed
                    : true;
            }

            _onGetAccountError() {
//                this._showPage404();
            }

            _onGetCompaniesAccountIsContactInApiResponse(event) {
                var response = event.detail.response;

                if (response.companies && 0 < response.companies.length) {
                    this.set('_companiesAccountIsContactIn', response.companies.map(function(company) {
                        return {
                            company: company,
                            company_contact: true
                        };
                    }));
                }
            }

            _onGetIsUserLoggedInResponse() {
                this._getIsUserLoggedIn();
            }

            _onCheckNewNotificationsResponse(event, response) {
                var newNotifications = event.detail.response;
                if (0 < newNotifications) {
                    this._notifyNewNotifications(newNotifications);
                } else {
                    this._notifyNotificationsSeen();
                }
                this._checkNewNotifications();
            }

            _checkNewNotifications() {
                setTimeout(function() {
                    this.shadowRoot.getElementById('checkNewNotifications').generateRequest();
                }.bind(this), 30000);
            }

            _notifyNewNotifications (newNotifications) {
                this.$.appscoHeader.notifyNewNotifications(newNotifications);
            }

            _notifyNotificationsSeen () {
                this.$.appscoHeader.notifyNotificationsSeen();
            }

            _onNotificationsSeen () {
                this._notifyNotificationsSeen();
                this.shadowRoot.getElementById('notificationsSeen').generateRequest();
            }

            _setGetApplicationsApi() {
                this._applicationsApi = this.api.foldersApi + '/icons';
            }

            _createDefaultDashboard() {
                var request = document.createElement('iron-request'),
                    options = {
                        url: this.api.dashboards,
                        method: 'POST',
                        handleAs: 'json',
                        headers: this._headers,
                        body: 'dashboard[title]=' + encodeURIComponent(this.account.name)
                    };

                request.send(options).then(function() {

                    if (200 == request.status) {
                        this._addAppApi = request.response.dashboard.self;
                        this._setGetApplicationsApi();
                    }

                }.bind(this));
            }

            _onDashboardsResponse(event) {
                var response = event.detail.response;

                if (response && response.meta.total > 0) {
                    var dashboards = response.dashboards,
                        length = dashboards.length,
                        hasDashboard = false;

                    dashboardsLoop:
                        for (var i = 0; i < length; i++) {
                            var dashboardRoles = dashboards[i].roles,
                                rolesLength = dashboardRoles.length;

                            for (var j = 0; j < rolesLength; j++) {
                                if ('owner' === dashboardRoles[j].toLowerCase()) {
                                    this._addAppApi = dashboards[i].self;
                                    this._setGetApplicationsApi();
                                    hasDashboard = true;
                                    break dashboardsLoop;
                                }
                            }

                        }

                    if (!hasDashboard) {
                        this._createDefaultDashboard();
                    }
                }
                else {
                    this._createDefaultDashboard();
                }
            }

            _onSubscriptionLoaded(event) {
                var subscription = event.detail.subscription;
                this._subscription = subscription;
                this._setSubscription(subscription);
                this._evaluateSubscriptionLicences();
            }

            _onDirectoryPageLoaded(event) {
                this._directoryPageLoaded = true;
            }

            _onResourcesPageLoaded(event) {
                this._resourcesPageLoaded = true;
            }

            _computeAccountManagedState(account) {
                return !!account.native_company;
            }

            _computeAccountCanCreateCompany(account) {
                if(account.native_company) {
                    return account.native_company.user_allowed_to_create_company;
                }
                return true;
            }

            _getIsUserLoggedIn() {
                setTimeout(function() {
                    this.shadowRoot.getElementById('getIsUserLoggedIn').generateRequest();
                }.bind(this), 30000);
            }

            _redirectUserToLoginPage() {
                window.location.href = this.api.loginURL;
            }

            _showUserSessionExpiredInfo() {
                var appscoCompanyNoticeComponent = this.shadowRoot.getElementById('appscoCompanyNotice');

                appscoCompanyNoticeComponent.setNotice('Your session has expired. You will be redirected in order to login again.');
                appscoCompanyNoticeComponent.setNoticeEvent('user-session-expired');
                appscoCompanyNoticeComponent.open();
            }

            _onUserSessionExpired() {
                this._redirectUserToLoginPage();
            }

            _onIsUserLoggedInError() {
                this._showUserSessionExpiredInfo();
            }
            /**
             * Ajax END
             */

            /**
             * Appsco header actions START
             */
            _onBrandAction() {
                this._companyPage ? this._showCompanyHomePage() : this._showHomePage();
            }

            _onAppscoProductChangeAction(event) {
                var panel = event.detail.product,
                    company = event.detail.company;

                if ('appsco-product' === panel && 'home' !== this.page) {
                    this._showHomePage();
                }

                if ('appsco-business-product' === panel) {
                    this.currentCompany = company;

                    company.company_contact ? this._showContactHomePage() : this._showCompanyHomePage();
                }

            }

            _onAccountSettingsAction() {
                this._setProduct(this._accountManaged);

                this._accountManaged ? this._showCompanyAccountPage() : this._showAccountPage();
            }

            _onAllNotifications() {
                this._setProduct(this._accountManaged);

                if (this._accountManaged) {
                    this.$.appscoCompanyAccountPage.showAllNotifications = true;
                    this._showCompanyAccountPage();
                }
                else {
                    this.$.appscoAccountPage.showAllNotifications = true;
                    this._showAccountPage();
                }
            }

            _onAccountLogout() {
                this._showLogoutPage();
            }

            _onGetStarted() {
                this._showGetStartedPage();
            }

            /**
             * Appsco header actions END
             */

            /**
             * Home page START
             */
            _onLoadedPage(event) {
                var page = event.currentTarget;

                if (page.$ && ('home' === this.page || 'company-home' === this.page || 'resources' === this.page || 'contact-home' === this.page)) {
                    page.initializePage();
                }
            }

            getCurrentAppscoPageElement() {
                switch (this.page) {
                    case 'home':
                        return this.$.appscoHomePage;
                        break;

                    case 'company-home':
                        return this.$.appscoCompanyHomePage;
                        break;

                    case 'resources':
                        return this.$.appscoResourcesPage;
                        break;

                    case 'manage-integration':
                        return this.$.appscoManageIntegrationPage;
                        break;

                    case 'directory':
                        return this.$.appscoDirectoryPage;
                        break;

                    case 'company':
                        return this.$.appscoCompanyPage;
                        break;

                    case 'contacts':
                        return this.$.appscoContactsPage;
                        break;

                    case 'groups':
                        return this.$.appscoGroupsPage;
                        break;

                    case 'account':
                        return this.$.appscoAccountPage;
                        break;

                    case 'company-account':
                        return this.$.appscoCompanyAccountPage;
                        break;

                    case 'contact-home':
                        return this.$.appscoContactHomePage;
                        break;

                    case 'customers':
                        return this.$.appscoCustomersPage;
                        break;

                    case 'oauth-applications':
                        return this.$.appscoOAuthApplicationsPage;
                        break;

                    case 'reports':
                        return this.$.appscoReportsPage;
                        break;

                    case 'access-report':
                        return this.$.appscoAccessReportPage;
                        break;

                    case 'compliance-report':
                        return this.$.appscoComplianceReportPage;
                        break;

                    case 'manage-oauth-application':
                        return this.$.appscoManageOAuthApplicationPage;
                        break;

                    case 'audit-log':
                        return this.$.appscoAuditLogPage;
                        break;

                    case 'access-on-boarding':
                        return this.$.appscoAccessOnBoardingPage;
                        break;

                    case 'dashboard-folder':
                        return this.$.appscoDashboardFolderPage;
                        break;

                    case 'billing':
                        return this.$.appscoBillingPage;
                        break;

                    case 'customer-billing':
                        return this.$.appscoCustomerBillingPage;
                        break;

                    case 'billing-report':
                        return this.$.appscoBillingReportPage;
                        break;

                    case 'policies':
                        return this.$.appscoPoliciesPage;
                        break;

                    case 'policies-report':
                        return this.$.appscoPoliciesReportPage;
                        break;

                    case 'get-started':
                        return this.$.appscoGetStartedPage;
                        break;

                    case 'additional-options':
                        return this.$.appscoAdditionalOptionsPage;
                        break;
                }
            }

            getCurrentAppscoPageActionsElement() {
                switch (this.page) {
                    case 'home':
                        return this.shadowRoot.getElementById('appscoHomePageActions');
                        break;

                    case 'resources':
                        return this.shadowRoot.getElementById('appscoResourcesPageActions');
                        break;

                    case 'directory':
                        return this.shadowRoot.getElementById('appscoDirectoryPageActions');
                        break;

                    case 'contacts':
                        return this.shadowRoot.getElementById('appscoContactsPageActions');
                        break;

                    case 'groups':
                        return this.shadowRoot.getElementById('appscoGroupsPageActions');
                        break;

                    case 'account':
                        return this.shadowRoot.getElementById('appscoAccountPageActions');
                        break;

                    case 'company-account':
                        return this.shadowRoot.getElementById('appscoCompanyAccountPageActions');
                        break;

                    case 'customers':
                        return this.shadowRoot.getElementById('appscoCustomersPageActions');
                        break;

                    case 'provisioning':
                        return this.shadowRoot.getElementById('appscoProvisioningPageActions');
                        break;

                    case 'oauth-applications':
                        return this.shadowRoot.getElementById('appscoOAuthApplicationsPageActions');
                        break;

                    case 'manage-oauth-application':
                        return this.shadowRoot.getElementById('appscoManageOAuthApplicationPageActions');
                        break;

                    case 'dashboard-folder':
                        return this.shadowRoot.getElementById('appscoDashboardFolderPageActions');
                        break;

                    case 'policies':
                        return this.shadowRoot.getElementById('appscoPoliciesPageActions');
                        break;

                    case 'policies-report':
                        return this.shadowRoot.getElementById('appscoPolicyReportPageActions');
                        break;

                    case 'company-home':
                        return this.shadowRoot.getElementById('appscoCompanyHomePageActions');
                        break;
                }

            }

            _onInfoAction() {
                this.getCurrentAppscoPageElement().toggleInfo();
            }

            _onFiltersAction() {
                this.getCurrentAppscoPageElement().toggleResource();
            }

            _onToggleAdditionalOptionsAction() {
                this.getCurrentAppscoPageElement().toggleAdditionalOptions();
            }

            _onShowBulkActions() {
                this.getCurrentAppscoPageActionsElement().showBulkActions();
            }

            _onHideResourcesBulkActions() {
                this.shadowRoot.getElementById('appscoResourcesPageActions').hideBulkActions();
            }

            _onHideContactBulkActions() {
                this.shadowRoot.getElementById('appscoContactsPageActions').hideBulkActions();
            }

            _onHideDirectoryBulkActions() {
                this.shadowRoot.getElementById('appscoDirectoryPageActions').hideBulkActions();
            }

            _showBulkSelectAll() {
                var element = this.getCurrentAppscoPageActionsElement();
                if (element && typeof element.showBulkSelectAll === 'function') {
                    element.showBulkSelectAll();
                }
            }

            _hideBulkSelectAll() {
                let element = this.getCurrentAppscoPageActionsElement();
                if (element && typeof element.hideBulkSelectAll === 'function') {
                    element.hideBulkSelectAll();
                }
            }

            _onSearchApplications(event) {
                this._showProgressBar();
                this.getCurrentAppscoPageElement().filterApplicationsByTerm(event.detail.term);
            }

            _onSearchApplicationsClear() {
                this.getCurrentAppscoPageElement().filterApplicationsByTerm('');
            }

            _onFilterItemsAction(event) {
                var id = parseInt(event.detail.id);

                if (id !== this._selectedApplicationsGroup) {
                    var getResourcesApi = null;

                    this._selectedApplicationsGroup = id;
                    this._showProgressBar();

                    switch (id) {
                        case 0:
                            getResourcesApi = this.api.icons;
                            break;

                        case 1:
                            getResourcesApi = this.api.personalItems;
                            break;

                        case 2:
                            getResourcesApi = this.api.sharedWithMeItems;
                            break;

                        default:
                            getResourcesApi = this._applicationsApi;
                    }

                    this.$.appscoHomePage.filterApplicationsByStatus(getResourcesApi);
                }

            }

            _onAddItemAction(event) {
                var action = event.detail.action,
                    applicationTemplate = event.detail.applicationTemplate;

                switch (action) {
                    case 'catalogue-application':
                        this.shadowRoot.getElementById('appscoApplicationAdd').toggle();
                        break;
                    default:
                        var request = document.createElement('iron-request'),
                            options = {
                                url: this.domain + applicationTemplate,
                                method: 'GET',
                                handleAs: 'json',
                                headers: this._headers
                            };

                        request.send(options).then(function() {

                            if (200 == request.status) {
                                this.shadowRoot.getElementById('appscoApplicationAdd').setApplicationTemplate(request.response.application);
                                this.shadowRoot.getElementById('appscoApplicationAdd').toggle();
                            }

                        }.bind(this));
                        break;
                }
            }

            _onApplicationAdded(event) {
                var application = event.detail.application,
                    applications = [application],
                    message = application.title + ' was successfully saved.';

                this.application = application;
                this.$.appscoHomePage.addApplications(applications);
                this._notify(message);
            }

            _editApplication(application) {
                this.set('application', application);
                this._showManagePage('resource/' + application.alias);
            }

            _onEditApplication(event) {
                this._editApplication(event.detail.application);
            }

            _onInfoEditApplication(event) {
                this._editApplication(event.detail.application);
            }

            _onEditSharedApplication(event) {
                this.shadowRoot.getElementById('appscoCompanyResourceSettingsDialog').setApplication(event.detail.application);
                this.shadowRoot.getElementById('appscoCompanyResourceSettingsDialog').toggle();
            }

            _onEditApplicationCredentials(event) {
                this.shadowRoot.getElementById('appscoApplicationSettingsDialog').setApplication(event.detail.application);
                this.shadowRoot.getElementById('appscoApplicationSettingsDialog').toggle();
            }

            _onResourcesLoadForbidden(event) {
                if (this.currentCompany) {
                    this.page = 'company-home';
                }
            }

            _onEditAdditionalOptionsAction() {
                this._showAdditionalOptionsPage();
            }

            _reloadHomePageApplications() {

                if (this.$.appscoHomePage.$) {
                    this.$.appscoHomePage.reloadApplications();
                }
            }
            /**
             * Home page END
             */

            /**
             * Resource page START
             */
            _onApplicationUpdated(event) {
                var application = event.detail.application;

                switch (this.page) {
                    case 'home':
                    case 'resource':
                        this.set('application', {});
                        this.set('application', application);

                        if (this.$.appscoHomePage.$) {
                            this.$.appscoHomePage.setApplication(application);
                        }

                        if (this.$.appscoDashboardFolderPage.$) {
                            this.$.appscoDashboardFolderPage.setApplication(application);
                        }

                        break;

                    case 'company-home':
                        this.set('_companyApplication', {});
                        this.set('_companyApplication', application);

                        if (this.$.appscoCompanyHomePage.$) {
                            this.$.appscoCompanyHomePage.setApplication(application);
                        }

                        if (this.$.appscoDashboardFolderPage.$) {
                            this.$.appscoDashboardFolderPage.setApplication(application);
                        }

                        this._reloadCompanyApplications();

                        break;

                    case 'contact-home':
                        this.set('_companyApplication', {});
                        this.set('_companyApplication', application);

                        if (this.$.appscoContactHomePage.$) {
                            this.$.appscoContactHomePage.setApplication(application);
                        }

                        this._reloadCompanyApplications();

                        break;

                    case 'manage-resource':
                        this.set('_companyApplication', {});
                        this.set('_companyApplication', application);

                        this._reloadCompanyHomePageApplications();
                        this._reloadCompanyApplications();

                        break;
                }
            }

            _onBackFromResourcePageAction() {

                if (this._activeFolder.alias) {
                    this._openFolder(this._activeFolder);
                } else {
                    this._showHomePage();
                    this.set('_activeFolder', {});
                }
            }

            _onResourceActionApplicationPage() {
                this.$.appscoApplicationPage.toggleResource();
            }

            _onEnableSubscribersSearchAction() {
                this.shadowRoot.getElementById('appscoApplicationPageActions').enableSubscribersSearchAction();
            }

            _onDisableSubscribersSearchAction() {
                this.shadowRoot.getElementById('appscoApplicationPageActions').disableSubscribersSearchAction();
            }

            _searchSubscribers(term) {
                this._showProgressBar();
                this.$.appscoApplicationPage.searchSubscribers(term);
            }

            _onSearchSubscribers(event) {
                this._searchSubscribers(event.detail.term);
            }

            _onSearchSubscribersClear() {
                this._searchSubscribers('');
            }

            _onShareApplication(event) {
                this.set('application', event.detail.application);
                this.shadowRoot.getElementById('appscoApplicationShare').toggle();
            }

            _onApplicationShared(event) {
                var application = event.detail.application,
                    succeded = event.detail.succeded,
                    failed = event.detail.failed,
                    applicationLogApi = application.meta.log,
                    message = '';

                if (parseInt(succeded) != 0) {
                    message = 'Application ' + this.application.title + ' was successfully shared to ' + succeded + ' accounts.';
                }

                if (parseInt(failed) != 0) {
                    message = (0 != message.length) ?
                        message + ' It was already shared to ' + failed + ' selected accounts. ' :
                        'Application ' + this.application.title + ' was already shared to ' + failed + ' selected accounts.';
                }

                // In order to notify.
                this.set('application', {});
                this.set('application', application);

                if ('dashboard-folder' === this.page) {
                    this.getCurrentAppscoPageElement().setApplicationTemplate(application);
                }

                this._notifyAboutApplicationLogChange(applicationLogApi);
                this._notify(message, true);
            }

            _onApplicationCredentialsChanged(event) {
                var application = event.detail.application,
                    message = 'You successfully changed ' + application.title + ' credentials.';

                this._notify(message);
            }


            _onRemoveApplication() {
                this.shadowRoot.getElementById('appscoApplicationRemove').open();
            }

            _onApplicationRemoved(event) {
                var application = event.detail.application,
                    applications = [application],
                    message = application.title + ' was successfully removed.';

                if (this.$.appscoHomePage.$) {
                    this.$.appscoHomePage.removeApplications(applications);
                } else {
                    this._showHomePage();
                }

                this._notify(message);

                this._notifyAccountLog();
            }

            _onApplicationSettingsSaved(event) {
                var application = event.detail.application,
                    applicationLogApi = application.meta.log,
                    message = application.title + ' was successfully changed.';

                if (this.$.appscoHomePage.$) {
                    this.$.appscoHomePage.reloadApplications();
                }
                if (this.$.appscoCompanyHomePage.$) {
                    this.$.appscoCompanyHomePage.reloadApplications();
                }
                if (this.$.appscoContactHomePage.$) {
                    this.$.appscoContactHomePage.reloadApplications();
                }
                if (this.$.appscoDashboardFolderPage.$) {
                    this.$.appscoDashboardFolderPage.reloadApplications();
                }
                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.modifyResources([application]);
                }

                this._notifyAboutApplicationLogChange(applicationLogApi);
                this._notify(message);
            }

            _onApplicationSettingsNoChanges(event) {
                this._notify('No changes have been made to ' + event.detail.application.title + '.');
            }

            _onAutologinChanged() {
                this._notifyReloadApplications();
            }

            _onReloadApplications() {

                switch (this.page) {
                    case 'resource':
                        this._reloadHomePageApplications();

                        break;

                    case 'resources':
                        this._reloadHomePageApplications();
                        this._reloadCompanyHomePageApplications();
                        this._reloadContactHomePageApplications();

                        break;

                    case 'manage-resource':
                        this._reloadCompanyApplications();
                        this._reloadCompanyHomePageApplications();
                        this._reloadContactHomePageApplications();

                        break;
                }

            }

            /**
             * Notifies application log api change.
             * Used to notify appsco-application-log to load log again.
             *
             * @param String applicationLogApi
             * @private
             */
            _notifyAboutApplicationLogChange(applicationLogApi) {
                this.set('application.meta.log', null);
                this.set('application.meta.log', applicationLogApi);
            }

            _onSubscriptionRevoke(event) {
                var dialog = this.shadowRoot.getElementById('appscoApplicationSubscriberRevoke');
                dialog.application =   event.detail.application;
                dialog.revokeAccount = event.detail.account;

                dialog.open();
            }

            _onRevokeApplication(event) {
                var dialog = this.shadowRoot.getElementById('appscoApplicationRevoke');
                dialog.applicationInstance = event.detail.application;
                dialog.open();
            }

            _onSelfSubscriptionRevoked(event) {
                this.$.appscoHomePage.removeApplications([event.detail.application]);
                this.$.appscoHomePage.setDefaultApplication();
                this._notify('You have successfully revoked access to ' + event.detail.application.title + '.');
            }

            _onAccountSubscriptionRevoked(event) {
                this.set('application', {});
                this.set('application', event.detail.application);
                this._notify('You have successfully revoked access to ' + event.detail.application.title + ' for ' + event.detail.account.name);
            }

            _onSubscriptionRevoked(event) {

                switch (this.page) {
                    case 'home':
                        this._onSelfSubscriptionRevoked(event);
                        break;

                    case 'resource':
                        this._onAccountSubscriptionRevoked(event);
                        break;
                }

            }

            _onApplicationInstanceRevoked(event) {

                if (this.$.appscoHomePage.$ && this.page == 'home') {
                    this.$.appscoHomePage.removeApplications([event.detail.applicationInstance]);
                    this.$.appscoHomePage.setDefaultApplication();
                }

                if (this.$.appscoCompanyHomePage.$ && this.page == 'company-home') {
                    this.$.appscoCompanyHomePage.removeApplications([event.detail.applicationInstance]);
                    this.$.appscoCompanyHomePage.setDefaultApplication();
                }

                if (this.$.appscoDashboardFolderPage.$ && this.page == 'dashboard-folder') {
                    this.$.appscoDashboardFolderPage.removeApplications([event.detail.applicationInstance]);
                    this.$.appscoDashboardFolderPage.setDefaultApplication();
                }

                if (this.$.appscoContactHomePage.$ && this.page == 'contact-home') {
                    this.$.appscoContactHomePage.removeApplications([event.detail.applicationInstance]);
                    this.$.appscoContactHomePage.setDefaultApplication();
                }

                this._notify('You have successfully revoked access to ' + event.detail.applicationInstance.application.title + '.');

            }

            _onApplicationsRemovedFromHomePage() {
                this._showHomePage();

                this._notifyReloadApplications();
            }

            /**
             * Resource page END
             */

            /**
             * Account page START
             */
            _onResourceActionPage() {
                this.getCurrentAppscoPageElement().toggleResource();
            }

            _onAccountAdvancedSettings() {
                this.getCurrentAppscoPageElement()._onAccountAdvancedSettings();
            }

            _showAdvancedManageAccountPageOptions(event) {
                if (this.$.appscoManageAccountPage) {
                    if (event.detail.showAdvanced) {
                        this.$.appscoManageAccountPage.showAdvanced();
                        return;
                    }

                    this.$.appscoManageAccountPage.hideAdvanced();
                }
            }

            _showAdvancedManageResourcePageOptions(event) {
                if (this.$.appscoManageApplicationPage) {
                    if (event.detail.showAdvanced) {
                        this.$.appscoManageApplicationPage.showAdvanced();
                        return;
                    }

                    this.$.appscoManageApplicationPage.hideAdvanced();
                }
            }

            _updateIfAdministrator(account) {

                if (this.$.appscoDirectoryPage.$ && (account.id === this.account.id)) {
                    this.$.appscoDirectoryPage.updateAccount(account);
                }
            }

            _onAccountSettingsSaved(event) {
                var account = event.detail.account;

                switch (this.page) {
                    case 'manage-account':
                        this._notify('Account settings for ' + account.name + ' were successfully changed.');

                        break;

                    case 'account':
                    case 'company-account':
                        this._updateIfAdministrator(account);
                        this._notify('Account settings were successfully changed.');

                        break;
                }

                this._notifyReloadAccounts();
            }

            _onAccountPasswordChanged() {
                this._notify('Account password was successfully changed.');

                this._notifyReloadAccounts();
            }

            _onRevokeAuthorizedApplication(event) {
                this._authorizedApplication = event.detail.application;
                this.shadowRoot.getElementById('appscoAccountAuthorizedAppRevoke').open();
            }

            _onAuthorizedApplicationRevoked(event) {
                var application = event.detail.application;

                this._authorizedApplication = {};
                this._notify(application.title + ' was successfully revoked.');
                this.getCurrentAppscoPageElement().reloadAuthorizedApplications();

                this._notifyAccountLog();
                this._notifyReloadAccounts();
            }

            _onEnableAccountAdvancedSettings() {
                var pageActions = this.getCurrentAppscoPageActionsElement();

                if (pageActions && pageActions.enableAdvancedSettings) {
                    pageActions.enableAdvancedSettings();
                }
            }

            _onDisableAccountAdvancedSettings() {
                var pageActions = this.getCurrentAppscoPageActionsElement();

                if (pageActions) {
                    pageActions.disableAdvancedSettings();
                }
            }

            _onTwoFaEnabled() {
                this._notify("Two-factor authentication enabled.");

                this._notifyReloadAccounts();
            }

            _onDisableTwoFaAction() {
                this.shadowRoot.getElementById('appscoAccountDisableTwoFa').open();
            }

            _setupAfterTwoFaDisabled() {

                if (this.$.appscoAccountPage.$) {
                    this.$.appscoAccountPage.setupAfterTwoFaDisabled();
                }

                if (this.$.appscoCompanyAccountPage.$) {
                    this.$.appscoCompanyAccountPage.setupAfterTwoFaDisabled();
                }
            }

            _onTwoFaDisabled() {
                this._notifyReloadAccounts();
                this._setupAfterTwoFaDisabled();
                this._notify('Two-factor authentication disabled successfully.');
            }

            _onReloadAccountLog() {
                if (this.$.appscoAccountPage.$) {
                    this.$.appscoAccountPage.reloadLog();
                }

                if (this.$.appscoCompanyAccountPage.$) {
                    this.$.appscoCompanyAccountPage.reloadLog();
                }
            }

            _onTokenGenerated() {
                this._notify('Transfer token was successfully generated.');
            }
            /**
             * Account page END
             */

            /**
             * Upgrade page START
             */
            _onUpgradeTogglePricing() {
                this.$.appscoUpgradePage.togglePricing();
            }
            /**
             * Upgrade page END
             */

            /**
             * Resources page START
             */
            _filterCompanyApplicationsByTerm(term) {
                this._showProgressBar();
                this.$.appscoResourcesPage.filterResourcesByTerm(term);
            }

            _onSearchCompanyApplications(event) {
                this._filterCompanyApplicationsByTerm(event.detail.term);
            }

            _onSearchCompanyApplicationsClear() {
                this._filterCompanyApplicationsByTerm('');
            }

            _onResourceActionManageApplicationPage() {
                this.$.appscoManageApplicationPage.toggleResource();
            }

            _searchAssignees(term) {
                this._showProgressBar();
                this.$.appscoManageApplicationPage.searchAssignees(term);
            }

            _onSearchAssignees(event) {
                this._searchAssignees(event.detail.term);
            }

            _onSearchAssigneesClear() {
                this._searchAssignees('');
            }

            _editCompanyResource(resource) {
                this.set('_companyApplication', resource);
                this._showManagePage('manage-resource/' + resource.alias);
            }

            _onEditCompanyResource(event) {
                this._editCompanyResource(event.detail.resource);
            }

            _onInfoEditCompanyResource(event) {
                this._editCompanyResource(event.detail.resource);
            }

            _refreshOrgunits(data) {
                var applicationsPage = this.$.appscoResourcesPage.$ ? this.$.appscoResourcesPage : null,
                    directoryPage = this.$.appscoDirectoryPage.$ ? this.$.appscoDirectoryPage : null;

                switch (data.event) {
                    case 'orgunit-added':

                        if (null != directoryPage) {
                            directoryPage.addOrgunit(data.orgunit);
                        }

                        break;

                    case 'orgunit-modified':


                        if (null != directoryPage) {
                            directoryPage.modifyOrgunit(data.orgunit);
                        }

                        break;

                    case 'orgunit-removed':

                        if (null != directoryPage) {
                            directoryPage.removeOrgunit(data.orgunit);
                        }

                        break;
                }

            }

            _onAddOrgunit(event) {
                var orgunitAddDialog = this.shadowRoot.getElementById('appscoOrgunitModify');

                orgunitAddDialog.parent = event.detail.orgUnit;
                orgunitAddDialog.orgUnit = {};
                orgunitAddDialog.open();
            }

            _onOrgunitAdded(event) {
                var orgunit = event.detail.orgUnit;

                this._refreshOrgunits({
                    page: this.page,
                    event: event.type,
                    orgunit: orgunit
                });

                this._notify('Organization unit ' + orgunit.name + ' successfully added.');

                this._notifyAccountLog();
            }

            _onModifyOrgunit(event) {
                var orgunitModifyDialog = this.shadowRoot.getElementById('appscoOrgunitModify');

                orgunitModifyDialog.parent = {};
                orgunitModifyDialog.orgUnit = event.detail.orgUnit;
                orgunitModifyDialog.open();
            }

            _onOrgunitModified(event) {
                var orgunit = event.detail.orgUnit;

                this._refreshOrgunits({
                    page: this.page,
                    event: event.type,
                    orgunit: orgunit
                });

                this._notify('Organization unit ' + orgunit.name + ' successfully modified.');

                this._notifyAccountLog();
            }

            _onRemoveOrgunit(event) {
                var orgunitRemoveDialog = this.shadowRoot.getElementById('appscoOrgunitRemove');

                orgunitRemoveDialog.orgUnit = event.detail.orgUnit;
                orgunitRemoveDialog.open();
            }

            _onOrgunitRemoved(event) {
                var orgunit = event.detail.orgUnit;

                this._refreshOrgunits({
                    page: this.page,
                    event: event.type,
                    orgunit: orgunit
                });

                this._notify('Organization unit ' + orgunit.name + ' successfully removed.');

                this._notifyAccountLog();
            }

            _onAddCompanyItemAction(event) {
                var action = event.detail.action,
                    applicationTemplate = event.detail.applicationTemplate;

                switch (action) {
                    case 'sso-application':
                        this.shadowRoot.getElementById('appscoCompanySSOApplicationsAdd').setAction(action);
                        this.shadowRoot.getElementById('appscoCompanySSOApplicationsAdd').toggle();
                        break;
                    case 'catalogue-application':
                        this.shadowRoot.getElementById('appscoCompanyApplicationsAdd').setAction(action);
                        this.shadowRoot.getElementById('appscoCompanyApplicationsAdd').toggle();
                        break;
                    default:
                        var request = document.createElement('iron-request'),
                            options = {
                                url: this.domain + applicationTemplate,
                                method: 'GET',
                                handleAs: 'json',
                                headers: this._headers
                            };

                        request.send(options).then(function() {

                            if (200 == request.status) {
                                this.shadowRoot.getElementById('appscoDialogApplicationCompanyAdd').setApplicationTemplate(request.response.application);
                                this.shadowRoot.getElementById('appscoDialogApplicationCompanyAdd').setAction(action);
                                this.shadowRoot.getElementById('appscoDialogApplicationCompanyAdd').toggle();
                            }

                        }.bind(this));
                        break;
                }
            }

            _onCompanyApplicationAdded(event) {
                var application = event.detail.application,
                    message = application.title + ' was successfully saved.';
                if ('none' == application.auth_type) {
                    this.$.appscoResourcesPage.addResources([application]);
                }
                this._notify(message);
            }

            _onCompanyApplicationClaimsUpdated (event) {
                var application = event.detail.application,
                    applications = [application];
                this.$.appscoResourcesPage.addResources(applications);
            }

            _onImportResourcesAction() {
                this.shadowRoot.getElementById('appscoImportResources').toggle();
            }

            _onImportPersonalResourcesAction() {
                this.shadowRoot.getElementById('appscoImportPersonalResources').toggle();
            }

            _onImportCompanyResourcesFinished(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfCustomApplications + response.numberOfSecureNotes + ' resources imported out of '
                    + response.total + ', '
                    + response.numberOfCustomApplications + ' custom applications created, '
                    + response.numberOfSecureNotes + ' secure notes created, '
                    + 'number of failed imports ' + response.numberOfFailed + '.';

                if (0 < response.numberOfCustomApplications || 0 < response.numberOfSecureNotes) {
                    this._reloadCompanyApplications();
                }

                this._notify(message, true);
                this._notifyAccountLog();
            }

            _onImportPersonalResourcesFinished(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfCustomApplications + response.numberOfSecureNotes + ' resources imported out of '
                    + response.total + ', '
                    + response.numberOfCustomApplications + ' custom applications created, '
                    + response.numberOfSecureNotes + ' secure notes created, '
                    + 'number of failed imports ' + response.numberOfFailed + '.';

                if (0 < response.numberOfCustomApplications || 0 < response.numberOfSecureNotes) {
                    this._reloadHomePageApplications();
                }

                this._notify(message, true);
                this._notifyAccountLog();
            }

            _addApplicationsToOrgunit(applications) {

                if (applications.length > 0) {
                    this.set('_selectedApplications', applications);
                    this.$.appscoApplicationOrgunit.toggle();
                }
            }

            _onApplicationsAddedToOrgunit(event) {
                var applications = event.detail.applications,
                    orgunit = event.detail.orgunit,
                    application = applications[applications.length - 1];

                this._notify('Selected resources were successfully added to ' + orgunit.name + '.');
                this._modifyCompanyApplications(applications);
                this._reloadCompanyHomePageApplications();
                this._reloadHomePageApplications();
                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
                this._reloadApplicationAssignees();

                this.set('_companyApplication', {});
                this.set('_companyApplication', application);
            }

            _onSelectAllResourcesAction() {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.selectAllItems();
                }
            }

            _onShareResources() {
                var selectedApplications = this.$.appscoResourcesPage.getSelectedResources();

                if (selectedApplications.length > 0) {
                    this.set('_applicationsToShare', selectedApplications);
                    this.shadowRoot.getElementById('appscoShareResource').toggle();
                }
            }

            _onShareCompanyResource(event) {
                this.set('_applicationsToShare', []);
                this.set('_applicationsToShare', [event.detail.resource]);
                this.shadowRoot.getElementById('appscoShareResource').toggle();
            }

            _onAddResourceAdmin(event) {
                this.set('_applicationsToShare', []);
                this.set('_applicationsToShare', [event.detail.resource]);
                this.shadowRoot.getElementById('appscoAddResourceAdmin').toggle();
            }

            _onResourceAdminAdded(event) {
                if (this.shadowRoot.getElementById('appscoManageApplicationPage').$) {
                    this.shadowRoot.getElementById('appscoManageApplicationPage').reloadResourceAdmins();
                }
                this._notify('Resource admin successfully added.');
                this._notifyReloadApplications();
            }

            _onAddResourceToResourceAdmin(event) {
                var role = event.detail.role;
                this.shadowRoot.getElementById('appscoAddResourceToResourceAdmin').setRole(role);
                this.shadowRoot.getElementById('appscoAddResourceToResourceAdmin').toggle();
            }

            _onResourceAdminAssigned(event) {
                this.shadowRoot.getElementById('appscoManageAccountPage').reloadResourceAdmins();
            }

            _onResourcesShared(event) {
                var resources = event.detail.resources,
                    length = resources.length,
                    resource = resources[length - 1];

                for (var i = 0; i < length; i++) {

                    if (this._companyApplication && this._companyApplication.self === resources[i].self) {
                        resource = resources[i];
                        break;
                    }
                }

                this.set('_companyApplication', {});
                this.set('_companyApplication', resource);
                this.resetApplicationAssigneesPage();
                this._notify('Selected resources were successfully shared.');
                this._notifyReloadApplications();
                this._notifyReloadAccessOnBoarding();

                if (this.shadowRoot.getElementById('appscoAccessOnBoardingPage').$) {
                    this.shadowRoot.getElementById('appscoAccessOnBoardingPage').reloadRoles();
                }
            }

            _onNotificationSent(event) {
                this._notify('Notification successfully sent to '+ event.detail.counter +' accounts.');
            }

            resetApplicationAssigneesPage() {

                if (this.shadowRoot.getElementById('appscoManageApplicationPageActions').$) {
                    this.shadowRoot.getElementById('appscoManageApplicationPageActions').resetApplicationAssigneesPageActions();
                }
            }

            _reloadApplicationAssignees() {

                if (this.$.appscoManageApplicationPage.$) {
                    this.$.appscoManageApplicationPage.reloadAssignees();
                }
            }

            _modifyCompanyApplications(applications) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.modifyResources(applications);
                }
            }

            _reloadCompanyHomePageApplications() {

                if (this.$.appscoCompanyHomePage.$) {
                    this.$.appscoCompanyHomePage.reloadApplications();
                }
            }

            _reloadContactHomePageApplications() {

                if (this.$.appscoContactHomePage.$) {
                    this.$.appscoContactHomePage.reloadApplications();
                }
            }

            _reloadCompanyApplications() {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.reloadResources();
                }
            }

            _onChangeAssigneeClaims(event) {
                var assigneeClaimsComponent = this.shadowRoot.getElementById('appscoApplicationAssigneeClaims');

                assigneeClaimsComponent.setApplication(event.detail.application);
                assigneeClaimsComponent.setAssignee(event.detail.assignee);
                assigneeClaimsComponent.toggle();
            }

            _onAssigneeClaimsChanged(event) {
                this._notifyReloadAccounts();
                this._onApplicationUpdated(event);
                this._notify('Claims for ' + event.detail.assignee.display_name + ' were successfully changed.');
            }

            _onRevokeAssigneeAccess(event) {
                var assigneeRevokeComponent = this.shadowRoot.getElementById('appscoApplicationAssigneeRevoke');

                assigneeRevokeComponent.setAssignee(event.detail.assignee);
                assigneeRevokeComponent.toggle();
            }

            _onRevokeResourceAdmin(event) {
                var resourceAdminRevokeComponent = this.shadowRoot.getElementById('appscoResourceAdminRevoke');

                resourceAdminRevokeComponent.setAssignee(event.detail.assignee);
                resourceAdminRevokeComponent.setApplication(event.detail.application);
                resourceAdminRevokeComponent.toggle();
            }

            _removeApplicationAssignee(application, assignee) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.removeResourceAssignee(application, assignee);
                }

                if (this.$.appscoManageApplicationPage.$) {
                    this.$.appscoManageApplicationPage.removeApplicationAssignee(application, assignee);
                }
            }

            _onAssigneeAccessRevoked(event) {
                var application = event.detail.application,
                    assignee = event.detail.assignee;

                this.resetApplicationAssigneesPage();
                this._removeApplicationAssignee(application, assignee);

                if (this.$.appscoManageAccountPage.$) {
                    this.$.appscoManageAccountPage.reloadApplications();
                }

                if (this.$.appscoManageContactPage.$) {
                    this.$.appscoManageContactPage.reloadApplications();
                }

                this._notifyReloadApplications();
                this._notifyReloadAccounts();
                this._notifyReloadAccessOnBoarding();
                this._notify('Access for ' + assignee.display_name + ' on ' + application.title + ' was revoked successfully.');
            }

            _onResourceAdminRevoked(event) {
                var application = event.detail.application,
                    assignee = event.detail.assignee;

                if (this.$.appscoManageApplicationPage.$) {
                    this.$.appscoManageApplicationPage.reloadResourceAdmins();
                }

                if (this.$.appscoManageAccountPage.$) {
                    this.$.appscoManageAccountPage.reloadResourceAdmins();
                }

                this._notifyReloadApplications();
                this._notify('Resource admin access for ' + assignee.display_name + ' on ' + application.title + ' was revoked successfully.');
            }

            _removeApplications(applications) {

                if (applications.length > 0) {
                    this.set('_selectedApplications', applications);
                    this.shadowRoot.getElementById('appscoCompanyApplicationsRemove').toggle();
                }
            }

            _onRemoveApplications() {
                var selectedApplications = this.$.appscoResourcesPage.getSelectedResources();

                this._removeApplications(selectedApplications);
            }

            _onApplicationsRemoved(event) {
                this.set('_selectedApplications', []);

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.removeResources(event.detail.applications);
                }

                this._showCompanyResourcesPage();
                this._notify('Selected resources were successfully removed from company.');

                this._notifyReloadApplications();
            }

            _onApplicationsRemoveFailed() {
                this.set('_selectedApplications', []);
                this._notify('An error occurred. Selected resources were not removed from company. Please try again.');
            }

            _onRemoveCompanyApplication(event) {
                this._removeApplications([event.detail.application]);
            }

            _onAddApplicationToOrgunit(event) {
                this._addApplicationsToOrgunit([event.detail.application]);
            }

            _onRemoveApplicationFromGroup(event) {
                this.shadowRoot.getElementById('appscoApplicationRemoveGroup').setGroup(event.detail.group);
                this.shadowRoot.getElementById('appscoApplicationRemoveGroup').setApplication(event.detail.application);
                this.shadowRoot.getElementById('appscoApplicationRemoveGroup').toggle();
            }

            _onApplicationRemovedFromGroup(event) {
                var application = event.detail.application,
                    group = event.detail.group;

                this.$.appscoManageApplicationPage.removeGroup(group);
                this.$.appscoManageApplicationPage.reload();

                this._notify(application.application.title + ' has been successfully removed from group ' + group.name + '.');
                this._notifyReloadApplications();
            }

            _onDeviceApproveFinished(event) {
                var device = event.detail.device;
                this.$.appscoManageAccountPage.reloadDevices();
                this._notify('Device ' + device.name + ' has been successfully approved.');
            }

            _onDeviceDisapproveFinished(event) {
                var device = event.detail.device;
                this.$.appscoManageAccountPage.reloadDevices();
                this._notify('Device ' + device.name + ' has been successfully disapproved.');
            }

            _onEnableAssigneesSearchAction() {
                this.shadowRoot.getElementById('appscoManageApplicationPageActions').enableAssigneesSearchAction();
            }

            _onDisableAssigneesSearchAction() {
                this.shadowRoot.getElementById('appscoManageApplicationPageActions').disableAssigneesSearchAction();
            }

            _onResourceImageChanged() {
                this._notifyReloadApplications();
                this._reloadHomePageApplications();
            }

            _onImageUploadError(event) {
                this._notify('Upload failed: ' + event.detail);
            }

            _onComplianceInfoUpdated() {
                this._notify('Compliance information successfully modified.');
            }

            _onOpenMoveToFolderDialog(event) {
                var company = null;
                if (this.page != 'home' && !this._personalFolderPage) {
                    company = this.currentCompany;
                }
                var applicationIcon = event.detail.applicationIcon,
                    currentFolder = event.detail.currentFolder;

                var dialog = this.shadowRoot.getElementById('appscoFoldersApplicationAdd');
                dialog.setApplicationIcon(applicationIcon);
                dialog.setCurrentFolder(currentFolder);
                dialog.setCompany(company);
                dialog.toggle();
            }

            _onOpenRenameFolderDialog(event) {
                var company = null;
                if (this.page != 'home' && !this._personalFolderPage) {
                    company = this.currentCompany;
                }
                var folderItem = event.detail.folderItem;
                var dialog = this.shadowRoot.getElementById('appscoFoldersRename');

                dialog.setFolderItem(folderItem);
                dialog.setCompany(company);
                dialog.toggle();
            }

            _onOpenRemoveFolderDialog(event) {
                var company = null;
                if (this.page != 'home' && !this._personalFolderPage) {
                    company = this.currentCompany;
                }
                var folderItem = event.detail.folderItem;
                var dialog = this.shadowRoot.getElementById('appscoFoldersRemove');
                dialog.setFolderItem(folderItem);
                dialog.setCompany(company);
                dialog.toggle();
            }

            _onPageSettingsChanged(event) {
                var pageComponent = this.getCurrentAppscoPageElement(),
                    pageConfig = event.detail.pageConfig,
                    page = event.detail.page,
                    _pageConfig = JSON.parse(JSON.stringify(this._pageConfig));

                if (pageComponent.resetListFilters) {
                    pageComponent.resetListFilters();
                }

                _pageConfig[page] = pageConfig[page];
                this.set('_pageConfig', {});
                this.set('_pageConfig', _pageConfig);
            }

            /**
             * Resources page END
             */

            /**
             * Directory page START
             */
            _onInvitationResent(event) {
                this._notify('Invitation for account ' + event.detail.invitation.email + ' has been sent.');
            }

            _onContactInvitationResent(event) {
                this._notify('Invitation for contact ' + event.detail.invitation.email + ' has been sent.');
            }

            _onRemoveInvitationAction(event) {
                var invitationDeleteComponent = this.shadowRoot.getElementById('appscoInvitationRemove');

                invitationDeleteComponent.setInvitation(event.detail.invitation);
                invitationDeleteComponent.open();
            }

            _onInvitationRemoved(event) {
                var invitation = event.detail.invitation;

                switch (invitation.type) {
                    case 'user':
                        this.$.appscoDirectoryPage.removeInvitations([invitation]);
                        break;

                    case 'contact':
                        this.$.appscoContactsPage.removeInvitations([invitation]);
                        break;

                    default:
                        return false;
                }

                this._notify('Invitation for account ' + invitation.email + ' has been removed.');

            }

            _onInvitationAlreadyRemoved(event) {
                var invitation = event.detail.invitation;

                this.$.appscoDirectoryPage.removeInvitations([invitation]);
                this._notify('Invitation for account ' + invitation.email + ' has already been removed.');
            }

            _evaluateSubscriptionLicences() {

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.evaluateSubscriptionLicences();
                }
            }

            _searchAccounts(term) {
                this._showProgressBar();
                this.$.appscoDirectoryPage.filterDirectoryResourcesByTerm(term);
            }

            _onSearchAccounts(event) {
                this._searchAccounts(event.detail.term);
            }

            _onSearchAccountsClear() {
                this._searchAccounts('');
            }

            _onCompanyAddAccount() {
                this.shadowRoot.getElementById('appscoDirectoryAccountAdd').toggle();
            }

            _onCompanyImportAccounts() {
                this.shadowRoot.getElementById('appscoDirectoryImportAccounts').toggle();
            }

            _onInvitationCreated(event) {
                var invitation = event.detail.invitation;

                switch (invitation.type) {
                    case 'user':
                        this.$.appscoDirectoryPage.addInvitations([invitation]);
                        break;

                    case 'contact':
                        this.$.appscoContactsPage.addInvitations([invitation]);
                        break;

                    default:
                        return false;
                }

                this._notify('Invitation for account ' + invitation.email + ' was successfully created and can be found under invitations.');
            }

            _onCompanyRoleCreated(event) {
                this.$.appscoDirectoryPage.addAccounts([event.detail.role]);
                this._notify('Account ' + event.detail.role.account.email + ' was successfully added.');
            }

            _onCustomerResourcesImportFinished(event) {
                var response = event.detail.response,
                    message;
                message = 'Customer resources imported. Number of failed imports: ' + response.numberOfFailed;
                this._notify(message, true);
                this._notifyAccountLog();
            }

            _onAccountImportFinished(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfRoles + ' accounts imported out of ' + response.total + '.'
                    + ' Number of invitations created: ' + response.numberOfInvitations + '.'
                    + ' Number of failed imports: ' + response.numberOfFailed + '.';

                if (0 < response.numberOfRoles) {
                    this._reloadCompanyAccounts();
                }

                if (0 < response.numberOfInvitations) {
                    this._reloadCompanyInvitations();
                }

                if (response.maxSubscriptionSizeReached) {
                    this._showSubscriptionLimitReachedInfo(this._subscription);
                }

                this._notify(message, true);
                this._notifyAccountLog();
            }

            _addAccountsToOrgunit(accounts) {

                if (accounts.length > 0) {
                    this.set('_selectedAccounts', accounts);
                    this.shadowRoot.getElementById('appscoAccountOrgunit').toggle();
                }
                else {
                    this._onHideDirectoryBulkActions();
                }
            }

            _onAddAccountsToOrgunit() {
                var selectedAccounts = this.$.appscoDirectoryPage.getSelectedAccounts();

                this._addAccountsToOrgunit(selectedAccounts);
            }

            _onAccountsAddedToOrgunit(event) {
                var accounts = event.detail.accounts,
                    length = accounts.length;

                this._notify('Selected accounts were successfully added to ' + event.detail.orgunit.name + '.');

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.modifyAccounts(accounts);
                }

                if (accounts.length === 1) {
                    this._role = accounts[0];
                }

                for (var i = 0; i < length; i++) {
                    if (accounts[i].account.email === this.account.email) {
                        this._reloadHomePageApplications();
                        break;
                    }
                }

                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
            }

            _onRemoveAccounts() {
                var selectedAccounts = this.$.appscoDirectoryPage.getSelectedAccounts();

                if (selectedAccounts.length > 0) {
                    this.set('_selectedAccounts', selectedAccounts);
                    this.shadowRoot.getElementById('appscoAccountsRemove').toggle();
                }
                else {
                    this._onHideDirectoryBulkActions()
                }
            }

            _onAccountsRemoved(event) {
                this.$.appscoDirectoryPage.removeAccounts(event.detail.accounts);
                this._onHideDirectoryBulkActions();
                this.set('_selectedAccounts', []);
                this._notify('Selected accounts were successfully removed from company.');

                this._notifyAccountLog();
                this._notifyReloadAccessOnBoarding();
            }

            _onManageDomains() {
                this.$.appscoCompanyPage.showDomainsPage = true;
                this._showCompanyPage();
            }

            _onFilterRoles(event) {
                var filter = event.detail.filter;

                this._showProgressBar();
                this.$.appscoDirectoryPage.filterAccounts(filter);
            }

            _reloadCompanyAccounts() {
                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.reloadAccounts();
                }
            }

            _reloadCompanyContacts() {
                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.reloadContacts();
                }
            }

            _reloadCompanyInvitations() {
                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.reloadInvitations();
                }
            }

            _onReloadAccounts() {

                switch (this.page) {
                    case 'manage-account':
                        this._reloadCompanyAccounts();
                        break;

                    default:
                        break;
                }
            }

            _showSubscriptionLimitReachedInfo(subscription) {
                this.dispatchEvent(new CustomEvent('show-subscription-limit-reached-info', {
                    bubbles: true,
                    composed: true,
                    detail: {
                        subscription: subscription
                    }
                }));
            }

            _onResetDirectoryTypeFilter() {
                this.shadowRoot.getElementById('appscoDirectoryPageActions').resetTypeFilter();
            }

            _onSendNotificationToCompanyRoles() {
                var dialog = this.shadowRoot.getElementById('appscoSendNotification');
                dialog.setFilterType('user');
                dialog.toggle();
            }

            /**
             * Directory page END
             */

            /**
             * Manage Account page START
             */
            _onShowSubscriptionLimitReachedInfo(event) {
                this.shadowRoot.getElementById('appscoDirectoryPageActions').showSubscriptionLimitReachedInfo(event.detail.subscription);
            }

            _onHideSubscriptionLimitReachedInfo() {
                this.shadowRoot.getElementById('appscoDirectoryPageActions').hideSubscriptionLimitReachedInfo();
            }

            _onShowDomainNotVerifiedInfo() {
                this.shadowRoot.getElementById('appscoDirectoryPageActions').showDomainNotVerifiedInfo();
            }

            _onHideDomainNotVerifiedInfo() {
                this.shadowRoot.getElementById('appscoDirectoryPageActions').hideDomainNotVerifiedInfo();
            }

            _onEditAccount(event) {
                var role = event.detail.role;

                this.set('_role', role);
                this._showManagePage('manage-account/' + role.alias);
            }

            _onResourceActionManageAccountPage() {
                this.$.appscoManageAccountPage.toggleResource();
            }

            _onCompanyAccountPasswordChanged(event) {
                this._notify('Password for ' + event.detail.account.name + ' was successfully changed.');

                this._notifyReloadAccounts();
            }

            _onResetRoleTwoFA(event) {
                var component = this.shadowRoot.getElementById('appscoRoleResetTwoFA');

                component.setRole(event.detail.role);
                component.open();
            }

            _onRoleTwoFAReset(event) {

                if (this.$.appscoManageAccountPage.$) {
                    this.$.appscoManageAccountPage.resetPage();
                }

                this._notify('You have successfully reset two-factor authentication for ' + event.detail.role.account.name);
            }

            _onAddAccountToOrgunit(event) {
                this._addAccountsToOrgunit([event.detail.role]);
            }

            _onRemoveAccountFromOrgunit(event) {
                this.shadowRoot.getElementById('appscoAccountRemoveOrgunit').orgunit = event.detail.orgunit;
                this._role = event.detail.account;
                this.shadowRoot.getElementById('appscoAccountRemoveOrgunit').toggle();
            }

            _onRemoveAccountFromGroup(event) {
                this.shadowRoot.getElementById('appscoAccountRemoveGroup').group = event.detail.group;
                this._role = event.detail.account;
                this.shadowRoot.getElementById('appscoAccountRemoveGroup').toggle();
            }

            _onRemoveContactFromGroup(event) {
                let appscoContactRemoveGroup = this.shadowRoot.getElementById('appscoContactRemoveGroup');
                appscoContactRemoveGroup.setGroup(event.detail.group);
                appscoContactRemoveGroup.setContact(event.detail.contact);
                appscoContactRemoveGroup.toggle();
            }

            _onAccountRemovedFromOrgunit(event) {
                var role = event.detail.account;

                if (role.account.email === this.account.email) {
                    this._reloadHomePageApplications();
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.modifyAccounts([role]);
                }

                this._role = role;
                this._notify(role.account.name + ' has been removed from ' + event.detail.orgunit.name + ' organization unit.');

                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
            }

            _onAccountRemovedFromGroup(event) {
                var role = event.detail.account,
                    group = event.detail.group;

                this.$.appscoManageAccountPage.removeGroup(group);

                if (role.account.email === this.account.email) {
                    this._reloadHomePageApplications();
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.modifyAccounts([role]);
                }

                this._role = role;
                this._notify(role.account.name + ' has been successfully removed from group ' + group.name + '.');

                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
            }

            _onContactRemovedFromGroup(event) {
                var contact = event.detail.contact,
                    group = event.detail.group;

                this.$.appscoManageContactPage.removeGroup(group);
                this.$.appscoManageContactPage.reload();

                this.$.appscoContactsPage.reloadContacts();

                this._notify(contact.display_name + ' has been successfully removed from group ' + group.name + '.');
            }

            _onAccountRoleChanged(event) {
                var accountName = event.detail.account.account.name,
                    role = event.detail.role,
                    message = '';

                if (role.value) {
                    message = role.name + ' role is given to ' + accountName + '.';
                }
                else {
                    message = role.name + ' role is revoked from ' + accountName + '.';
                }

                this._notify(message);
                this._notifyReloadAccounts();
                this._reloadAccountLog();
            }

            /**
             * Manage Account page END
             */

            /**
             * Contacts page START
             */
            _onAddContactAction() {
                this.shadowRoot.getElementById('appscoAddContact').toggle();
            }

            _onContactCreated(event) {
                var contact = event.detail.contact;

                this.$.appscoContactsPage.addContacts([contact]);
                this._notify('Contact ' + contact.email + ' was successfully added.');
            }

            _onImportContactsAction() {
                this.shadowRoot.getElementById('appscoImportContacts').toggle();
            }

            _onImportContactsFinished(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfContacts + ' contacts imported out of ' + response.total + '.'
                    + ' Number of invitations created: ' + response.numberOfInvitations + '.'
                    + ' Number of failed imports: ' + response.numberOfFailed + '.';

                if (0 < response.numberOfContacts) {
                    this._reloadContactsAndActions();
                }

                if (0 < response.numberOfInvitations) {
                    this._reloadContactsInvitations();
                }

                this._notify(message, true);
                this._notifyAccountLog();
            }

            _reloadContactsAndActions() {

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.reloadContactsAndActions();
                }
            }

            _reloadContactsInvitations() {
                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.reloadInvitations();
                }
            }

            _onDeleteContactsAction() {
                var selectedContacts = this.$.appscoContactsPage.getSelectedContacts();

                if (selectedContacts.length > 0) {
                    this.set('_selectedContacts', selectedContacts);
                    this.shadowRoot.getElementById('appscoContactsRemove').toggle();
                }
                else {
                    this._onHideContactBulkActions()
                }
            }

            _onSelectAllGroupsAction() {

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.selectAllItems();
                }
            }

            _onRemoveGroupsAction() {
                var selectedGroups = this.$.appscoGroupsPage.getSelectedGroups();

                if (selectedGroups.length > 0) {
                    this.set('_selectedGroups', selectedGroups);
                    this.shadowRoot.getElementById('appscoGroupsRemove').toggle();
                }
                else {
                    this._onHideGroupsBulkActions()
                }
            }

            _onNotifyGroupsAction() {
                this.shadowRoot.getElementById('appscoNotifyGroup').toggle();
            }

            _onRemovedGroups() {
                this.shadowRoot.getElementById('appscoGroupsPage').removeGroups(this._selectedGroups);
                this.shadowRoot.getElementById('appscoGroupsPage').hideBulkActions();
                this._notify('Selected groups were successfully removed from company.');
            }

            _onGroupsRemoveFailed() {
                this.set('_selectedGroups', []);
                this._notify('An error occurred. Selected groups were not removed from company. Please try again.');
            }

            _onDeletedContacts() {
                this.shadowRoot.getElementById('appscoContactsPage').removeContacts(this._selectedContacts);
                this.shadowRoot.getElementById('appscoContactsPage').hideBulkActions();
                this._notify('Selected contacts were successfully removed from company.');
            }

            _onDeleteContactsFailed() {
                this.set('_selectedContacts', []);
                this._notify('An error occurred. Selected contacts were not removed from company. Please try again.');
            }

            _onAddGroupsToContactsAction() {
                var selectedContacts = this.$.appscoContactsPage.getSelectedContacts();
                this._shareToGroup(selectedContacts, 'contact');
            }

            _onSelectAllContactsAction() {

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.selectAllItems();
                }
            }

            _onContactsPageSelected(event) {
                var page = event.detail.page.toLowerCase();

                this.$.appscoContactsPage.showPage(page);
            }

            _searchContacts(term) {
                this._showProgressBar();
                this.$.appscoContactsPage.filterByTerm(term);
            }

            _onSearchContacts(event) {
                this._searchContacts(event.detail.term);
            }

            _onSearchContactsClear() {
                this._searchContacts('');
            }

            _onSendNotificationToContacts() {
                var dialog = this.shadowRoot.getElementById('appscoSendNotification');
                dialog.setFilterType('contact');
                dialog.toggle();
            }
            /**
             * Contacts page END
             */

            /**
             * Groups page START
             */
            _onAddCompanyGroupAction() {
                this.shadowRoot.getElementById('appscoCompanyAddGroup').open();
            }

            _onRenameCompanyGroupAction(event) {
                var groupModal = this.shadowRoot.getElementById('appscoCompanyRenameGroup');
                groupModal.setGroup(event.detail.group);
                groupModal.open();
            }

            _onSearchCompanyGroupAction(event) {
                this._searchCompanyGroups(event.detail.term);
            }

            _onSearchCompanyGroupClear() {
                this._searchCompanyGroups('');
            }

            _searchCompanyGroups(term) {
                this._showProgressBar();
                this.$.appscoGroupsPage.filterByTerm(term);
            }

            _onEditCompanyGroupAction(event) {
                var group = event.detail.item;

                this.set('_group', group);
                this._showManagePage('manage-group/' + group.alias);
            }
            /**
             * Groups page END
             */


            /**
             * Manage Contact page START
             */
            _onEditContactAction(event) {
                var contact = event.detail.contact;

                if (this.$.appscoManageContactPage.$) {
                    this.$.appscoManageContactPage.setContact(contact);
                }

                this._showManagePage('manage-contact/' + contact.alias);
            }

            _onHideContactsBulkActions() {
                this.shadowRoot.getElementById('appscoContactsPageActions').hideBulkActions();
            }

            _onConvertContactToUserAction(event) {
                var contact = event.detail.contact,
                    convertContact = this.shadowRoot.getElementById('appscoConvertContact');

                convertContact.setContact(contact);
                convertContact.toggle();
            }

            _onContactConverted(event) {
                var contact = event.detail.contact;

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.removeContacts([contact]);
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.reloadAccounts();
                }

                this._showContactsPage();
                this._notify('Contact ' + contact.display_name + ' has been successfully converted to company user.');
            }

            _onDeleteContactAction(event) {
                var contact = event.detail.contact,
                    deleteContact = this.shadowRoot.getElementById('appscoDeleteContact');

                deleteContact.setContact(contact);
                deleteContact.toggle();
            }

            _onDeleteCustomerAction(event) {
                this.shadowRoot.getElementById('appscoRemoveCustomer').setCustomer(event.detail.customer);
                this.shadowRoot.getElementById('appscoRemoveCustomer').open();
            }

            _onCustomerRemoved(event) {
                var customer = event.detail.customer;

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.removeCustomers([customer]);
                }

                this._showCustomersPage();
                this._notify('Customer ' + customer.name + ' has been deleted from company.');
            }

            _onCustomerLicencesManaged(event) {
                var customer = event.detail.customer;

                if (this.$.appscoManageCustomerPage.$) {
                    this.$.appscoManageCustomerPage.reloadCustomer(customer);
                }

                this._notify('Licences successfully assigned.');
            }

            _onContactDeleted(event) {
                var contact = event.detail.contact;

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.removeContacts([contact]);
                }

                this._showContactsPage();
                this._notify('Contact ' + contact.display_name + ' has been deleted from company.');
            }
            /**
             * Manage Contact page END
             */

            /**
             * Audit Log page START
             */
            _onResourceActionAuditLogPage() {
                this.$.appscoAuditLogPage.toggleResource();
            }
            /**
             * Audit Log page END
             */

            /**
             * Get started page START
             */
            _onTutorialStart(event) {
                this.$.appscoTutorial.startTutorial(event.detail.tutorialId);
            }

            /**
             * Get started page END
             */

            /**
             * Access On-boarding page START
             */
            _onEventsResolved(event) {
                this._notify((0 === event.detail.unresolvedItems.length) ?
                    'Selected events have been resolved manually.' :
                    'There was an error while resolving some events. Not all events were resolved.');
            }

            _notifyReloadAccessOnBoarding() {
                this.dispatchEvent(new CustomEvent('reload-access-of-boarding', { bubbles: true, composed: true }));
            }

            _onReloadAccessOnBoarding() {
                if (this.$.appscoAccessOnBoardingPage.$) {
                    this.$.appscoAccessOnBoardingPage.reloadRoles();
                }
            }

            _onExportAccessOnBoardingAction() {

                if (this.$.appscoAccessOnBoardingPage.$) {
                    this._showProgressBar();
                    this.$.appscoAccessOnBoardingPage.export();
                }
            }

            _onExportAccessOnBoardingFailed() {
                this._hideProgressBar();
                this._notify('Export of Access On-boarding status list failed. Please contact AppsCo support.');
            }
            /**
             * Access On-boarding page END
             */

            /**
             * Billing page START
             */
            _onResourceActionBillingPage() {
                this.$.appscoBillingPage.toggleResource();
            }

            _fireUpgrade(event) {
                var dialog = this.shadowRoot.getElementById('appscoUpgradeAction');
                dialog.setSubscription(event.detail.subscription);
                dialog.setPlans(event.detail.plans);
                dialog.initializePage();
                dialog.toggle();
            }

            _onUpdateSubscription(event) {
                if (this.shadowRoot.getElementById('appscoUpdateSubscriptionAction').$) {
                    this.shadowRoot.getElementById('appscoUpdateSubscriptionAction').setSubscription(event.detail.subscription);
                    this.shadowRoot.getElementById('appscoUpdateSubscriptionAction').toggle();
                }
            }

            _setSubscription(subscription) {

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.setSubscription(subscription);
                }
                else {
                    this.$.appscoDirectoryPage.subscription = subscription;
                    this.$.appscoDirectoryPage.subscriptionLoaded = true;
                }
            }

            _reloadSubscription() {

                if (this.$.appscoBillingPage.$) {
                    this.$.appscoBillingPage.reloadSubscription();
                }

                if (this.$.appscoCustomerBillingPage.$) {
                    this.$.appscoCustomerBillingPage.reloadSubscription();
                }

            }

            _onSubscriptionUpdated(event) {
                this._reloadSubscription(event.detail.subscription);
                this._notify('Subscription has been successfully changed.');
            }

            _onSubscriptionChanged(event) {
                this._setSubscription(event.detail.subscription);
                this._reloadSubscription(event.detail.subscription);
                this._evaluateSubscriptionLicences();
                this._notify('Subscription has been successfully changed.');
            }

            _onCancelSubscription(event) {
                this.shadowRoot.getElementById('appscoSubscriptionCancel').setSubscription(event.detail.subscription);
                this.shadowRoot.getElementById('appscoSubscriptionCancel').toggle();
            }

            _onSubscriptionCanceled(event) {
                this._setSubscription(event.detail.subscription);
                this._reloadSubscription();
                this._notify('Subscription has been successfully canceled.');
            }

            _onManageCreditCard() {
                this.shadowRoot.getElementById('appscoCreditCard').toggle();
            }

            _onCreditCardAdded(event) {
                if (this.$.appscoBillingPage.$) {
                    this.$.appscoBillingPage.setCreditCard(event.detail.credit_card);
                }
                if (this.$.appscoCustomerBillingPage.$) {
                    this.$.appscoCustomerBillingPage.setCreditCard(event.detail.credit_card);
                }
                this._notify('Credit card has been successfully saved.');
            }

            _onSendInvoice(event) {
                this.shadowRoot.getElementById('appscoBillingSendInvoice').setInvoice(event.detail.invoice);
                this.shadowRoot.getElementById('appscoBillingSendInvoice').setSubscription(event.detail.subscription);
                this.shadowRoot.getElementById('appscoBillingSendInvoice').toggle();
            }

            _onInvoiceSent(event) {
                this._notify('Invoice has been sent to ' + event.detail.sentTo + '.');
            }
            /**
             * Billing page END
             */

            /**
             * Provisioning page START
             */
            _onAddIntegrationAction() {
                this.shadowRoot.getElementById('appscoAddIntegration').open();
            }

            _onIntegrationRequested(event) {

                if (event.detail.authorizationUrl) {
                    window.location.href = event.detail.authorizationUrl;
                }
            }

            _onEditIntegrationAction(event) {
                var integration = event.detail.integration;

                if (this.$.appscoManageIntegrationPage.$) {
                    this.$.appscoManageIntegrationPage.setIntegration(integration);
                }

                this._showManagePage('manage-integration/' + integration.alias);
            }

            _onIntegrationSettingsChanged(event) {
                var integration = event.detail.integration;

                if (this.$.appscoProvisioningPage.$) {
                    this.$.appscoProvisioningPage.setIntegration(integration);
                }

                this._notify('Settings for integration ' + integration.name + ' has been successfully saved.');
            }

            _onRemoveIntegrationAction(event) {
                this.shadowRoot.getElementById('appscoRemoveIntegration').setIntegration(event.detail.integration);
                this.shadowRoot.getElementById('appscoRemoveIntegration').open();
            }

            _onIntegrationSetup(event) {
                this._selectedIntegration = event.detail.integration;
                this.set('routeData.page', 'provisioning-settings');
            }

            _onAddIntegrationRuleAction(event) {
                var addIntegrationRuleComponent = this.shadowRoot.getElementById('appscoAddIntegrationRule');

                addIntegrationRuleComponent.setIntegration(event.detail.integration);
                addIntegrationRuleComponent.open();
            }

            _onIntegrationRuleAdded(event) {
                this._notify('Rule for ' + event.detail.integration.name + ' has been successfully added.');

                if (this.$.appscoManageIntegrationPage.$) {
                    this.$.appscoManageIntegrationPage.addIntegrationRule(event.detail.rule);
                }
            }

            _triggerIntegrationRuleAction(integration, rule, component) {
                component.setIntegration(integration);
                component.setIntegrationRule(rule);
                component.open();
            }

            _onEditIntegrationRuleAction(event) {
                this._triggerIntegrationRuleAction(event.detail.integration, event.detail.rule, this.shadowRoot.getElementById('appscoEditIntegrationRule'));
            }

            _onIntegrationRuleEdited(event) {
                this._notify('Rule for ' + event.detail.integration.name + ' has been successfully modified.');

                if (this.$.appscoManageIntegrationPage.$) {
                    this.$.appscoManageIntegrationPage.modifyIntegrationRule(event.detail.rule);
                }
            }

            _onRunIntegrationRuleAction(event) {
                this._triggerIntegrationRuleAction(event.detail.integration, event.detail.rule, this.shadowRoot.getElementById('appscoRunIntegrationRule'));
            }

            _onIntegrationForceSync(event) {
                this.shadowRoot.getElementById('appscoRunIntegrationForceSync').setIntegration(event.detail.integration);
                this.shadowRoot.getElementById('appscoRunIntegrationForceSync').open();
            }

            _onIntegrationRuleRun(event) {
                this._notify('Rule for ' + event.detail.integration.name + ' has been applied.');
            }

            _onForceSyncRun(event) {
                this._notify('Resync for ' + event.detail.integration.name + ' has been finished.');
            }

            _onRemoveIntegrationRuleAction(event) {
                this._triggerIntegrationRuleAction(event.detail.integration, event.detail.rule, this.shadowRoot.getElementById('appscoRemoveIntegrationRule'));
            }

            _onIntegrationRuleRemoved(event) {
                this._notify('Rule for ' + event.detail.integration.name + ' has been removed.');

                if (this.$.appscoManageIntegrationPage.$) {
                    this.$.appscoManageIntegrationPage.removeIntegrationRule(event.detail.rule);
                }
            }

            _onRegisterIntegrationWebhookAction(event) {
                var component = this.shadowRoot.getElementById('appscoRegisterIntegrationWebhook');

                component.setIntegration(event.detail.integration);
                component.setIntegrationWebhook(event.detail.webhook);
                component.open();
            }

            _onIntegrationWebhookRegistered(event) {
                this._notify('Web hook for ' + event.detail.integration.name + ' has been registered.');

                if (this.$.appscoManageIntegrationPage.$) {
                    this.$.appscoManageIntegrationPage.addIntegrationWatcher(event.detail.watcher);
                }
            }

            _onUnregisterIntegrationWebhookAction(event) {
                var component = this.shadowRoot.getElementById('appscoUnegisterIntegrationWebhook');

                component.setIntegration(event.detail.integration);
                component.setIntegrationWebhook(event.detail.webhook);
                component.open();
            }

            _onIntegrationWebhookUnregistered(event) {
                this._notify('Web hook for ' + event.detail.integration.name + ' has been unregistered.');

                if (this.$.appscoManageIntegrationPage.$) {
                    this.$.appscoManageIntegrationPage.removeIntegrationWatcher(event.detail.watcher);
                }
            }
            /**
             * Provisioning page END
             */

            /**
             * Company page START
             */
            _onResourceActionCompanyPage() {
                this.getCurrentAppscoPageElement().toggleResource();
            }

            _onCompanySettingsChanged(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company settings were successfully saved.');
            }

            _onCompanyIPWhiteListChanged(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company IP whitelist was successfully saved.');
            }

            _onCompanyBrandSettingsChanged(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company brand settings were successfully saved.');
            }

            _onCompanyBrandedLoginChanged() {
                this._notify('Branded login settings were successfully saved.');
            }

            _onCompanyLogoChanged(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company logo was successfully saved.');

                this._notifyAccountLog();
            }

            _onCompanyDashboardLogoChanged(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company dashboard logo was successfully saved.');

                this._notifyAccountLog();
            }

            _upgradedToBusiness(e) {
                this.account = {};
                this.account = e.detail.account;

                this.currentCompany = this.account.companies[this.account.companies.length - 1];
                this._setProduct(true);

                this.set('routeData.page', 'get-started');
                this._notify('Upgrade to AppsCo business succeeded.');

                setTimeout(function() {
                    this._notify('Please setup your company settings.');
                }.bind(this), 2000);
            }

            _onUpgradeToCompanyFailed(event) {
                this._notify(this._apiErrors.getError(event.detail.error), true);
            }

            _onShowDomainsPageActions() {
                this.shadowRoot.getElementById('appscoCompanyPageActions').showDomainsPageActions();
            }

            _onHideDomainsPageActions() {
                this.shadowRoot.getElementById('appscoCompanyPageActions').hideDomainsPageActions();
            }

            _onAddDomain() {
                this.shadowRoot.getElementById('appscoCompanyAddDomain').open();
            }

            _onAddIdpCertificate(event) {
                this.shadowRoot.getElementById('appscoCompanyAddCertificate').setSource(event);
                this.shadowRoot.getElementById('appscoCompanyAddCertificate').open();
            }

            _onDomainAdded(event) {
                var domain = event.detail.domain;

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.evaluateDomainVerification({
                        domain: domain,
                        added: true,
                        removed: false
                    });
                }

                this.$.appscoCompanyPage.addDomain(domain);
                this.$.appscoTutorial.notifyDomainAdded(domain);
                this._notify('Domain ' + domain.domain + ' was successfully saved.');
            }

            _onRemoveDomain(event) {
                this.shadowRoot.getElementById('appscoCompanyRemoveDomain').setDomain(event.detail.domain);
                this.shadowRoot.getElementById('appscoCompanyRemoveDomain').open();
            }

            _onIntegrationRemoved(event) {
                this.$.appscoProvisioningPage.reloadIntegrations();
                this._showCompanyProvisioningPage();
                this._notify('Integration was successfully removed.');
            }

            _onDomainRemoved(event) {
                var domain = event.detail.domain;

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.evaluateDomainVerification({
                        domain: domain,
                        added: false,
                        removed: true
                    });
                }

                this.$.appscoCompanyPage.removeDomain(domain);
                this._notify('Domain ' + domain.domain + ' was successfully removed.');
            }

            _onDomainGetToken(event) {
                this.shadowRoot.getElementById('appscoCompanyDomainToken').setDomain(event.detail.domain);
                this.shadowRoot.getElementById('appscoCompanyDomainToken').open();
            }

            _onDomainVerified(event) {
                var domain = event.detail.domain;

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.hideDomainNotVerifiedInfo();
                }

                if (this.$.appscoCompanyPage.$) {
                    this.$.appscoCompanyPage.reloadIdPDomains();
                }

                this.$.appscoCompanyPage.modifyDomain(domain);
                this._notify('Domain ' + domain.domain + ' was successfully verified.');
            }

            _onDomainNotVerified(event) {
                var domain = event.detail.domain;

                this._notify('Unable to verify ' + domain.domain + ' domain - please wait until the DNS record change is propagated.', true);
            }

            _onIdPSettingsSaved(event) {
                this._notify('IdP settings for ' + event.detail.domain.domain + ' domain was successfully saved.');
            }

            _onDeactivateDomainIdPSettings(event) {
                var dialog = this.shadowRoot.getElementById('appscoDeactivateIdPSettings');
                dialog.setDomain(event.detail.domain);
                dialog.open();
            }

            _onIdPSettingsDeactivated(event) {
                var domain = event.detail.domain;

                this.$.appscoCompanyPage.modifyDomain(domain);
                this._notify('IdP settings for ' + domain.domain + ' domain was successfully deactivated.');
            }

            _onTransferTokenSent() {
                this._notify('Transfer token email has been successfully sent.');
            }

            _onCompanyDomainsLoadFinished() {
                this._companyDomainsLoaded = true;
            }
            /**
             * Company page END
             */

            /**
             * Company Home page START
             */
            _onAddNewFolderAction(event) {
                var component = this.shadowRoot.getElementById('appscoAddFolder');

                if (component.$) {
                    if (event.detail.personal == true) {
                        component.setOnPersonal();
                    }
                    component.open();
                }
            }

            _addFolder(folder) {
                var companyHomePage = this.$.appscoCompanyHomePage,
                    homePage = this.$.appscoHomePage;

                if (companyHomePage.$) {
                    companyHomePage.addFolder(folder);
                }

                if (homePage.$) {
                    homePage.addFolder(folder);
                }
            }

            _renameFolder(folder) {
                var companyHomePage = this.$.appscoCompanyHomePage,
                    homePage = this.$.appscoHomePage;

                if (companyHomePage.$) {
                    companyHomePage.renameFolder(folder);
                }

                if (homePage.$) {
                    homePage.renameFolder(folder);
                }
            }

            _removeFolder(folder) {
                var companyHomePage = this.$.appscoCompanyHomePage,
                    homePage = this.$.appscoHomePage;

                if (companyHomePage.$) {
                    companyHomePage.removeFolder(folder);
                }

                if (homePage.$) {
                    homePage.removeFolder(folder);
                }
            }

            _onFolderAdded(event) {
                var folder = event.detail.folder;

                this._addFolder(folder);
                this._notify('Dashboard folder ' + folder.title + ' has been successfully created.');
            }

            _onFolderRenamed(event) {
                var folder = event.detail.folder;

                this._renameFolder(folder);
                this._notify('Dashboard folder ' + folder.title + ' has been renamed.');
            }

            _onFolderRemoved(event) {
                var folder = event.detail.folder;

                this._removeFolder(folder);
                this._notify('Dashboard folder ' + folder.title + ' has been removed.');
            }

            _openFolder(folder) {

                if (this.$.appscoDashboardFolderPage.$) {
                    this.$.appscoDashboardFolderPage.setFolder(folder);
                }

                this._showManagePage('dashboard-folder/' + folder.alias);
            }

            _onFolderTapped(event) {
                this._personalFolderPage = event.detail.personal;
                this._openFolder(event.detail.folder);
            }

            _addResourceToCompanyHomePage(resource) {

                if (this.$.appscoCompanyHomePage.$) {
                    this.$.appscoCompanyHomePage.addApplications([resource]);
                }
            }

            _removeResourceFromCompanyHomePage(resource) {

                if (this.$.appscoCompanyHomePage.$) {
                    this.$.appscoCompanyHomePage.removeApplications([resource]);
                }
            }

            _addResourceToDashboardFolderPage(resource, folder) {
                var dashboardFolderPage = this.$.appscoDashboardFolderPage;

                if (dashboardFolderPage.$ && (folder.alias === dashboardFolderPage.getFolder().alias)) {
                    dashboardFolderPage.addApplications([resource]);
                }
            }

            _removeResourceFromDashboardFolderPage(resource, folder) {
                var dashboardFolderPage = this.$.appscoDashboardFolderPage;

                if (dashboardFolderPage.$ && (folder.alias === dashboardFolderPage.getFolder().alias)) {
                    dashboardFolderPage.removeApplications([resource]);
                }
            }

            _onResourceMovedToFolder(event) {
                var resource = event.detail.resource,
                    folder = event.detail.folder,
                    sourceFolder = event.detail.sourceFolder;

                if (sourceFolder && folder.alias !== sourceFolder.alias) {
                    this._removeResourceFromDashboardFolderPage(resource, sourceFolder);
                }

                switch (this.page) {
                    case 'home':
                        this._reloadHomePageApplications();
                        this._addResourceToDashboardFolderPage(resource, folder);
                        break;

                    case 'company-home':
                        this._removeResourceFromCompanyHomePage(resource);
                        this._addResourceToDashboardFolderPage(resource, folder);

                        break;

                    case 'contact-home':
                        this._reloadContactHomePageApplications();
                        break;
                }

                this._notify('Resource ' + resource.title + ' has been moved to folder ' + folder.title + '.');
            }

            _onResourceRemovedFromFolder(event) {
                var resource = event.detail.resource,
                    folder = event.detail.folder;

                this._removeResourceFromDashboardFolderPage(resource, folder);
                this._addResourceToCompanyHomePage(resource);
                this._reloadHomePageApplications();
                this._reloadContactHomePageApplications();

                this._notify('Resource ' + resource.title + ' has been removed from folder ' + folder.title + '.');
            }
            /**
             * Company Home page END
             */

            /**
             * Groups page START
             */
            _onShowGroupsPageActions() {
                this.shadowRoot.getElementById('appscoCompanyPageActions').showGroupsPageActions();
            }

            _onHideGroupsPageActions() {
                this.shadowRoot.getElementById('appscoCompanyPageActions').hideGroupsPageActions();
            }

            _addGroup(group) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.addGroup(group);
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.addGroup(group);
                }

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.addGroup(group);
                }

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.addGroup(group);
                    this._reloadGroups();
                }
            }

            _renameGroup() {
                this._reloadGroups();
            }

            _onGroupAdded(event) {
                var group = event.detail.group;

                this._addGroup(group);
                this._notify('Group ' + group.name + ' was successfully saved.');
            }

            _onGroupRenamed(event) {
                var group = event.detail.group;

                this._renameGroup(group);
                this._notify('Group ' + group.name + ' was successfully saved.');
            }

            _searchGroups(term) {
                this._showProgressBar();
                this.$.appscoCompanyPage.searchGroups(term);
            }

            _onSearchGroups(event) {
                this._searchGroups(event.detail.term);
            }

            _onSearchGroupsClear() {
                this._searchGroups('');
            }

            _onRemoveGroupAction(event) {
                this.shadowRoot.getElementById('appscoCompanyRemoveGroup').setGroup(event.detail.group);
                this.shadowRoot.getElementById('appscoCompanyRemoveGroup').open();
            }

            _onGroupRemoved(event) {
                var group = event.detail.group;

                this._removeGroup(group);
                this._reloadApplicationsForCompanyAdministrator();
                this._showGroupsPage();
                this._notify('Group ' + group.name + ' was successfully removed.');
            }

            _removeGroup(group) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.removeGroup(group);
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.removeGroup(group);
                }

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.removeGroup(group);
                }

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.removeGroup(group);
                }

                this._reloadCompanyApplications();
                this._reloadCompanyAccounts();
                this._reloadCompanyContacts();
            }

            _onSelectAllCompanyRolesAction() {

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.selectAllItems();
                }
            }

            _shareToGroup(items, type) {

                if (items.length > 0) {
                    this.shadowRoot.getElementById('appscoShareToGroupDialog').setItems(items);
                    this.shadowRoot.getElementById('appscoShareToGroupDialog').setType(type);
                    this.shadowRoot.getElementById('appscoShareToGroupDialog').open();
                }
            }

            _onAddGroupsToCompanyRoles() {
                var selectedRoles = this.$.appscoDirectoryPage.getSelectedAccounts();

                this._shareToGroup(selectedRoles, 'role');
            }

            _handleResourcesAddedToGroupResponse(groups, items, resourceType) {
                var length = items.length,
                    oneItem = (length === 1);

                if (this.$.appscoManageGroupPage.$) {
                    this.$.appscoManageGroupPage.addGroupItems(groups, items, resourceType);
                }

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.recalculateTotals(groups, resourceType);
                }

                switch (resourceType) {
                    case 'resource':

                        if (oneItem) {
                            this._companyApplication = items[0];
                        }

                        this._notify('Selected resources were successfully shared to groups.');
                        this._modifyCompanyApplications(items);
                        this._reloadCompanyHomePageApplications();
                        this._reloadHomePageApplications();
                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'role':

                        if (oneItem) {
                            this._role = items[0];
                        }

                        if (this.$.appscoDirectoryPage.$) {
                            this.$.appscoDirectoryPage.modifyAccounts(items);
                        }

                        for (var i = 0; i < length; i++) {
                            if (items[i].account.email === this.account.email) {
                                this._reloadHomePageApplications();
                                this._reloadCompanyHomePageApplications();
                                this._reloadContactHomePageApplications();
                                break;
                            }
                        }

                        this._notify('Selected users were successfully added to groups.');
                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'contact':

                        this._notify('Selected contacts were successfully added to groups.');

                        if (this.$.appscoContactsPage.$) {
                            this.$.appscoContactsPage.modifyContacts(items);
                        }

                        break;

                    default:
                        return false;
                }
            }

            _onGroupsAddedToResources(event) {
                this._handleResourcesAddedToGroupResponse(event.detail.groups, event.detail.items, event.detail.resourceType);
            }

            _onAddItemToGroupAction(event) {
                var addToGroupComponent = this.shadowRoot.getElementById('appscoGroupAddResource'),
                    resourceType = event.detail.resourceType;

                addToGroupComponent.setType(resourceType);

                switch (resourceType) {
                    case 'resource':
                        addToGroupComponent.setListItemsApi(this._companyApplicationsApi);
                        break;

                    case 'role':
                        addToGroupComponent.setListItemsApi(this._companyRolesApi);
                        break;

                    case 'contact':
                        addToGroupComponent.setListItemsApi(this._companyContactsApi);
                        break;

                    default:
                        return false;
                }

                addToGroupComponent.open();
            }

            _onResourcesAddedToGroup(event) {
                this._handleResourcesAddedToGroupResponse([event.detail.group], event.detail.items, event.detail.resourceType);
            }

            _removeResourceFromGroup(group, item, type) {
                var dialog = this.shadowRoot.getElementById('appscoResourceRemoveFromGroup');
                dialog.setGroup(group);
                dialog.setItem(item);
                dialog.setType(type);
                dialog.open();
            }

            _removePartnerAdminFromCustomer(customer, partnerAdmin) {
                var dialog = this.shadowRoot.getElementById('appscoCustomerPartnerAdminRemove');
                dialog.setCustomer(customer);
                dialog.setPartnerAdminRole(partnerAdmin);
                dialog.open();
            }

            _onRemoveCompanyRoleFromGroup(event) {
                this._removeResourceFromGroup(event.detail.group, event.detail.role, 'role');
            }

            _onRemoveCompanyContactFromGroup(event) {
                this._removeResourceFromGroup(event.detail.group, event.detail.contact, 'contact');
            }

            _onRemoveCompanyResourceFromGroup(event) {
                this._removeResourceFromGroup(event.detail.group, event.detail.resource, 'resource');
            }

            _onRemovePartnerAdminFromCustomer(event) {
                this._removePartnerAdminFromCustomer(event.detail.customer, event.detail.partnerAdmin);
            }

            _onPartnerAdminRemovedFromCustomer(event) {
                var partnerAdmin = event.detail.partnerAdmin,
                    customer = event.detail.customer;

                if (this.$.appscoManageCustomerPage.$) {
                    this.$.appscoManageCustomerPage.removePartnerAdmins(customer, [partnerAdmin]);
                }

                this._notify('Partner admin role revoked');
            }

            _onResourceRemovedFromGroup(event) {
                var item = event.detail.item,
                    group = event.detail.group,
                    resourceType = event.detail.resourceType;

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.removeGroupItems(group, [item], resourceType);
                }

                if (this.$.appscoManageGroupPage.$) {
                    this.$.appscoManageGroupPage.removeGroupItems(group, [item], resourceType);
                }

                switch (resourceType) {
                    case 'resource':

                        this._notify(item.application.title + ' was successfully removed from ' + group.name + ' group.');

                        this._modifyCompanyApplications([item]);
                        this._reloadCompanyHomePageApplications();
                        this._reloadHomePageApplications();
                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'role':

                        this._notify(item.account.display_name + ' was successfully removed from ' + group.name + ' group.');

                        if (this.$.appscoDirectoryPage.$) {
                            this.$.appscoDirectoryPage.modifyAccounts([item]);
                        }

                        for (var i = 0; i < length; i++) {
                            if (item.account.email === this.account.email) {
                                this._reloadHomePageApplications();
                                this._reloadCompanyHomePageApplications();
                                break;
                            }
                        }

                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'contact':

                        this._notify(item.account.display_name + ' was successfully removed from ' + group.name + ' group.');

                        if (this.$.appscoContactsPage.$) {
                            this.$.appscoContactsPage.modifyContacts([item]);
                            this.$.appscoContactsPage.removeSelectedContacts([item]);
                        }

                        break;

                    default:
                        return false;
                }
            }
            /**
             * Groups page END
             */


            /**
             *  Devices page start
             */
            _onApproveDevice(event) {
                var component = this.shadowRoot.getElementById('appscoAccountApproveDevice');

                component.setDevice(event.detail.device);
                component.setAccount(event.detail.account);
                component.open();
            }

            _onDisapproveDevice(event) {
                var component = this.shadowRoot.getElementById('appscoAccountDisapproveDevice');

                component.setDevice(event.detail.device);
                component.setAccount(event.detail.account);
                component.open();
            }
            /**
             *  Devices page end
             */

            /**
             * Customers page START
             */

            _setCustomer(customer) {

                if (this.$.appscoManageCustomerPage.$) {
                    this.$.appscoManageCustomerPage.setCustomer(customer);
                }
            }

            _onEditCustomerAction(event) {
                var customer = event.detail.customer;

                this._setCustomer(customer);
                this._showManagePage('manage-customer/' + customer.alias);
            }

            _onHideCustomersBulkActions() {
                this.shadowRoot.getElementById('appscoCustomersPageActions').hideBulkActions();
            }

            _onHideGroupsBulkActions() {
                this.shadowRoot.getElementById('appscoGroupsPageActions').hideBulkActions();
            }

            _searchCustomers(term) {
                this._showProgressBar();
                this.$.appscoCustomersPage.filterByTerm(term);
            }

            _onSearchCustomersAction(event) {
                this._searchCustomers(event.detail.term);
            }

            _onSearchCustomersClearAction() {
                this._searchCustomers('');
            }

            _onImportCustomerResources() {
                this.shadowRoot.getElementById('appscoImportCustomerResources').toggle();
            }

            _onAddCustomerAction() {
                this.shadowRoot.getElementById('appscoAddCustomer').open();
            }

            _onExportCustomersAction() {
                this.$.appscoCustomersPage.exportToCsv();
            }

            _onExportAuditLogAction() {
                this._showProgressBar();
                this.$.appscoAuditLogPage.exportToCSV();
            }

            _onAddPartnerAdminAction(event) {
                this.set('_selectedCustomers', [event.detail.customer]);
                this.shadowRoot.getElementById('appscoAddPartnerAdmin').open();
            }

            _addCustomer(customer) {

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.addCustomer(customer);
                }
            }

            _reloadPartnerAdmins(customers) {

                if (this.$.appscoManageCustomerPage.$) {
                    this.$.appscoManageCustomerPage.reloadPartnerAdmins(customers);
                }
            }

            _reloadCustomers() {

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.reloadCustomers();
                }
            }

            _reloadCustomersInfo(customers) {

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.reloadCustomersInfo(customers);
                }
            }

            _reloadGroups() {

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.reloadGroups();
                }
            }

            _reloadAccountLog() {
                if (this.$.appscoManageAccountPage) {
                    this.$.appscoManageAccountPage.reloadAccountLog();
                }
            }

            _removeCompaniesFromSwitcher(companies) {
                this.$.appscoHeader.removeProductCompanies(companies);
            }

            _onCustomerAdded(event) {
                var customer = event.detail.customer;

                this._addCustomer(customer);
                this._reloadCustomers();
                this._getLoggedAccount();
                this._notify('New customer ' + customer.name + ' was successfully added.');
            }

            _onRemoveCustomersAction() {
                var selectedCustomers = this.$.appscoCustomersPage.getSelectedCustomers();

                if (selectedCustomers.length > 0) {
                    this.set('_selectedCustomers', selectedCustomers);
                    this.shadowRoot.getElementById('appscoCustomersRemove').toggle();
                }
                else {
                    this._onHideCustomersBulkActions();
                }
            }

            _onRemovedCustomers(event) {
                var customersCount = this.$.appscoCustomersPage.removeCustomers(this._selectedCustomers);

                this._removeCompaniesFromSwitcher(event.detail.customers);
                this._onHideCustomersBulkActions();
                this._notify(customersCount + ' customers were successfully removed from company.');
            }

            _onRemoveCustomersFailed() {
                this.set('_selectedCustomers', []);
                this._notify('An error occurred. Selected customers were not removed from company. Please try again.');
            }

            _onAddPartnerAdminToCustomersAction() {
                var selectedCustomers = this.$.appscoCustomersPage.getSelectedCustomers();

                if (selectedCustomers.length > 0) {
                    this.set('_selectedCustomers', selectedCustomers);
                    this.shadowRoot.getElementById('appscoAddPartnerAdmin').open();
                }
                else {
                    this._onHideCustomersBulkActions();
                }
            }

            _onPartnerAdminsAdded(event) {
                var customers = event.detail.customers;

                this._reloadCustomersInfo(customers);
                this._reloadPartnerAdmins(customers);
                this._notify('Partner admin added successfully.');
            }

            _onSelectAllCustomersAction() {

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.selectAllItems();
                }
            }

            _onImportCustomersAction() {
                this.shadowRoot.getElementById('appscoImportCustomers').open();
            }

            _onCustomersImportFinished(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfCreated + ' customers created out of ' + response.total + '.'
                    + ' Number of failed imports: ' + response.numberOfFailed + '.'
                    + ' Number of existing companies: ' + response.numberOfExisting + '.';

                if (0 < response.numberOfCreated) {
                    this._reloadCustomers();
                }

                this._notifyAccountLog();
                this._notify(message, true);
            }

            _onCustomerSubscriptionStateChanged(event) {
                var customer = event.detail.customer;
                this._setCustomer(customer);

                this._notify('Subscription paid externally has been turned ' +
                    (customer.subscription_paid_externally ? 'on' : 'off') +
                    ' for customer ' + customer.name + '.');
            }

            _onManageCustomerSubscription(event) {
                var customer = event.detail.customer;

                if (this.shadowRoot.getElementById('appscoManageCustomerSubscription').$) {
                    this.shadowRoot.getElementById('appscoManageCustomerSubscription').setCustomer(customer);
                    this.shadowRoot.getElementById('appscoManageCustomerSubscription').toggle();
                }
            }
            /**
             * Customers page END
             */

            _onExportAccessReportAction() {
                this.exportReport(this._exportAccessReportApi, 'GET', this.$.appscoAccessReportPage);
            }

            _onExportComplianceReportAction() {
                this.exportReport(this._exportComplianceReportApi, 'POST', this.$.appscoComplianceReportPage);
            }

            _onExportPoliciesReportAction() {
                this.exportReport(this._exportPoliciesReportApi, 'POST', this.$.appscoPoliciesReportPage);
            }

            _onExportBillingReportAction() {
                this.exportReport(this._exportBillingReportApi, 'GET', this.$.appscoBillingReportPage);
            }

            /**
             * Oauth page START
             */
            _reloadOAuthApplicationCertificates() {

                if (this.$.appscoManageOAuthApplicationPage.$) {
                    this.$.appscoManageOAuthApplicationPage.reloadCertificates();
                }
            }

            _reloadOAuthApplications() {

                if (this.$.appscoOAuthApplicationsPage.$) {
                    this.$.appscoOAuthApplicationsPage.reloadOAuthApplications();
                }
            }

            _onAddOAuthApplicationAction() {
                this.shadowRoot.getElementById('appscoAddOauthApplication').open();
            }

            _onOauthApplicationAdded(event) {
                var application = event.detail.application;

                this.$.appscoOAuthApplicationsPage.reloadOAuthApplications();
                this.$.appscoOAuthApplicationsPage.hideInfo();

                this._notify('OAuth application ' + application.title + ' has been successfully added.');
            }

            _onEditOAuthApplicationAction(event) {
                var application = event.detail.application;

                if (this.$.appscoManageOAuthApplicationPage.$) {
                    this.$.appscoManageOAuthApplicationPage.setApplication(application);
                }

                this._showManagePage('manage-oauth-application/' + application.alias);
            }

            _onOAuthApplicationUpdated(event) {
                var application = event.detail.application;

                this._reloadOAuthApplications();
                this._notify('OAuth application ' + application.title + ' has been successfully saved.');
            }

            _onRemoveOAuthApplicationAction(event) {
                var removeComponent = this.shadowRoot.getElementById('appscoRemoveOAuthApplication');

                removeComponent.setApplication(event.detail.application);
                removeComponent.open();
            }

            _onOAuthApplicationRemoved(event) {
                this._showOAuthApplicationsPage();
                this._reloadOAuthApplications();
                this.$.appscoOAuthApplicationsPage.hideInfo();
                this._notify('OAuth application ' + event.detail.application.title + ' has been successfully removed.');
            }

            _onAddOAuthApplicationCertificateAction(event) {
                var addComponent = this.shadowRoot.getElementById('appscoAddOauthApplicationCertificate');

                addComponent.setApplication(event.detail.application);
                addComponent.open();
            }

            _onOauthApplicationCertificateAdded(event) {
                this._reloadOAuthApplicationCertificates();
                this._notify('Certificate for OAuth application ' + event.detail.application.title + ' has been successfully added.');
            }

            _onRemoveOAuthApplicationCertificateAction(event) {
                var removeComponent = this.shadowRoot.getElementById('appscoRemoveCertificate');

                removeComponent.setCertificate(event.detail.certificate);
                removeComponent.open();
            }

            _onOAuthApplicationCertificateRemoved() {
                this._reloadOAuthApplicationCertificates();
                this._notify('OAuth application certificate has been successfully removed.');
            }
            /**
             * Oauth page END
             */

            /**
             * Policies page START
             */
            _onChangePolicyStatusAction(event) {
                var statusPolicyComponent = this.shadowRoot.getElementById('appscoChangePolicyStatus');

                if (statusPolicyComponent) {
                    statusPolicyComponent.setPolicy(event.detail.policy);
                    statusPolicyComponent.setAction(event.detail.action);
                    statusPolicyComponent.open();
                }
            }

            _onPolicyStatusChanged(event) {
                var policy = event.detail.policy;

                if (this.$.appscoPoliciesPage.$) {
                    this.$.appscoPoliciesPage.modifyPolicy(policy);
                    this.$.appscoPoliciesPage.modifyPolicies([policy]);
                }

                this._notify('Company policy successfully ' +
                    (('active' === policy.status) ? 'enabled' : 'disabled') +
                    '.');
            }

            _onPolicyUpdated(event) {
                var policy = event.detail.policy;

                if (this.$.appscoPoliciesPage.$) {
                    this.$.appscoPoliciesPage.modifyPolicy(policy);
                    this.$.appscoPoliciesPage.modifyPolicies([policy]);
                }

                this._notify('Company policy successfully updated.');
            }
            /**
             * Policies page END
             */

            /**
             * Additional Options page START
             */
            _onAddIdPItemAction(event) {
                var component = this.shadowRoot.getElementById('appscoIdpResourceAdd');

                if (component && component.$) {
                    component.setResource(event.detail.item);
                    component.open();
                }
            }

            _onIdpResourceAdded(event) {
                var resource = event.detail.resource;

                this._notify(resource.title + ' was successfully added.');

                if (this.$.appscoAdditionalOptionsPage.$) {
                    this.$.appscoAdditionalOptionsPage.modifyAddedResource(event.detail.template);
                }
            }
            /**
             * Additional Options page END
             */

            /**
             * Global START
             */
            _setProgressBar(page) {
                var pages = Polymer.dom(this.root).querySelectorAll('[page]');
                for(var index = 0; index< pages.length; index++) {
                    if(pages[index].getAttribute('name') === page) {
                        pages[index].pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        return;
                    }
                }
                this._hideProgressBar();
            }

            _onPageLoaded() {
                this._hideProgressBar();
            }

            _showProgressBar() {
                this.$.pageProgress.hidden = false;
            }

            _hideProgressBar() {

                setTimeout(function() {
                    this.$.pageProgress.hidden = true;
                }.bind(this), 1000);

            }

            _computeCompany(page) {
                var companyPages = Polymer.dom(this.root).querySelectorAll('[company-page]');
                for(var index = 0; index< companyPages.length; index++) {
                    if(companyPages[index].getAttribute('name') === page) {
                        return !this._personalFolderPage;
                    }
                }
                return false;
            }

            _computeContactPage(page) {
                return page === 'contact-home';
            }

            _computePage(page, pageToCompare) {
                return pageToCompare === page;
            }

            _computeGroupsPage(page) {
                return this._computePage(page, 'groups');
            }

            _computeAnyProvisioningPage(page) {
                return this._provisioningPage || this._manageIntegrationPage;
            }

            _computeAnyResourcePage(page) {
                return this._resourcePage || this._manageResourcePage || this._resourcesPage;
            }

            _computeAnyContactPage(page) {
                return this._contactsPage || this._manageContactPage;
            }

            _computeAnyCustomerPage(page) {
                return this._customersPage || this._manageCustomerPage;
            }

            _computeAnyBillingPage(page) {
                return this._billingPage || this._customerBillingPage;
            }

            _computeAnyAccountPage(page) {
                return this._accountPage || this._companyAccountPage || this._manageAccountPage;
            }

            _computeAnyGroupPage(page) {
                return this._groupsPage || this._manageGroupPage;
            }

            _computeOAuthPage(page) {
                return this._oauthApplicationsPage || this._manageOauthApplicationPage;
            }

            _computePanel(company) {
                return company ? 'appsco-business-product' : 'appsco-product';
            }

            _computeBrandLogo(company, companyPage) {
                if (companyPage && company.company && company.company.image) {
                    return company.company.image;
                }

                return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAgCAYAAAB+ZAqzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAVZJREFUeNrsmOENgjAQhcE4AG5QN2AERnCEjsAIdQJG6AiO0BEcATdwhLONxJR6V1u8Ij98ycXkrL3HR+8gVlWCAEDa0EjuaqP1csLGkPJ7FtlNR3hKIzknNeV0uC5YqzhNSc/AiORgKiyCnCbWSm5ar02DHEzFhyB3J9aCf/tL02qckSCvbHSAy60Va9BSSGFn1gAt1zjNlmj5Mr+gdYE0aXZahFmFdOgnSW5aEikivHmWo1NJWnoBLf8ItFujNWumErSwDs3V+xjJoNURtBTwSC6lZQrRmtXhoNXa6IFPIwctE3lYf3crv6TVER26Ki29RVpiNVoJkz+FlmGnlTD5Y7ROia82q9Iat0ALG5xyml3laUXMqkSKZWgRpiha4k+LMPYzWvuYsbquDxhFxn8fzmTt3DNnP9xVNgymbvbCj9SXu8zNeiZTUVocZ27pe/3HA/8QYABzJAP50CmRFwAAAABJRU5ErkJggg==";
            }

            _computeBrandTitle(company, companyPage) {
                if (!companyPage) {
                    return 'AppsCo';
                }

                return '';
            }

            _setAccountCompany(company) {
                var newCompany = JSON.parse(JSON.stringify(this.currentCompany)),
                    companies = JSON.parse(JSON.stringify(this.account.companies)),
                    length = companies.length;

                newCompany.company = company;

                this.set('currentCompany', {
                    company: {}
                });

                this.set('currentCompany', newCompany);

                for (var i = 0; i < length; i++) {
                    if (company.alias === companies[i].company.alias) {
                        companies[i].company = company;
                        break;
                    }
                }
                companies.sort(function(a, b){
                    return a.company.name.toLowerCase() < b.company.name.toLowerCase() ? -1 :
                        a.company.name.toLowerCase() < b.company.name.toLowerCase() ? 1: 0;
                });

                this.set('account.companies', []);
                this.set('account.companies', companies);
            }

            /**
             * This method will reload page content for both from page and to page
             */
            _onPageAnimationFinish(event) {
                if (event.detail.fromPage.$ && typeof event.detail.fromPage.resetPage !== 'undefined') {
                    if(event.detail.fromPage.getAttribute('name') === 'home') {
                        this._applicationsApi = this.api.foldersApi + '/icons';
                    }
                    event.detail.fromPage.resetPage();
                }

                if (event.detail.toPage.$ && typeof event.detail.toPage.initializePage !== 'undefined') {
                    event.detail.toPage.initializePage();
                }
            }

            /**
             * This method will reload page actions in the previous page.
             * Reason to do so is to reset the filters once user leaves the page.
             */
            _onPageActionsAnimationFinish(event) {
                if (event.detail.fromPage.$ && typeof event.detail.fromPage.resetPage !== 'undefined') {
                    event.detail.fromPage.resetPage();
                }
            }

            _notifyAccountLog() {
                this.dispatchEvent(new CustomEvent('reload-account-log', { bubbles: true, composed: true }));
            }

            _notifyReloadApplications() {
                this.dispatchEvent(new CustomEvent('reload-applications', { bubbles: true, composed: true }));
            }

            _notifyReloadAccounts() {
                this.dispatchEvent(new CustomEvent('reload-accounts', { bubbles: true, composed: true }));
            }

            _notifyAboutError(event) {
                this._notify(event.detail.message);
            }

            _notify(message, persistant) {
                var toast = this.$.toast;

                this._toastPersistence = persistant;
                toast.duration = persistant ? 0 : 5000;

                if (toast.opened) {
                    toast.cancel();
                    this._toastMessage = message;
                }
                else {
                    this._toastMessage = message;
                    toast.open();
                }
            }

            _closeToastMessage() {
                var toast = this.$.toast;

                if (toast.opened) {
                    toast.close();
                    this._toastMessage = '';
                }
            }

            _onCloseToastAction() {
                this._closeToastMessage();
            }

            _onToastMessageClosed(event) {
                if (event.detail.canceled) {
                    this.$.toast.open();
                }
            }

            _onError(event) {
                this._showPage404();
            }

            _getCookie(cookieName) {
                var name = cookieName + '=',
                    decodedCookie = decodeURIComponent(document.cookie),
                    cookies = decodedCookie.split(';');

                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i];

                    while (cookie.charAt(0) === ' ') {
                        cookie = cookie.substring(1);
                    }

                    if (cookie.indexOf(name) === 0) {
                        return cookie.substring(name.length, cookie.length);
                    }
                }

                return '';
            }

            _isLocalStorageSupported () {
                return window.localStorage
                    && typeof(window.localStorage.setItem) === 'function'
                    && typeof(window.localStorage.getItem) === 'function'
                    && typeof(window.localStorage.removeItem) === 'function';
            }

            _storeValue(key, value) {
                if (this._isLocalStorageSupported()) {
                    window.localStorage.setItem(key, value);
                } else {
                    var secure_cookie = Boolean(Number(this.cookieSecure)) === true ? ';secure' : '';
                    document.cookie = key + '=' + value + secure_cookie;
                }
            }

            _getStoredValue(key) {
                return this._isLocalStorageSupported() ? window.localStorage.getItem(key) : this._getCookie(key);
            }

            _changeTheme(companyPage, currentCompany) {
                var company = currentCompany.company ? currentCompany.company : {},
                    headerBackgroundColor   = 'var(--app-primary-color)',
                    headerTextColor         = 'var(--brand-default-text-color)',
                    brandColor              = 'var(--app-primary-color)',
                    brandTextColor          = 'var(--brand-default-text-color)'
                ;

                if (companyPage) {
                    if (company.primary_color) {
                        headerBackgroundColor = company.primary_color;
                        if ('#fff' !== company.primary_color && '#ffffff' !== company.primary_color) {
                            brandColor = company.primary_color;
                        }
                    }
                    if (company.secondary_color) {
                        brandTextColor = company.secondary_color;
                        headerTextColor = company.secondary_color;
                    }
                }

                this.updateStyles({
                    '--header-background-color' : headerBackgroundColor,
                    '--header-text-color' : headerTextColor,
                    '--brand-color' : brandColor,
                    '--brand-text-color' : brandTextColor,
                });
            }

            _onCopiedApplicationAttribute(event) {
                var appRequest = document.createElement('iron-request'),
                    application = event.detail.application.application;

                if (!!application.company) {
                    appRequest.send({
                        url: application.meta.track_events,
                        method: 'POST',
                        handleAs: 'json',
                        body: 'track_events[event_type]=copy_event&track_events[field]=' + encodeURIComponent(event.detail.attribute),
                        headers: this._headers
                    });
                }
            }

            _reloadApplicationsForCompanyAdministrator() {

                if (this.currentCompany.company_admin) {
                    this._reloadHomePageApplications();
                    this._reloadCompanyHomePageApplications();
                    this._reloadContactHomePageApplications();
                }
            }

            _onBackToHomePageAction() {
                this._showHomePage();
                this._setProduct(false);
            }

            _setNativeCompanyAsCurrent() {
                var nativeCompany = this.account.native_company,
                    accountCompanies = this.account.companies,
                    length = accountCompanies.length;

                for (var i = 0; i < length; i++) {
                    var company = accountCompanies[i];

                    if (nativeCompany.alias === company.company.alias) {
                        this.set('currentCompany', company);
                        break;
                    }
                }
            }

            _setupCompanyAccountPage(page, account) {

                if ('company-account' === page && account.self) {
                    account.native_company ? this._setNativeCompanyAsCurrent() : this._showHomePage();
                }
            }

            _onBackFromAccountAction() {
                this._accountManaged ? this._showCompanyHomePage() : this._showHomePage();
            }

            _onResetPageActions() {
                var currentActions = this.getCurrentAppscoPageActionsElement();

                if (currentActions && currentActions.resetPageActions) {
                    currentActions.resetPageActions();
                }
            }

            _onItemResponse(event) {
                this.set('item', event.detail.response);
            }

            _onLinkResponse(event) {
                this.set('link', event.detail.response);
            }

            _copyObject(object) {
                return JSON.parse(JSON.stringify(object));
            }
        }
        window.customElements.define(AppscoApp.is, AppscoApp);
    </script>
</dom-module>
