<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../../bower_components/neon-animation/animations/scale-up-animation.html">

<link rel="import" href="../../bower_components/appsco-vault/appsco-vault-login.html">
<link rel="import" href="../../bower_components/appsco-vault/appsco-vault-credit-card.html">
<link rel="import" href="../../bower_components/appsco-vault/appsco-vault-identity.html">
<link rel="import" href="../../bower_components/appsco-vault/appsco-vault-software-license.html">
<link rel="import" href="../../bower_components/appsco-vault/appsco-vault-passport.html">
<link rel="import" href="../../bower_components/appsco-vault/appsco-vault-secure-note.html">

<dom-module id="appsco-vault-manage-item">
    <template>
        <style include="webkit-scrollbar-style">
            :host {
                display: block;
                position: relative;
                @apply(--appsco-vault-manage-item);

                --paper-dialog-scrollable: {
                     max-width: none !important;
                     padding-top: 15px;
                     padding-bottom: 15px;
                 };
            }
            :host paper-dialog-scrollable {
                margin-top: 0 !important;
            }
            :host paper-dialog-scrollable > *[hidden] {
                display: none;
            }
            :host paper-dialog {
                width: 670px;
            }
            :host .buttons paper-button {
                @apply(--paper-dialog-button);
            }
            :host .buttons paper-button.add-action {
                margin: 0 0 0 10px;
                @apply(--paper-dialog-confirm-button);
            }
            :host .buttons paper-button[dialog-dismiss] {
                @apply(--paper-dialog-dismiss-button);
            }
        </style>

        <paper-dialog
                with-backdrop
                id="manageVaultLogin"
                entry-animation="scale-up-animation"
                exit-animation="fade-out-animation"
                on-iron-overlay-closed="_onDialogClosed">

            <h2>Manage [[ item.displayTitle ]]</h2>

            <paper-dialog-scrollable>

                <appsco-vault-login
                        id="appscoVaultLogin"
                        component
                        item="[[ item ]]"
                        authorization-token="[[ authorizationToken ]]"
                        vault-login-api="[[ api.vaultLogin ]]"
                        on-vault-item-saved="_onItemSaved"
                        no-submit-action></appsco-vault-login>

            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button dialog-dismiss>Cancel</paper-button>
                <paper-button id="addApplicationAction"
                              class="add-action"
                              on-tap="_onSaveVaultItem">
                    Save
                </paper-button>
            </div>
        </paper-dialog>

        <paper-dialog
                with-backdrop
                id="manageVaultCreditCard"
                entry-animation="scale-up-animation"
                exit-animation="fade-out-animation"
                on-iron-overlay-closed="_onDialogClosed">

            <h2>Manage [[ item.displayTitle ]]</h2>

            <paper-dialog-scrollable>

                <appsco-vault-credit-card
                        id="appscoVaultCreditCard"
                        component
                        item="[[ item ]]"
                        authorization-token="[[ authorizationToken ]]"
                        vault-credit-card-api="[[ api.vaultCreditCard ]]"
                        on-vault-item-saved="_onItemSaved"
                        no-submit-action></appsco-vault-credit-card>

            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button dialog-dismiss>Cancel</paper-button>
                <paper-button id="addApplicationAction"
                              class="add-action"
                              on-tap="_onSaveVaultItem">
                    Save
                </paper-button>
            </div>
        </paper-dialog>

        <paper-dialog
                with-backdrop
                id="manageVaultIdentity"
                entry-animation="scale-up-animation"
                exit-animation="fade-out-animation"
                on-iron-overlay-closed="_onDialogClosed">

            <h2>Manage [[ item.displayTitle ]]</h2>

            <paper-dialog-scrollable>

                <appsco-vault-identity
                        id="appscoVaultIdentity"
                        component
                        item="[[ item ]]"
                        authorization-token="[[ authorizationToken ]]"
                        vault-identity-api="[[ api.vaultIdentity ]]"
                        on-vault-item-saved="_onItemSaved"
                        no-submit-action></appsco-vault-identity>

            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button dialog-dismiss>Cancel</paper-button>
                <paper-button id="addApplicationAction"
                              class="add-action"
                              on-tap="_onSaveVaultItem">
                    Save
                </paper-button>
            </div>
        </paper-dialog>

        <paper-dialog
                with-backdrop
                id="manageVaultSoftwareLicense"
                entry-animation="scale-up-animation"
                exit-animation="fade-out-animation"
                on-iron-overlay-closed="_onDialogClosed">

            <h2>Manage [[ item.displayTitle ]]</h2>

            <paper-dialog-scrollable>

                <appsco-vault-software-license
                        id="appscoVaultSoftwareLicense"
                        component
                        item="[[ item ]]"
                        authorization-token="[[ authorizationToken ]]"
                        vault-software-license-api="[[ api.vaultSoftwareLicence ]]"
                        on-vault-item-saved="_onItemSaved"
                        no-submit-action></appsco-vault-software-license>

            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button dialog-dismiss>Cancel</paper-button>
                <paper-button id="addApplicationAction"
                              class="add-action"
                              on-tap="_onSaveVaultItem">
                    Save
                </paper-button>
            </div>
        </paper-dialog>

        <paper-dialog
                with-backdrop
                id="manageVaultPassport"
                entry-animation="scale-up-animation"
                exit-animation="fade-out-animation"
                on-iron-overlay-closed="_onDialogClosed">

            <h2>Manage [[ item.displayTitle ]]</h2>

            <paper-dialog-scrollable>

                <appsco-vault-passport
                        id="appscoVaultPassport"
                        component
                        item="[[ item ]]"
                        authorization-token="[[ authorizationToken ]]"
                        vault-passport-api="[[ api.vaultPassport ]]"
                        on-vault-item-saved="_onItemSaved"
                        no-submit-action></appsco-vault-passport>

            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button dialog-dismiss>Cancel</paper-button>
                <paper-button id="addApplicationAction"
                              class="add-action"
                              on-tap="_onSaveVaultItem">
                    Save
                </paper-button>
            </div>
        </paper-dialog>

        <paper-dialog
                with-backdrop
                id="manageVaultSecureNote"
                entry-animation="scale-up-animation"
                exit-animation="fade-out-animation"
                on-iron-overlay-closed="_onDialogClosed">

            <h2>Manage [[ item.displayTitle ]]</h2>

            <paper-dialog-scrollable>

                <appsco-vault-secure-note
                        id="appscoVaultSecureNote"
                        component
                        item="[[ item ]]"
                        authorization-token="[[ authorizationToken ]]"
                        vault-secure-note-api="[[ api.vaultSecureNote ]]"
                        on-vault-item-saved="_onItemSaved"
                        no-submit-action></appsco-vault-secure-note>

            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button dialog-dismiss>Cancel</paper-button>
                <paper-button id="addApplicationAction"
                              class="add-action"
                              on-tap="_onSaveVaultItem">
                    Save
                </paper-button>
            </div>
        </paper-dialog>

    </template>
    <script>
        Polymer({

            is: 'appsco-vault-manage-item',

            properties: {
                authorizationToken: {
                    type: String,
                    value: ''
                },

                /**
                 * Vault item to be removed
                 */
                item: {
                    type: Object,
                    value: function() {
                        return {};
                    },
                    notify: true,
                    observer: '_onItemChange'
                },

                api: {
                    type: Object,
                    notify: true
                }
            },


            _onItemChange: function() {

            },

            open: function (action) {

                switch (action) {
                    case 'login':
                        this.$.manageVaultLogin.open();
                        break;

                    case 'credit-card':
                        this.$.manageVaultCreditCard.open();
                        break;

                    case 'identity':
                        this.$.manageVaultIdentity.open();
                        break;

                    case 'software-licence':
                        this.$.manageVaultSoftwareLicense.open();
                        break;

                    case 'passport':
                        this.$.manageVaultPassport.open();
                        break;

                    case 'secure-note':
                        this.$.manageVaultSecureNote.open();
                        break;
                }
            },

            _onSaveVaultItem: function(event) {
                Polymer.dom(event.target.parentNode.parentNode).querySelector('[component]').save();
            },

            _onItemSaved: function(event) {
                this.fire('item-saved', {
                   item: event.detail.item
                });

                event.target.parentNode.parentNode.close();
            },

            _onDialogClosed: function(event) {
                var tagName = event.target.tagName;

                if (tagName && (tagName.toLowerCase() == 'paper-dialog')) {
                    this.set('item', {});

                    this.$$('#appscoVaultLogin').reset();
                    this.$$('#appscoVaultCreditCard').reset();
                    this.$$('#appscoVaultIdentity').reset();
                    this.$$('#appscoVaultSoftwareLicense').reset();
                    this.$$('#appscoVaultPassport').reset();
                    this.$$('#appscoVaultSecureNote').reset();
                }
            }
        });
    </script>
</dom-module>
