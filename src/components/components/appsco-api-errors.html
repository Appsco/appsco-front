<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/app-localize-behavior/app-localize-behavior.html">

<!--
`appsco-api-errors`
Handles API error translations.

Example:
      <appsco-api-errors language=""></appsco-api-errors>

-->

<dom-module id="appsco-api-errors">
    <template>
    </template>
</dom-module>

<script>
    class AppscoApiErrors extends Polymer.mixinBehaviors([Polymer.AppLocalizeBehavior], Polymer.Element) {
        static get is() { return 'appsco-api-errors'; }

        static get properties() {
            return {
                name: {
                    type: Object,
                    value: function () {
                        return {};
                    },
                    notify: true
                },

                language: {
                    value: 'en',
                    type: String
                },

                useKeyIfMissing: {
                    type: Boolean,
                    value: true
                },

                defaultError: {
                    type: Number,
                    value: 404
                }
            };
        }

        ready() {
            super.ready();

            Polymer.RenderStatus.afterNextRender(this, function() {
                this.set('name', this);
                this.loadResources(this.resolveUrl('data/appsco-api-errors.json'));
            });
        }

        /**
         * Returns translation for error based on provided error code.
         *
         * @param {String} code The code for which to return error message.
         * @returns {string} Translated error message if exists. Otherwise, it returns given code.
         */
        getError(code) {
            const message = this.localize(code);

            return (!message || code === message) ? this.localize(this.defaultError) : message;
        }
    }
    window.customElements.define(AppscoApiErrors.is, AppscoApiErrors);
</script>
